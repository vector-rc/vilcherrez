import{d as x,r as c,u as j,c as Q,a as E,b as p,n as z,e,f as O,w as k,g as se,h as F,I as W,F as G,i as le,o as f,B as ge,S as fe,j as Ee,k as Re,P as Ae,L as Oe,l as De,m as Y,p as L,v as y,q as pe,A as me,s as J,t as D,E as de,x as X,y as Ue,z as V,C as oe,D as ce,G as he,H as ae,J as re,K as te,M as ve,N as Ie,O as be,Q as Le,R as Te,T as ye,U as Me}from"./vendor.ff20ddbd.js";const Fe=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}};Fe();const we=e("span",null,"Productos",-1),Ne=e("span",null,"Ventas",-1),ke=e("span",null,"Configs",-1),xe=e("span",null,"Barcodes",-1),We=e("span",null,"Usuarios",-1),Ge={class:"is-fluid pl-6 py-5"},Ve=x({setup(_){const n=c(!1),o=j(),i=Q(()=>o.state.user.userName),s=Q(()=>o.state.isAuthenticated);return(a,l)=>{const m=le("router-link"),g=le("router-view");return f(),E(G,null,[p(s)?(f(),E("div",{key:0,class:z([{"hide-menu":!n.value},"aside-menu"])},[e("button",{class:"delete","aria-label":"close",onClick:l[0]||(l[0]=A=>n.value=!1)}),O(m,{class:"item_menu",to:"/products"},{default:k(()=>[O(p(W),{size:"30"},{default:k(()=>[O(p(ge))]),_:1}),we]),_:1}),O(m,{class:"item_menu",to:"/sales"},{default:k(()=>[O(p(W),{size:"30"},{default:k(()=>[O(p(fe))]),_:1}),Ne]),_:1}),O(m,{class:"item_menu",to:"/printers"},{default:k(()=>[O(p(W),{size:"30"},{default:k(()=>[O(p(Ee))]),_:1}),ke]),_:1}),O(m,{class:"item_menu",to:"/barcodes"},{default:k(()=>[O(p(W),{size:"30"},{default:k(()=>[O(p(Re))]),_:1}),xe]),_:1}),p(i)==="Balta"?(f(),se(m,{key:0,class:"item_menu",to:"/signup"},{default:k(()=>[O(p(W),{size:"30"},{default:k(()=>[O(p(Ae))]),_:1}),We]),_:1})):F("",!0)],2)):F("",!0),e("main",Ge,[p(s)?(f(),E("button",{key:0,onClick:l[1]||(l[1]=A=>n.value=!0)},[O(p(W),{size:"30"},{default:k(()=>[O(p(Oe))]),_:1})])):F("",!0),e("div",null,[O(g)])])],64)}}});var ie=De({state:{products:[],user:{},isAuthenticated:!1},mutations:{test(){console.log("hola desde vuex")}},actions:{async fetchProducts({state:_}){try{const o=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/products")).json();return o.success&&(_.products=o.data.reverse()),o}catch(n){return console.log(n.type),{success:!0,message:n}}},async fetchSales({state:_}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sales",{headers:{Authorization:`bearer ${_.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchBoletas({state:_}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/boletas",{headers:{Authorization:`bearer ${_.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchFacturas({state:_}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/facturas",{headers:{Authorization:`bearer ${_.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchSaleDetail({state:_},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/saleDetail/${n}`,{headers:{Authorization:`bearer ${_.user.token} `}})).json()}catch(o){return console.log(o.type),{success:!1,message:o}}},async fetchBoletaDetail({state:_},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/boletaDetail/${n}`,{headers:{Authorization:`bearer ${_.user.token} `}})).json()}catch(o){return console.log(o.type),{success:!1,message:o}}},async fetchFacturaDetail({state:_},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/facturaDetail/${n}`,{headers:{Authorization:`bearer ${_.user.token} `}})).json()}catch(o){return console.log(o.type),{success:!1,message:o}}},async fetchPackProducts({state:_},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/pack_product/${n}`,{headers:{Authorization:`bearer ${_.user.token} `}})).json()}catch(o){return{data:null,success:!0,message:o}}},async fetchRoles(){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/user_roles")).json()}catch(_){return{success:!0,message:_}}},async userLogin({state:_},{credentials:n}){try{const i=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/login",{method:"POST",body:JSON.stringify(n)})).json();return console.log(i),i.success&&(_.user=i.data,_.isAuthenticated=i.success,localStorage.token=i.data.token),i}catch(o){return console.log(o),{success:!1,message:o}}},async userSignup({state:_},{user:n}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/signup",{method:"POST",body:JSON.stringify(n)})).json()}catch(o){return console.log(o),{success:!1,message:o}}},async saveProduct({state:_},{action:n,product:o}){try{const s=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:n==="add"?"POST":"PUT",headers:{Authorization:`bearer ${_.user.token} `},body:JSON.stringify(o)})).json();if(s.success&&(n==="add"&&_.products.unshift(s.data),n==="edit")){const a=_.products.findIndex(l=>l.id===o.id);console.log(a),_.products[a]=s.data}return s}catch{}},async savePackingProduct({state:_},{action:n,data:o}){console.log({action:n});try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:n==="add"?"POST":"PUT",headers:{Authorization:`bearer ${_.user.token} `},body:JSON.stringify(o)})).json()}catch{}},async printerTicket(_,{text:n}){return await(await fetch(`http://localhost:5050/printer/${localStorage.printer}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,qr_content:"hola mundo"})})).text()},async testEncode(_,{text:n}){return await(await fetch("http://localhost:5050/decodeurl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,qr_content:"hola mundo"})})).text()},async getInfoDoc({state:_},{typeDoc:n,document:o}){let i;return console.log(n),n===1&&(i=await fetch(`https://inversionesvilver.com/shop-back/api/v1/dni/${o}`,{headers:{Authorization:`bearer ${_.user.token} `}})),n===6&&(i=await fetch(`https://inversionesvilver.com/shop-back/api/v1/ruc/${o}`,{headers:{Authorization:`bearer ${_.user.token} `}})),(await i.json()).data},async saveSale({state:_},{soldProducts:n,client:o,typeProof:i}){return(await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sale",{method:"POST",headers:{Authorization:`bearer ${_.user.token} `},body:JSON.stringify({soldProducts:n,client:o,userId:_.user.id,typeProof:i})})).json()).data},async sendSummaries({state:_}){return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sendResumenes",{method:"POST",headers:{Authorization:`bearer ${_.user.token} `}})).json()},async darBaja({state:_},{proofId:n,typeProof:o,motivoBaja:i}){let s="",a="";return o==="boleta"&&(s="bajaBoleta",a=JSON.stringify({idBoleta:n})),o==="factura"&&(s="bajaFactura",a=JSON.stringify({idFactura:n,motivoBaja:i})),await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/${s}`,{method:"POST",headers:{Authorization:`bearer ${_.user.token} `},body:a})).json()}},modules:{}});const je={class:"columns"},$e={class:"column is-11"},He={class:"control has-icons-left"},Be={class:"column is-1"},Ke={class:"h-100 oy-scroll"},Je={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Xe=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th")])],-1),qe={style:{"padding-top":"2px"}},ze=["innerHTML"],Ye=["onClick","innerHTML"],Qe=["onClick"],Ze=x({emits:["editProduct"],setup(_,{emit:n}){const o=j(),i=c([]),s=c([]),a=c("");Y(async()=>{i.value=o.state.products,s.value=o.state.products});const l=(d,u)=>{if(d.length!==0)return d.forEach(h=>{u=u.toString().toLocaleUpperCase().replace(h.toLocaleUpperCase(),`<span style="background:#6eeeeebb">${h.toLocaleUpperCase()}</span>`)}),u},m=()=>{const d=a.value;setTimeout(()=>{if(d===a.value){const h=a.value.toLowerCase().split(" "),v=[];let R=0;i.value.forEach(P=>{R=0,h.forEach(U=>{(P.name.toLowerCase().includes(U)||P.code.toString().toLowerCase().includes(U))&&(R+=1)}),R!==0&&(P.matchs=R,v.push(P))}),console.log(v),s.value=v.sort((P,U)=>U.matchs-P.matchs)}},500)},g=d=>{console.log("hola")},A=d=>{navigator.clipboard.writeText(d.name)},r=async()=>{await o.dispatch("fetchProducts"),i.value=o.state.products,s.value=o.state.products};return(d,u)=>(f(),E(G,null,[e("div",je,[e("div",$e,[e("div",He,[L(e("input",{class:"input",type:"search",onInput:u[0]||(u[0]=h=>m()),"onUpdate:modelValue":u[1]||(u[1]=h=>a.value=h),placeholder:"Buscar producto"},null,544),[[y,a.value,void 0,{trim:!0}]]),O(p(W),{class:"icon is-large is-left"},{default:k(()=>[O(p(pe))]),_:1})])]),e("div",Be,[e("button",{class:"button is-primary",onClick:u[2]||(u[2]=h=>r())},[O(p(W),{class:"icon is-large is-left"},{default:k(()=>[O(p(me))]),_:1})])])]),e("div",Ke,[e("table",Je,[Xe,e("tbody",qe,[(f(!0),E(G,null,J(s.value,h=>(f(),E("tr",{key:h.id},[e("td",{innerHTML:l(a.value.split(" "),h.code)},null,8,ze),e("td",{style:{cursor:"copy"},onClick:v=>A(h),innerHTML:l(a.value.split(" "),h.name)},null,8,Ye),e("td",null,"S/."+D(h.priceSale),1),e("td",null,D(h.stock),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:v=>(g(),n("editProduct",h.productId))},[O(p(W),null,{default:k(()=>[O(p(de))]),_:1})],8,Qe)])]))),128))])])])],64))}}),es={class:"control"},ss={key:0,class:"help is-danger"},os=["disabled","value"],ns={class:"control"},as={class:"control"},rs={class:"control"},ts={class:"control"},is={class:"control"},ls={class:"control"},ps=x({props:{product:Object},emits:["quit","haveErrors"],setup(_,{emit:n}){const o=_,i=j(),s=X(o.product),a=c(!1),l=c(!1),m=c(),g=c(""),A=()=>{if(s.packing=s.packing.toLocaleUpperCase(),s.priceBuy===0||s.profitPercent===0)return;const v=s.profitPercent/100;if(v!==0){const R=s.priceBuy+s.priceBuy*v;s.priceSale=Math.round((R+Number.EPSILON)*10)/10}},r=Ue("packedProducts");V(()=>{console.log("holas"),s.code.toString()!==""&&(console.log("sd"),l.value=r.value.some(v=>s.code.toString()===v.code.toString()&&s.id.toString()!==v.id.toString()),l.value&&(n("haveErrors"),g.value="los codigos no pueden ser iguales"))});const d=()=>{const v=s.code;setTimeout(()=>{s.code===v&&m.value.blur()},100)};V(()=>{n("haveErrors",l.value)});const u=()=>(s.productId!==void 0?(l.value=i.state.products.some(({code:v,productId:R})=>v.toString()===s.code&&R!==s.productId),g.value="Ya existe un producto con este codigo"):l.value=i.state.products.some(({code:v})=>v.toString()===s.code),a.value=!1,l.value),h=()=>{s.code="",l.value=!1,m.value.focus()};return(v,R)=>(f(),E("tr",null,[e("td",es,[L(e("input",{autocomplete:"off",onInput:R[0]||(R[0]=P=>d()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:R[1]||(R[1]=P=>P.target.blur()),onBlur:R[2]||(R[2]=P=>u()),onFocus:R[3]||(R[3]=P=>a.value=!0),ref_key:"codeField",ref:m,"onUpdate:modelValue":R[4]||(R[4]=P=>p(s).code=P)},null,544),[[y,p(s).code]]),l.value?(f(),E("span",ss,D(g.value),1)):F("",!0),oe(" "+D(p(s).code)+" ",1),e("input",{type:"button",onClick:R[5]||(R[5]=P=>h()),disabled:a.value,value:a.value?"Esperando escaneo...":"Escanear codigo",class:"button is-info"},null,8,os)]),e("td",ns,[L(e("input",{class:"input is-upper",placeholder:"10UND","onUpdate:modelValue":R[6]||(R[6]=P=>p(s).packing=P)},null,512),[[y,p(s).packing,void 0,{trim:!0}]])]),e("td",as,[L(e("input",{class:"input is-upper",onInput:R[7]||(R[7]=P=>A()),type:"number",placeholder:"porcentaje","onUpdate:modelValue":R[8]||(R[8]=P=>p(s).profitPercent=P)},null,544),[[y,p(s).profitPercent,void 0,{number:!0}]])]),e("td",rs,[L(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"precio de compra","onUpdate:modelValue":R[9]||(R[9]=P=>p(s).priceBuy=P),onInput:R[10]||(R[10]=P=>A())},null,544),[[y,p(s).priceBuy,void 0,{number:!0}]])]),e("td",ts,[L(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"Precio de Venta","onUpdate:modelValue":R[11]||(R[11]=P=>p(s).priceSale=P)},null,512),[[y,p(s).priceSale]])]),e("td",is,[L(e("input",{class:"input is-upper",type:"number",placeholder:"Cantidad","onUpdate:modelValue":R[12]||(R[12]=P=>p(s).stock=P)},null,512),[[y,p(s).stock]])]),e("td",ls,[e("button",{type:"button",class:"button is-danger",onClick:R[13]||(R[13]=P=>n("quit",o.product.id))},[O(p(W),{size:"25"},{default:k(()=>[O(p(ce))]),_:1})])])]))}}),ms={key:0,class:"modal is-active"},ds=e("div",{class:"modal-background"},null,-1),cs={class:"modal-card"},_s={class:"modal-card-head"},Cs=e("p",{class:"modal-card-title"},"Advertencia",-1),us=e("section",{class:"modal-card-body"},"Algunos codigos estan vacios, \xBFquiere guardar de todas formas?",-1),Ps={class:"modal-card-foot"},Ss={class:"field"},gs={class:"control"},fs={key:0,class:"help is-danger"},Es={class:"table is-bordered"},Rs=e("th",null,"CODIGO",-1),As=e("th",null,"PACKING",-1),Os=e("th",null,"PORCENTAJE DE GANANCIA",-1),Ds=e("th",null,"PRECIO DE COMPRA",-1),Us=e("th",null,"PRECIO DE VENTA",-1),hs=e("th",null,"CANTIDAD",-1),vs=e("button",{class:"button is-primary"},"Guardar producto",-1),Is={key:1,class:"notification is-success"},bs=e("button",{class:"delete"},null,-1),Ls=oe(" Producto guardado con exito "),Ts=[bs,Ls],ys=x({props:{productId:{type:Number,default:-1}},emits:["cancelEdit"],setup(_,{emit:n}){const o=_,i=j(),s=c(),a=c(!1),l=c(),m=c(!1),g=[{pack:"12 UND",profitPercent:25},{pack:"25 UND",profitPercent:25},{pack:"50 UND",profitPercent:25},{pack:"100 UND",profitPercent:25}],A=c(!1),r=X({id:0,name:"",brand:"",tags:"",description:"",features:{},image:""}),d=c([]),u=c([]),h=()=>{u.value=[{id:"V"+Date.now(),code:"",packing:"UND",profitPercent:50,measureUnit:"NIU",priceSale:0,priceBuy:0,stock:0}],g.forEach((N,I)=>{u.value.push({id:"V"+Date.now()+I+1,code:"",packing:N.pack,profitPercent:N.profitPercent,measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})}),r.name="",r.brand="",r.tags="",r.features={},r.description="",r.image="",n("cancelEdit")};he("packedProducts",u),V(async()=>{if(o.productId!==-1){const N=await i.dispatch("fetchPackProducts",{id:o.productId});u.value=N.data.packedProducts,r.name=N.data.product.name,r.id=N.data.product.id}else h()}),Y(()=>{h()});const v=()=>{u.value.push({id:"V"+Date.now(),code:"",packing:"",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})},R=N=>{if(u.value.length===1)return;const I=u.value.findIndex(w=>w.id===N);u.value.splice(I,1)},P=()=>(o.productId!==-1?a.value=i.state.products.some(({name:N,productId:I})=>N.toLowerCase()===r.name.toLowerCase()&&I!==r.id):a.value=i.state.products.some(({name:N})=>N.toLowerCase()===r.name.toLowerCase()),a.value),U=async()=>{if(a.value)return;A.value=!1;const N={action:o.productId!==-1?"edit":"add",data:{product:r,packedProducts:[...u.value]}};(await i.dispatch("savePackingProduct",N)).success&&(h(),q())},B=()=>{s.value.select()},q=()=>{m.value=!0,setTimeout(()=>{m.value=!1},2e3)},H=async()=>{const N={action:o.productId!==-1?"edit":"add",data:{product:r,packedProducts:[...u.value]}};if(P())return;if(u.value.some(w=>w.code==="")){A.value=!0;return}(await i.dispatch("savePackingProduct",N)).success&&(h(),q())};return(N,I)=>(f(),E(G,null,[A.value?(f(),E("div",ms,[ds,e("div",cs,[e("header",_s,[Cs,e("button",{class:"delete","aria-label":"close",onClick:I[0]||(I[0]=w=>A.value=!1)})]),us,e("footer",Ps,[e("button",{onClick:I[1]||(I[1]=w=>U()),class:"button is-success"},"Guradar"),e("button",{onClick:I[2]||(I[2]=w=>A.value=!1),class:"button"},"Cancelar")])])])):F("",!0),e("form",{onSubmit:I[9]||(I[9]=ae(w=>H(),["prevent"])),ref_key:"form",ref:l,class:"box"},[e("div",Ss,[e("label",{class:"label",onClick:I[3]||(I[3]=w=>B())},"Nombre"),e("div",gs,[L(e("input",{class:z(["input upper",{"is-danger":a.value}]),onInput:I[4]||(I[4]=w=>P()),ref_key:"fieldName",ref:s,required:"","onUpdate:modelValue":I[5]||(I[5]=w=>p(r).name=w),type:"text",placeholder:"Nombre"},null,34),[[y,p(r).name,void 0,{trim:!0}]]),a.value?(f(),E("span",fs,"Ya existe un producto con este nombre")):F("",!0)])]),e("table",Es,[e("thead",null,[e("tr",null,[Rs,As,Os,Ds,Us,hs,e("th",null,[e("button",{type:"button",class:"button is-info",onClick:I[6]||(I[6]=w=>v())},"+")])])]),e("tbody",null,[(f(!0),E(G,null,J(u.value,(w,Z)=>(f(),se(ps,{key:w.id,product:w,onQuit:I[7]||(I[7]=K=>R(K)),ref_for:!0,ref:K=>{K&&(d.value[Z]=K)}},null,8,["product"]))),128))])]),vs,o.productId!==-1?(f(),E("button",{key:0,type:"button",onClick:I[8]||(I[8]=w=>n("cancelEdit")),class:"button is-danger"},"Cancelar")):F("",!0)],544),m.value?(f(),E("div",Is,Ts)):F("",!0)],64))}}),Ms={class:"columns"},Fs={class:"column is-6"},ws={class:"column is-6"},Ns=x({setup(_){const n=c(-1),o=s=>{n.value=s},i=()=>{n.value=-1};return(s,a)=>(f(),E("div",Ms,[e("div",Fs,[O(ys,{"product-id":n.value,onCancelEdit:a[0]||(a[0]=l=>i())},null,8,["product-id"])]),e("div",ws,[O(Ze,{onEditProduct:a[1]||(a[1]=l=>o(l))})])]))}}),ks={class:"menu m-4"},xs={class:"menu-list",style:{position:"absolute",height:"auto","max-height":"20rem","overflow-y":"scroll"}},Ws=["title","onClick","innerHTML"],_e=x({emits:["itemSelected"],setup(_,{emit:n}){const o=j(),i=c([]),s=c([]),a=c("");Y(async()=>{await o.dispatch("fetchProducts"),i.value=o.state.products});const l=g=>{const A=a.value.split(" ");if(A.length!==0)return A.forEach(r=>{g=g.toString().toLocaleUpperCase().replace(r.toLocaleUpperCase(),`<span style="background:#6eeeeebb">${r.toLocaleUpperCase()}</span>`)}),g},m=()=>{if(a.value===""){s.value=[];return}const g=a.value;setTimeout(()=>{if(g===a.value){const r=a.value.toLowerCase().split(" "),d=[];let u=0;i.value.forEach(h=>{u=0,r.forEach(v=>{(h.name.toLowerCase().includes(v)||h.code.toString().toLowerCase().includes(v))&&(u+=1)}),u!==0&&(h.matchs=u,d.push(h))}),console.log(d),s.value=d.sort((h,v)=>v.matchs-h.matchs)}},500)};return(g,A)=>(f(),E("div",ks,[L(e("input",{class:"input upper",type:"search",onInput:A[0]||(A[0]=r=>m()),"onUpdate:modelValue":A[1]||(A[1]=r=>a.value=r),placeholder:"Buscar producto"},null,544),[[y,a.value,void 0,{trim:!0}]]),e("ul",xs,[(f(!0),E(G,null,J(s.value,r=>(f(),E("li",{title:"S/. "+r.priceSale,style:{"max-width":"30rem"},onClick:d=>n("itemSelected",r),key:r.id,innerHTML:l(r.name)},null,8,Ws))),128))])]))}}),Gs={class:"control",style:{width:"6.5rem"}},Vs={class:"control"},js=x({props:{product:Object},emits:["quit"],setup(_,{emit:n}){const o=_,i=X(o.product);return V(()=>{i.quantity=i.quantity<1?1:i.quantity,i.mount=i.quantity*i.priceSale}),(s,a)=>(f(),E("tr",null,[e("td",null,D(p(i).code),1),e("td",null,D(p(i).name),1),e("td",null,"S/. "+D(p(i).priceSale),1),e("td",Gs,[L(e("input",{class:"input is-upper",type:"number",min:"1",onClick:a[0]||(a[0]=l=>l.target.select()),placeholder:"Cantidad","onUpdate:modelValue":a[1]||(a[1]=l=>p(i).quantity=l)},null,512),[[y,p(i).quantity]])]),e("td",null,"S/. "+D(p(i).mount),1),e("td",Vs,[e("button",{type:"button",class:"button is-danger",onClick:a[2]||(a[2]=l=>n("quit",o.product.id))},[O(p(W),null,{default:k(()=>[O(p(ce))]),_:1})])])]))}}),$s={key:0,class:"modal is-active"},Hs=e("div",{class:"modal-background"},null,-1),Bs={class:"modal-card"},Ks={class:"modal-card-head"},Js=e("p",{class:"modal-card-title"},"Agregar producto manual",-1),Xs={class:"modal-card-body"},qs={class:"field"},zs=e("label",{class:"label"},"Nombre del producto",-1),Ys={class:"control"},Qs={class:"field is-horizontal"},Zs={class:"field-body"},eo={class:"field"},so=e("label",{class:"label"},"Precio",-1),oo={class:"control"},no={class:"field"},ao=e("label",{class:"label"},"Cantidad",-1),ro={class:"control"},to={class:"modal-card-foot"},io=x({props:{show:Boolean},emits:["addProduct","hide"],setup(_,{emit:n}){const o=_,i=c(o.show),s=X({id:"MP"+Date.now(),code:"MP"+Date.now(),name:"",priceSale:0,quantity:1}),a=()=>{s.name=s.name.toLocaleUpperCase(),n("addProduct",s),s.id="MP"+Date.now(),s.code="MP"+Date.now(),s.name="",s.priceSale=0,s.quantity=1,n("hide")};return V(()=>{i.value=o.show}),(l,m)=>i.value?(f(),E("div",$s,[Hs,e("div",Bs,[e("header",Ks,[Js,e("button",{class:"delete","aria-label":"close",onClick:m[0]||(m[0]=g=>n("hide"))})]),e("section",Xs,[e("div",qs,[zs,e("p",Ys,[L(e("input",{class:"input is-upper",placeholder:"NOMBRE","onUpdate:modelValue":m[1]||(m[1]=g=>p(s).name=g)},null,512),[[y,p(s).name]])])]),e("div",Qs,[e("div",Zs,[e("div",eo,[so,e("p",oo,[L(e("input",{class:"input is-upper",placeholder:"Precio",min:"0.1",step:"0.01","onUpdate:modelValue":m[2]||(m[2]=g=>p(s).priceSale=g)},null,512),[[y,p(s).priceSale]])])]),e("div",no,[ao,e("p",ro,[L(e("input",{class:"input is-upper",placeholder:"Precio",min:"0.1",step:"0.01","onUpdate:modelValue":m[3]||(m[3]=g=>p(s).quantity=g)},null,512),[[y,p(s).quantity]])])])])])]),e("footer",to,[e("button",{onClick:m[4]||(m[4]=g=>a()),class:"button is-success"},"Agregar producto"),e("button",{onClick:m[5]||(m[5]=g=>n("hide")),class:"button"},"Cancelar")])])])):F("",!0)}}),lo={key:0,class:"modal is-active"},po=e("div",{class:"modal-background"},null,-1),mo={class:"modal-card"},co={class:"modal-card-head"},_o=e("p",{class:"modal-card-title"},"Nueva Venta",-1),Co={class:"modal-card-body"},uo={style:{display:"none"}},Po={key:0,class:"column"},So={class:"field is-horizontal"},go={class:"field-body"},fo={class:"field has-addons"},Eo={class:"control"},Ro={class:"select"},Ao=["disabled"],Oo=["value"],Do={class:"control"},Uo=["placeholder"],ho={class:"field"},vo={class:"control is-expanded"},Io=["disabled"],bo={key:0,class:"field"},Lo={class:"control is-expanded"},To={key:1,class:"notification is-danger mt-5"},yo={class:"modal-card-foot"},Mo=["disabled"],Fo=x({props:{show:Boolean,client:Object,loading:{type:Boolean,default:!1}},emits:["save","hide"],setup(_,{emit:n}){const o=_,i=j(),s=c(o.show),a=c(o.loading),l=c("ticket"),m=c(!1),g=c(""),A=[{code:1,name:"DNI",length:8},{code:4,name:"CARNET DE EXTRANGERIA",length:12},{code:6,name:"RUC",length:11},{code:7,name:"PASAPORTE",length:12}],r=X(o.client);V(()=>{s.value=o.show}),V(()=>{a.value=o.loading}),V(()=>{r.documentType=1,r.document="",r.name="",r.email="",l.value==="factura"&&(r.documentType=6,r.document="",r.name="")});const d=Q(()=>A.find(R=>R.code===r.documentType)),u=async()=>{if(!(d.value.code!==1&&d.value.code!==6)&&(""+r.document).length===d.value.length){const R=await i.dispatch("getInfoDoc",{typeDoc:d.value.code,document:r.document});r.name=R.nombre}};V(()=>{m.value&&setTimeout(()=>{m.value=!1},2500)});const h=()=>{if(l.value!=="ticket"){if(r.document===""||r.name===""){g.value="El documento o el nombre no puede ser vacio",m.value=!0;return}if(l.value==="factura"&&r.email===""){g.value="Se nesesita un email para emitir factura",m.value=!0;return}}n("save",l.value)},v=()=>{r.document=r.document.replace(/\D/,""),r.document.length>d.value.length&&(r.document=r.document.slice(0,d.value.length))};return(R,P)=>s.value?(f(),E("div",lo,[po,e("div",mo,[e("header",co,[_o,e("button",{class:"delete","aria-label":"close",onClick:P[0]||(P[0]=U=>n("hide"))})]),e("section",Co,[e("label",{for:"ticket",class:z(["button",{"is-primary":l.value==="ticket"}])},"Ticket",2),e("label",{for:"boleta",class:z(["button",{"is-primary":l.value==="boleta"}])},"Boleta",2),e("label",{for:"factura",class:z(["button",{"is-primary":l.value==="factura"}])},"Factura",2),e("div",uo,[L(e("input",{type:"radio","onUpdate:modelValue":P[1]||(P[1]=U=>l.value=U),id:"boleta",value:"boleta"},null,512),[[re,l.value]]),L(e("input",{type:"radio","onUpdate:modelValue":P[2]||(P[2]=U=>l.value=U),id:"factura",value:"factura"},null,512),[[re,l.value]]),L(e("input",{type:"radio","onUpdate:modelValue":P[3]||(P[3]=U=>l.value=U),id:"ticket",value:"ticket"},null,512),[[re,l.value]])]),l.value!=="ticket"?(f(),E("div",Po,[e("div",So,[e("div",go,[e("div",fo,[e("p",Eo,[e("span",Ro,[L(e("select",{"onUpdate:modelValue":P[4]||(P[4]=U=>p(r).documentType=U),disabled:l.value==="factura"},[(f(),E(G,null,J(A,U=>e("option",{key:U.code,value:U.code},D(U.name),9,Oo)),64))],8,Ao),[[te,p(r).documentType]])])]),e("p",Do,[L(e("input",{class:"input is-upper",placeholder:p(d).name,onInput:P[5]||(P[5]=U=>(v(),u())),"onUpdate:modelValue":P[6]||(P[6]=U=>p(r).document=U)},null,40,Uo),[[y,p(r).document]])])])])]),e("div",ho,[e("p",vo,[L(e("input",{class:"input is-upper",placeholder:"nombre",type:"text","onUpdate:modelValue":P[7]||(P[7]=U=>p(r).name=U),disabled:p(r).documentType===6||p(r).documentType===1},null,8,Io),[[y,p(r).name]])])]),l.value==="factura"?(f(),E("div",bo,[e("p",Lo,[L(e("input",{class:"input",placeholder:"Email",type:"text","onUpdate:modelValue":P[8]||(P[8]=U=>p(r).email=U)},null,512),[[y,p(r).email]])])])):F("",!0)])):F("",!0),m.value?(f(),E("div",To,[e("button",{onClick:P[9]||(P[9]=U=>m.value=!1),class:"delete"}),oe(" "+D(g.value),1)])):F("",!0)]),e("footer",yo,[e("button",{disabled:a.value,onClick:P[10]||(P[10]=U=>h()),class:"button is-success"},"Imprimir "+D(l.value),9,Mo),e("button",{onClick:P[11]||(P[11]=U=>n("hide")),class:"button"},"Cancelar")])])])):F("",!0)}}),wo={class:"columns"},No={class:"column is-4"},ko={class:"field"},xo={class:"label"},Wo={class:"control"},Go=["disabled"],Vo={class:"field"},jo={class:"field"},$o={class:"column is-8"},Ho={class:"table is-bordered is-striped is-fullwidth"},Bo=e("thead",null,[e("tr",null,[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto"),e("th")])],-1),Ko=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),Jo=e("th",null,null,-1),Xo=e("div",null,null,-1),qo=["disabled"],zo={key:0,class:"notification is-danger mt-5"},Yo={style:{display:"none"}},Qo=["srcdoc"],Zo=x({setup(_){const n=j(),o=c(""),i=c(),s=c(!1),a=c([]),l=c(""),m=c(!1),g=c(!1),A=c(!1),r=c(!1),d=c(""),u=X({documentType:1,document:"0",name:"",email:""}),h=Q(()=>`
  <html>
  <head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300&display=swap" rel="stylesheet">
   <style>
  pre{
    font-family: 'Roboto Mono', monospace;
    font-weight: bold;
    padding:1rem;
    width:460px
    
  }
  </style></head>
  <body>
 
  <pre >
      ${R.value}
  </pre>
  </body>
  </html>
  `),v=C=>{if(C<=0)return"";let t="";for(let S=0;S<C;S++)t+=" ";return t},R=Q(()=>`
            INVERSIONES VILVER E.I.R.L
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba   

    BOLETA DE VENTA ELECTRONICA 0000-0000000

Fecha de emision:2006-04-09
ID Venta: 0000546-5s654-sds645-sds65

DNI Cliente:${u.document}
Nombre Cliente:${u.name}
${l.value}
                 Subtotal:           S/${Math.round((H.value*(100/118)+Number.EPSILON)*10)/10}
                 IGV(18%):           S/${Math.round((H.value*(18/118)+Number.EPSILON)*10)/10}
                 Total:              S/${H.value}
------------------------------------------------  `),P=C=>{let t="";for(let S=0;S<8-C.toString().length;S++)t+="0";return t+C.toString()},U=()=>{u.documentType=1,u.document="0",u.name="",u.email="",a.value=[]},B=(C,t,S,b,T=[])=>{let $=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return t==="ticket"?$+=`
              TICKET DE VENTA ELECTRONICO 
      `:$+=`
         ${t.toLocaleUpperCase()} ELECTRONICA ${T.serie}-${P(T.correlative)}
      `,$+=`
Fecha de emision:${t!=="ticket"?T.dateTime:S.dateTime}
ID Venta: 00000${S.id}
  `,t!=="ticket"&&($+=`
CLIENTE:
Documento: ${b.document}
Nombre: ${b.name}
`),$+=q(a.value),$+=`
                OP.GRAVADAS:        S/ ${Math.round((S.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((S.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${S.total}
------------------------------------------------ 
${C}

************************************************
            !GRACIAS POR SU COMPRA!
`,$},q=C=>{let t="",S="",b=`
------------------------------------------------
`;return b+=`PRODUCTO                 CANT P.UNI   MONTO
`,b+=`------------------------------------------------
`,C.forEach(T=>{t=T.name.slice(0,24)+v(24-T.name.length),t+="  ",t+=""+T.quantity+v(3-(""+T.quantity).length),t+=" S/",t+=""+T.priceSale+v(6-(""+T.priceSale).length),t+=" S/",t+=""+T.mount+v(7-(""+T.mount).length),b+=`${t}
`,T.name.length>24&&(S=T.name.slice(24,48),b+=`${S}
`),T.name.length>48&&(S=T.name.length>72?T.name.slice(48,72)+"...":T.name.slice(48),b+=`${S}
`)}),b+=`------------------------------------------------
`,b},H=Q(()=>a.value.reduce((C,t)=>C+t.mount,0)),N=C=>n.state.products.find(({code:S})=>S.toString()===o.value),I=({id:C,code:t,name:S,priceSale:b,quantity:T})=>{const $={id:C,code:t,name:S,priceSale:b,quantity:T!=null?T:1,mount:b*1};if(a.value.every(ee=>ee.id!==C))a.value.push($);else{const ee=a.value.findIndex(Se=>Se.id===C);a.value[ee].quantity+=1,a.value[ee].mount=$.priceSale*a.value[ee].quantity}a.value.length===0&&a.value.push($),o.value=""},w=C=>{const t=a.value.findIndex(S=>S.id===C);a.value.splice(t,1)};Y(async()=>{try{await n.dispatch("fetchProducts");const t=await(await fetch("http://localhost:5050/devices")).json()}catch{r.value=!0,d.value="No se encuentra el controlador de la impresora por favor inicie el controlador y configure la impresora"}});const Z=()=>{const C=o.value;setTimeout(()=>{if(o.value===C){const t=N(o.value);t&&I(t),o.value=""}},100)},K=async C=>{g.value=!0;const t=await n.dispatch("saveSale",{soldProducts:a.value,client:u,typeProof:C});let S="";C!=="ticket"?S=B(t.legend,C,t.sale,t.client,t.proof.data):S=B(t.legend,C,t.sale,t.client,[]),console.log(S);try{S=S.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),await n.dispatch("printerTicket",{text:S}),g.value=!1}catch{g.value=!1,d.value="La venta se ha registrado exitosamente, pero no se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",r.value=!0}finally{U(),m.value=!1}},ne=()=>{o.value="",i.value.focus()},M=()=>{if(a.value.some(C=>C.priceSale===0)){d.value="Los precios no pueden ser cero",r.value=!0,setTimeout(()=>{r.value=!1},3e3);return}m.value=!0};return(C,t)=>(f(),E(G,null,[O(Fo,{show:m.value,onHide:t[0]||(t[0]=S=>m.value=!1),client:p(u),onSave:t[1]||(t[1]=S=>K(S)),loading:g.value},null,8,["show","client","loading"]),O(io,{show:A.value,onHide:t[2]||(t[2]=S=>A.value=!1),onAddProduct:t[3]||(t[3]=S=>I(S))},null,8,["show"]),e("div",wo,[e("div",No,[L(e("input",{required:"",autocomplete:"off",onInput:t[4]||(t[4]=S=>Z()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:t[5]||(t[5]=S=>S.target.blur()),onBlur:t[6]||(t[6]=S=>s.value=!1),onFocus:t[7]||(t[7]=S=>s.value=!0),ref_key:"fieldCode",ref:i,"onUpdate:modelValue":t[8]||(t[8]=S=>o.value=S)},null,544),[[y,o.value]]),e("div",ko,[e("label",xo,"Codigo "+D(": "+o.value),1),e("div",Wo,[e("button",{tabindex:"-1",class:"button is-success",disabled:s.value,type:"button",onClick:t[9]||(t[9]=S=>ne())},D(s.value?"Escaneando codigos...":"Escanear codigos"),9,Go)])]),e("div",Vo,[e("input",{type:"button",class:"button is-info",onClick:t[10]||(t[10]=S=>A.value=!0),value:"Agregar producto manualmente"})]),e("div",jo,[O(_e,{onItemSelected:t[11]||(t[11]=S=>I(S))})])]),e("div",$o,[e("table",Ho,[Bo,e("tbody",null,[(f(!0),E(G,null,J(a.value,S=>(f(),se(js,{key:S.id,product:S,onQuit:t[12]||(t[12]=b=>w(b))},null,8,["product"]))),128)),e("tr",null,[Ko,e("th",null,"S/. "+D(p(H)),1),Jo])])]),Xo,e("button",{disabled:a.value.length===0,onClick:t[13]||(t[13]=S=>M()),class:"button is-primary"},"Realizar venta",8,qo),r.value?(f(),E("div",zo,[e("button",{onClick:t[14]||(t[14]=S=>r.value=!1),class:"delete"}),oe(" "+D(d.value),1)])):F("",!0)]),e("div",Yo,[e("iframe",{style:{width:"550px",height:"900px",padding:"0"},name:"page-printer",srcdoc:p(h)},null,8,Qo)])])],64))}}),en={key:0,class:"modal is-active",style:{"z-index":"9999"}},sn=e("div",{class:"modal-background"},null,-1),on={class:"modal-content",style:{width:"35%",height:"30%"}},nn={class:"message is-danger"},an={class:"message-header"},rn=e("p",null,"Danger",-1),tn={class:"message-body"},ln=e("span",null,"Una vez que se dea de baja ya no se podra recuperar",-1),pn=e("br",null,null,-1),mn=e("br",null,null,-1),dn={key:0,class:"field"},cn=e("label",{class:"label"},"Motivo de Baja",-1),_n={class:"control"},Cn=["disabled"],un={key:1,class:"modal is-active"},Pn=e("div",{class:"modal-background"},null,-1),Sn={class:"modal-card",style:{width:"50%",height:"70%"}},gn={class:"modal-card-head"},fn=e("p",{class:"modal-card-title"},"Detalles de la venta",-1),En={class:"modal-card-body"},Rn={key:0,class:"notification is-danger"},An={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},On=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Comprobante")])],-1),Dn={key:0,style:{"padding-top":"2px"}},Un=e("th",null,"Tipo",-1),hn=e("th",null,"Serie-Correlativo",-1),vn=e("th",null,"Fecha y hora de emision",-1),In={colspan:"2"},bn=["disabled"],Ln={key:0,class:"tag is-danger m-2"},Tn={key:1,style:{"padding-top":"2px"}},yn=e("tr",null,[e("th",null,"SIN COMPROBANTE")],-1),Mn=[yn],Fn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},wn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"2",style:{"text-align":"center"}},"Cliente")])],-1),Nn={style:{"padding-top":"2px"}},kn=e("th",null,"Documento",-1),xn=e("th",null,"Nombre",-1),Wn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Gn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Productos Vendidos")]),e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto")])],-1),Vn={style:{"padding-top":"2px"}},jn=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),$n={class:"modal-card-foot"},Hn=["disabled"],Bn=x({props:{show:Boolean,saleId:Number},emits:["save","hide"],setup(_,{emit:n}){const o=_,i=j(),s=c(o.show),a=c(!1),l=c("ticket"),m=c(!1),g=c(""),A=c(0),r=c({}),d=c({}),u=c({}),h=c(""),v=c(!1),R=c(!1),P=c(!1),U=c(!0),B=c("ERROR EN LOS CALCULOS"),q=c(o.saleId),H=c([]);V(()=>{s.value=o.show}),V(async()=>{if(o.saleId===0)return;v.value=!1,q.value=o.saleId;const M=await i.dispatch("fetchSaleDetail",{id:q.value});console.log(M),v.value=!0,H.value=M.data.soldProducts,A.value=M.data.sale.total,r.value=M.data.client,d.value=M.data.proof,h.value=M.data.legend,u.value=M.data.sale,U.value=d.value.enable===1&&(d.value.status===1||d.value.status===2||d.value.status===4),l.value=d.value===!1?"ticket":d.value.serie.startsWith("B")?"boleta":"factura"}),V(()=>{m.value&&setTimeout(()=>{m.value=!1},2500)});const N=(M,C,t,S,b=[])=>{let T=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return C==="ticket"?T+=`
              TICKET DE VENTA ELECTRONICO 
      `:T+=`
         ${C.toLocaleUpperCase()} ELECTRONICA ${b.serie}-${I(b.correlative)}
      `,T+=`
Fecha de emision:${C!=="ticket"?b.dateTime:t.dateTime}
ID Venta: 00000${t.id}
  `,C!=="ticket"&&(T+=`
CLIENTE:
Documento: ${S.document}
Nombre: ${S.name}
`),T+=Z(H.value),T+=`
                OP.GRAVADAS:        S/ ${Math.round((t.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((t.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${t.total}
------------------------------------------------ 
${M}

************************************************
            !GRACIAS POR SU COMPRA!
`,T},I=M=>{let C="";for(let t=0;t<8-M.toString().length;t++)C+="0";return C+M.toString()},w=M=>{if(M<=0)return"";let C="";for(let t=0;t<M;t++)C+=" ";return C},Z=M=>{let C="",t="",S=`
------------------------------------------------
`;return S+=`PRODUCTO                 CANT P.UNI   MONTO
`,S+=`------------------------------------------------
`,M.forEach(b=>{C=b.name.slice(0,24)+w(24-b.name.length),C+="  ",C+=""+b.quantity+w(3-(""+b.quantity).length),C+=" S/",C+=""+b.price+w(6-(""+b.price).length),C+=" S/",C+=""+b.mount+w(7-(""+b.mount).length),S+=`${C}
`,b.name.length>24&&(t=b.name.slice(24,48),S+=`${t}
`),b.name.length>48&&(t=b.name.length>72?b.name.slice(48,72)+"...":b.name.slice(48),S+=`${t}
`)}),S+=`------------------------------------------------
`,S},K=async()=>{R.value=!0;let M=N(h.value,l.value,u.value,r.value,d.value);try{M=M.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),console.log(M),await i.dispatch("printerTicket",{text:M}),R.value=!1}catch{R.value=!1,g.value="No se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",m.value=!0,setTimeout(()=>{m.value=!1},1e4)}},ne=async()=>{P.value=!0;try{await i.dispatch("darBaja",{proofId:d.value.id,typeProof:l.value,motivoBaja:B.value}),P.value=!1,g.value="Comprobante Dado de baja con exito",m.value=!0,U.value=!1,a.value=!1,setTimeout(()=>{m.value=!1},1e4)}catch(M){P.value=!1,g.value=M,m.value=!0,U.value=!0,setTimeout(()=>{m.value=!1},1e4)}};return(M,C)=>(f(),E(G,null,[a.value?(f(),E("div",en,[sn,e("div",on,[e("article",nn,[e("div",an,[rn,e("button",{class:"delete",onClick:C[0]||(C[0]=t=>a.value=!1),"aria-label":"delete"})]),e("div",tn,[e("span",null,"\xBF\xBF Esta seguro de dar de baja esta "+D(l.value)+"?",1),ln,pn,mn,l.value==="factura"?(f(),E("div",dn,[cn,e("p",_n,[L(e("input",{class:"input is-upper",placeholder:"ejemplo: ruc equibocado","onUpdate:modelValue":C[1]||(C[1]=t=>B.value=t)},null,512),[[y,B.value]])])])):F("",!0),e("button",{disabled:P.value,class:"button is-danger mx-2",onClick:C[2]||(C[2]=t=>ne())},"Dar de baja",8,Cn),e("button",{class:"button",onClick:C[3]||(C[3]=t=>a.value=!1)},"Cancelar")])])])])):F("",!0),s.value&&v.value?(f(),E("div",un,[Pn,e("div",Sn,[e("header",gn,[fn,e("button",{class:"delete","aria-label":"close",onClick:C[4]||(C[4]=t=>n("hide"))})]),e("section",En,[m.value?(f(),E("div",Rn,[e("button",{onClick:C[5]||(C[5]=t=>m.value=!1),class:"delete"}),oe(" "+D(g.value),1)])):F("",!0),e("table",An,[On,d.value!==!1?(f(),E("tbody",Dn,[e("tr",null,[Un,e("td",null,D(l.value.toLocaleUpperCase()),1)]),e("tr",null,[hn,e("td",null,D(d.value.serie)+"-"+D(I(d.value.correlative)),1)]),e("tr",null,[vn,e("td",null,D(d.value.dateTime),1)]),e("tr",null,[e("td",In,[e("button",{type:"button",onClick:C[6]||(C[6]=t=>a.value=!0),disabled:!U.value,class:"button is-danger"},"DAR DE BAJA LA "+D(l.value.toLocaleUpperCase()),9,bn),U.value?F("",!0):(f(),E("span",Ln," LA "+D(l.value.toLocaleUpperCase())+" YA HA SIDO DADA DE BAJA",1))])])])):F("",!0),d.value===!1?(f(),E("tbody",Tn,Mn)):F("",!0)]),e("table",Fn,[wn,e("tbody",Nn,[e("tr",null,[kn,e("td",null,D(r.value.document),1)]),e("tr",null,[xn,e("td",null,D(r.value.name),1)])])]),e("table",Wn,[Gn,e("tbody",Vn,[(f(!0),E(G,null,J(H.value,t=>(f(),E("tr",{key:t.id},[e("td",null,D(t.code),1),e("td",null,D(t.name),1),e("td",null,"S/ "+D(t.price),1),e("td",null,D(t.quantity),1),e("td",null,"S/ "+D(t.mount),1)]))),128)),e("tr",null,[jn,e("th",null,"S/. "+D(A.value),1)])])])]),e("footer",$n,[e("button",{disabled:R.value||!U.value&&l.value!=="ticket",onClick:C[7]||(C[7]=t=>K()),class:"button is-success"},"Imprimir copia de "+D(l.value),9,Hn),e("button",{onClick:C[8]||(C[8]=t=>n("hide")),class:"button"},"Cancelar")])])])):F("",!0)],64))}});const Kn={class:"columns"},Jn={class:"column is-11"},Xn={class:"control has-icons-left"},qn={class:"column is-1"},zn={class:"h-100 oy-scroll"},Yn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Qn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"ID"),e("th",null,"Cliente"),e("th",null,"Documento Cliente"),e("th",null,"Fecha emision"),e("th",null,"Importe Total"),e("th")])],-1),Zn={style:{"padding-top":"2px"}},ea=["onClick"],Ce=x({setup(_){const n=j(),o=c([]),i=c([]),s=c(""),a=c(!1),l=c(0);Y(async()=>{const A=await n.dispatch("fetchSales");o.value=A.data.reverse(),i.value=o.value});const m=()=>{const A=s.value.toLowerCase();i.value=o.value.filter(r=>r.clientName.toLowerCase().includes(A)||r.clientDocument.toString().toLowerCase().includes(A))},g=async()=>{const A=await n.dispatch("fetchSales");o.value=A.data.reverse(),i.value=o.value};return(A,r)=>(f(),E(G,null,[O(Bn,{saleId:l.value,show:a.value,onHide:r[0]||(r[0]=d=>a.value=!1)},null,8,["saleId","show"]),e("div",Kn,[e("div",Jn,[e("div",Xn,[L(e("input",{class:"input",type:"search",onInput:r[1]||(r[1]=d=>m()),"onUpdate:modelValue":r[2]||(r[2]=d=>s.value=d),placeholder:"Buscar por nombre o documento"},null,544),[[y,s.value,void 0,{trim:!0}]]),O(p(W),{class:"icon is-large is-left"},{default:k(()=>[O(p(pe))]),_:1})])]),e("div",qn,[e("button",{class:"button is-primary",onClick:r[3]||(r[3]=d=>g())},[O(p(W),{class:"icon is-large is-left"},{default:k(()=>[O(p(me))]),_:1})])])]),e("div",zn,[e("table",Yn,[Qn,e("tbody",Zn,[(f(!0),E(G,null,J(i.value,d=>(f(),E("tr",{key:d.id},[e("td",null,D(d.id),1),e("td",null,D(d.clientName),1),e("td",null,D(d.clientDocument),1),e("td",null,D(d.dateTime),1),e("td",null,D(d.total),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:u=>(l.value=d.id,a.value=!0)},[O(p(W),null,{default:k(()=>[O(p(de))]),_:1})],8,ea)])]))),128))])])])],64))}}),sa=x({setup(_){const n=c("new");return(o,i)=>(f(),E("div",null,[e("button",{class:"button is-info",onClick:i[0]||(i[0]=s=>n.value="new")},"Nueva Venta"),e("button",{class:"button is-info",onClick:i[1]||(i[1]=s=>n.value="list")},"Lista de ventas"),n.value==="new"?(f(),se(Zo,{key:0})):F("",!0),n.value==="list"?(f(),se(Ce,{key:1})):F("",!0)]))}}),oa={class:"columns"},na={class:"column"},aa=["value"],ra=x({setup(_){const n=c([]),o=c("");Y(async()=>{const a=await(await fetch("http://localhost:5050/devices")).json();n.value=a,o.value=localStorage.printer});const i=()=>{localStorage.printer=o.value};return(s,a)=>(f(),E("div",oa,[e("div",na,[L(e("select",{"onUpdate:modelValue":a[0]||(a[0]=l=>o.value=l)},[(f(!0),E(G,null,J(n.value,l=>(f(),E("option",{key:l.vendor_id,value:l.product_id+"/"+l.vendor_id},D(l.vendor_id)+":"+D(l.product_id)+" "+D(l.name),9,aa))),128))],512),[[te,o.value]]),e("button",{class:"button is-primary",onClick:a[1]||(a[1]=l=>i())},"Guardar")])]))}}),ta=["onSubmit"],ia={class:"field"},la=e("label",{class:"label"},"Usuario",-1),pa={class:"control has-icons-left"},ma={class:"field"},da=e("label",{class:"label"},"Contrase\xF1a",-1),ca={class:"control has-icons-left"},_a={class:"field"},Ca={class:"control is-expanded"},ua=e("button",{class:"button is-primary is-medium input mt-2"},"Iniciar Sesion",-1),Pa={key:0,class:"help is-danger"},Sa=x({setup(_){const n=j(),o=c(!1),i=ve(),s=X({userName:"",password:""}),a=async()=>{const l=await n.dispatch("userLogin",{credentials:s});if(o.value=!l.success,l.success){const m=await n.dispatch("fetchProducts");console.log(m),i.replace("products")}console.log(l.message)};return(l,m)=>(f(),E("form",{onSubmit:ae(a,["prevent"]),class:"box column is-4 is-offset-4"},[e("div",ia,[la,e("div",pa,[L(e("input",{class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":m[0]||(m[0]=g=>p(s).userName=g),placeholder:"Nombre de usuario"},null,512),[[y,p(s).userName]]),O(p(W),{class:"icon is-large is-left"},{default:k(()=>[O(p(Ie))]),_:1})])]),e("div",ma,[da,e("div",ca,[L(e("input",{class:"input is-medium",required:"","onUpdate:modelValue":m[1]||(m[1]=g=>p(s).password=g),type:"password",placeholder:"************"},null,512),[[y,p(s).password]]),O(p(W),{class:"icon is-large is-left"},{default:k(()=>[O(p(be))]),_:1})])]),e("div",_a,[e("p",Ca,[ua,o.value?(f(),E("span",Pa,"Error al iniciar session")):F("",!0)])])],40,ta))}}),ga=["onSubmit"],fa={class:"field"},Ea={class:"control"},Ra={key:0,class:"help is-danger"},Aa={class:"field"},Oa=e("label",{class:"label"},"DNI",-1),Da={class:"control"},Ua={class:"field"},ha=e("label",{class:"label"},"Nombres y Apellidos",-1),va={class:"control"},Ia={class:"field"},ba=e("label",{class:"label"},"Contrase\xF1a",-1),La={class:"control"},Ta={key:0,class:"help is-danger"},ya={class:"field"},Ma=e("label",{class:"label"},"Repetir Contrase\xF1a",-1),Fa={class:"control"},wa={key:0,class:"help is-danger"},Na={class:"field"},ka=e("label",{class:"label"},"Celular",-1),xa={class:"control"},Wa={class:"field"},Ga=e("label",{class:"label"},"Email",-1),Va={class:"control"},ja=e("button",{class:"button is-primary"},"Registrar usuario",-1),$a=x({setup(_){const n=c(),o=j(),i=c(!1),s=c([]),a=X({userName:"",dni:"",fullName:"",email:"",password:"",roleId:"1",mobile:""}),l=c(""),m=c(!1),g=()=>{a.password!==l.value?m.value=!0:m.value=!1};Y(async()=>{const r=await o.dispatch("fetchRoles");s.value=r.data});const A=async()=>{if(a.password!==l.value){m.value=!0;return}const r=await o.dispatch("userSignup",{user:a});i.value=r.success,r.success&&(n.value.reset(),alert(`usuario registrado 
 UserName: `+r.data.userName)),console.log(r.message)};return(r,d)=>(f(),E("form",{onSubmit:ae(A,["prevent"]),ref_key:"form",ref:n},[e("div",fa,[e("div",Ea,[i.value?F("",!0):(f(),E("span",Ra,"Ya existe un producto con este codigo"))])]),e("div",Aa,[Oa,e("div",Da,[L(e("input",{class:"input",ref:"fieldName","onUpdate:modelValue":d[0]||(d[0]=u=>p(a).dni=u),type:"number",placeholder:"documento de identidad"},null,512),[[y,p(a).dni]])])]),e("div",Ua,[ha,e("div",va,[L(e("input",{class:"input",ref:"fieldName",required:"","onUpdate:modelValue":d[1]||(d[1]=u=>p(a).fullName=u),type:"text",placeholder:"Nombres y apellidos"},null,512),[[y,p(a).fullName]])])]),e("div",Ia,[ba,e("div",La,[L(e("input",{class:z(["input",{"is-danger":m.value}]),required:"",step:"0.1","onUpdate:modelValue":d[2]||(d[2]=u=>p(a).password=u),type:"password",placeholder:"Contrase\xF1a"},null,2),[[y,p(a).password]]),m.value?(f(),E("span",Ta,"Las contrase\xF1as deven ser iguales")):F("",!0)])]),e("div",ya,[Ma,e("div",Fa,[L(e("input",{class:z(["input",{"is-danger":m.value}]),onBlur:d[3]||(d[3]=u=>g()),required:"",step:"0.1","onUpdate:modelValue":d[4]||(d[4]=u=>l.value=u),type:"password",placeholder:"Vuelva a escribir la contrase\xF1a"},null,34),[[y,l.value]]),m.value?(f(),E("span",wa,"Las contrase\xF1as deven ser iguales")):F("",!0)])]),e("div",Na,[ka,e("div",xa,[L(e("input",{class:"input",step:"0.1","onUpdate:modelValue":d[5]||(d[5]=u=>p(a).mobile=u),type:"number",placeholder:"Numero de celular"},null,512),[[y,p(a).mobile]])])]),e("div",Wa,[Ga,e("div",Va,[L(e("input",{class:"input",ref:"fieldName","onUpdate:modelValue":d[6]||(d[6]=u=>p(a).email=u),type:"text",placeholder:"Correo electronico"},null,512),[[y,p(a).email]])])]),ja],40,ga))}}),Ha={class:"menu"},Ba=["srcdoc"],Ka=x({props:{product:Object,stock:Number,rows:Number},setup(_){const n=_,o=c(),i=c(),s=c(""),a=async(m,g)=>{const A=i.value.src;let r=`
   <html style="width:105mm;padding:0;margin:0" >
  <head>
   </head>
   <body style="width:105mm;padding:0;margin:0">`;for(let d=0;d<Math.ceil(g/3);d++){r+='<div style="display:block;width:110mm;margin:0 auto">',r+='<div style="margin:0 auto;padding:0 3mm 0 3mm;width:100%;display:flex;grid-template-columns: repeat(3, 1fr);font-family:arial;font-weight: bold;justify-content:space-evenly ;height:20mm ;page-break-after: always">';for(let u=0;u<3;u++)r+=`<div style="display: flex;flex-direction: column;align-items: center;font-size: 10px;widt:30mm;max-width:30mm;border:1px solid black;padding:2px;text-align:center;height:19mm">
    <span style="margin: 0;padding: 0;z-index: 1;word-wrap:break-word;word-break: break-all;">${m.name}</span>
    <img style="width:29mm" src="${A}"/>
    <span style="margin: 0;padding: 0;z-index: 1">${m.code}</span>
    </div>`;r+="</div></div>"}r+=`</div> </body>
  </html>`,s.value=r},l=async(m,g)=>{const A=i.value.src;let r=`
   <html style="width:105mm;padding:0;margin:0" >
  <head>
   </head>
   <body style="width:105mm;padding:0;margin:0">`;for(let d=0;d<Math.ceil(g/2);d++){r+='<div style="display:block;width:108mm;margin:0 auto">',r+='<div style="margin:0 auto;padding:0;width:100%;display:flex;grid-template-columns: repeat(2, 1fr);font-family:arial;font-weight: bold;justify-content:space-evenly ;height:25mm ;page-break-after: always">';for(let u=0;u<2;u++)r+=`<div style="display: flex;flex-direction: column;align-items: center;font-size: 10px;max-width:45mm;border:1px solid black;padding:2px;text-align:center;justify-content:center;height:24mm">
    <span style="margin: 0;padding: 0;z-index: 1;word-wrap:break-word;word-break: break-all;">${m.name}</span>
    <img style="width:42mm" src="${A}"/>
    <span style="margin: 0;padding: 0;z-index: 1">${m.code}</span>
    </div>`;r+="</div></div>"}r+=`</div> </body>
  </html>`,s.value=r};return V(async()=>{Le("#barcode",n.product.code,{displayValue:!1,height:20,width:1,margin:0}),n.rows===2?await l(n.product,n.stock):await a(n.product,n.stock)}),(m,g)=>(f(),E("div",Ha,[e("iframe",{id:"printf",name:"printf",ref_key:"pdf",ref:o,style:{width:"1000px",height:"900px",border:"1x solid red"},srcdoc:s.value},null,8,Ba),e("img",{ref_key:"img",ref:i,id:"barcode",style:{display:"none"}},null,512)]))}}),Ja={class:"columns"},Xa={class:"column is-4"},qa={class:"field columns"},za={class:"column is-6"},Ya=e("label",{class:"label"},"Cantidad",-1),Qa={class:"control"},Za={class:"column is-6"},er=e("label",{class:"label"},"Cantidad por fila",-1),sr={class:"control"},or=e("option",{value:"3"},"3 por fila",-1),nr=e("option",{value:"2"},"2 por fila",-1),ar=[or,nr],rr=x({setup(_){const n=c({}),o=c(6),i=c(3),s=()=>{const l=window;l.frames.printf.focus(),l.frames.printf.print()},a=l=>{n.value=l,console.log(l.code)};return(l,m)=>(f(),E("div",Ja,[e("form",Xa,[e("div",qa,[e("div",za,[Ya,e("div",Qa,[L(e("input",{type:"number",class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":m[0]||(m[0]=g=>o.value=g),placeholder:"Cantidad"},null,512),[[y,o.value,void 0,{number:!0}]])])]),e("div",Za,[er,e("div",sr,[L(e("select",{"onUpdate:modelValue":m[1]||(m[1]=g=>i.value=g),class:"input"},ar,512),[[te,i.value,void 0,{number:!0}]])])])]),e("button",{type:"button",onClick:m[2]||(m[2]=g=>s()),class:"button is-primary is-medium"},"Imprimir Codigos"),O(_e,{onItemSelected:m[3]||(m[3]=g=>a(g))})]),O(Ka,{class:"column is-8",product:n.value,stock:o.value,rows:i.value},null,8,["product","stock","rows"])]))}}),tr={class:"columns"},ir={class:"column is-4"},lr=x({setup(_){const n=j(),o=()=>{const i=n.dispatch("sendSummaries");console.log(i)};return(i,s)=>(f(),E("div",tr,[e("form",ir,[e("button",{type:"button",onClick:s[0]||(s[0]=a=>o()),class:"button is-primary is-medium"},"Generar y envia resumenes")])]))}}),pr=[{path:"/login",name:"login",component:Sa},{path:"/sales",name:"sales",component:sa},{path:"/listSales",name:"listSales",component:Ce},{path:"/printers",name:"printers",component:ra},{path:"/products",name:"products",component:Ns},{path:"/signup",name:"signup",component:$a},{path:"/barcodes",name:"barcodes",component:rr},{path:"/proofPayments",name:"proofPayments",component:lr}],ue=Te({history:ye("vilcherrez"),routes:pr});ue.beforeEach(async(_,n)=>{if(!ie.state.isAuthenticated&&_.name!=="login")return{name:"login"};if(ie.state.isAuthenticated&&_.name==="login")return{name:"sales"}});const Pe=Me(Ve);Pe.use(ie).use(ue).mount("#app");Pe.config.globalProperties.$log=console.log;
