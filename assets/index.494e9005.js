import{d as x,r as le,o as f,c as D,a as e,b as c,w as O,u as i,I as N,B as he,A as Pe,S as Ue,C as ve,P as Se,e as be,f as Ie,g as Fe,h as j,i as C,j as ee,n as $,t as U,k as ne,l as Le,m as B,p as T,F as G,T as Me,q as pe,s as ye,v as z,x as v,y as b,z as me,D as de,E as Z,G as ce,H as q,J as Te,K as H,L as we,M as se,N as ge,O as Ne,Q as _e,R as ke,U as xe,V as We,W as Ve,X as Ge,Y as je,Z as $e,_ as ue,$ as He,a0 as Be,a1 as Ke}from"./vendor.85d58f66.js";const Xe=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerpolicy&&(t.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?t.credentials="include":o.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(o){if(o.ep)return;o.ep=!0;const t=s(o);fetch(o.href,t)}};Xe();var Je="/assets/logo.03d6d6da.png";const qe={class:"menu menu-container p-1 has-background-black-ter has-text-white-ter",style:{"font-weight":"bold"}},ze=e("div",{style:{width:"100%",display:"flex",padding:".5rem"}},[e("img",{src:Je,alt:"",style:{width:"2rem"}}),e("h2",{style:{color:"#fff","font-size":"1.5rem"}},"Vilcherrez")],-1),Ze=e("p",{class:"menu-label"},"Productos",-1),Ye={class:"menu-list"},Qe=e("span",null,"Lista de Productos",-1),es=e("span",null,"Agregar Producto",-1),ss=e("p",{class:"menu-label"},"VENTAS",-1),os={class:"menu-list"},ns=e("span",null,"Lista de Ventas",-1),as=e("span",null,"Nueva Venta",-1),rs=e("p",{class:"menu-label"},"Usuarios",-1),ts={class:"menu-list"},is=e("span",null,"Nuevo Usuario",-1),ls=e("span",null,"Usuarios",-1),ps=e("hr",null,null,-1),ms={class:"menu-list"},ds=e("span",null,"Configuraciones",-1),cs=e("span",null,"Codigos de barra",-1),_s=x({setup(d){return(n,s)=>{const a=le("router-link");return f(),D("aside",qe,[ze,Ze,e("ul",Ye,[e("li",null,[c(a,{to:"/products"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(he))]),_:1}),Qe]),_:1})]),e("li",null,[c(a,{to:"/newProduct"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Pe))]),_:1}),es]),_:1})])]),ss,e("ul",os,[e("li",null,[c(a,{to:"/sales"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Ue))]),_:1}),ns]),_:1})]),e("li",null,[c(a,{to:"/newSale"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(ve))]),_:1}),as]),_:1})])]),rs,e("ul",ts,[e("li",null,[c(a,{to:"/signup"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Se))]),_:1}),is]),_:1})]),e("li",null,[c(a,{to:"/Users"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(be))]),_:1}),ls]),_:1})])]),ps,e("ul",ms,[e("li",null,[c(a,{to:"/printers"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Ie))]),_:1}),ds]),_:1})]),e("li",null,[c(a,{to:"/barcodes"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Fe))]),_:1}),cs]),_:1})])])])}}}),us={class:"navbar box-shadow-y has-background-black-ter has-text-white-ter",style:{width:"100%"}},Cs={class:"navbar-brand"},Ps=e("span",{"aria-hidden":"true"},null,-1),Ss=e("span",{"aria-hidden":"true"},null,-1),gs=e("span",{"aria-hidden":"true"},null,-1),fs=[Ps,Ss,gs],Es=e("a",{href:"#",class:"navbar-item has-text-weight-bold has-text-black"},[e("h2",{style:{color:"#bbb","font-size":"1.4rem","font-weight":"900"}},"VILCHERREZ SYSTEM")],-1),Rs=e("span",{"aria-hidden":"true"},null,-1),Os=e("span",{"aria-hidden":"true"},null,-1),As=e("span",{"aria-hidden":"true"},null,-1),Ds=[Rs,Os,As],hs={class:"navbar-end"},Us={class:"navbar-item has-dropdown is-hoverable has-background-black-ter"},vs={href:"#",class:"navbar-link has-text-white-ter has-background-black-ter"},bs={class:"navbar-dropdown is-right is-boxed has-background-black-ter"},Is=ne("Perfil"),Fs=e("hr",{class:"navbar-divider has-background-grey"},null,-1),Ls=x({emits:["showDrawer"],setup(d,{emit:n}){const s=j(),a=C(!1),o=ee(()=>s.state.user),t=()=>{window.location.reload()};return(r,p)=>{const l=le("router-link");return f(),D("nav",us,[e("div",Cs,[e("a",{role:"button",class:"navbar-burger toggler","aria-label":"menu","aria-expanded":"true",onClick:p[0]||(p[0]=_=>n("showDrawer"))},fs),Es,e("a",{role:"button",class:$(["navbar-burger nav-toggler",{"is-active":a.value}]),onClick:p[1]||(p[1]=_=>a.value=!a.value)},Ds,2)]),e("div",{class:$(["navbar-menu has-text-white-ter",{"is-active":a.value}])},[e("div",hs,[e("div",Us,[e("a",vs,U(i(o).fullName),1),e("div",bs,[c(l,{to:"/profile",class:"navbar-item has-text-white-ter"},{default:O(()=>[Is]),_:1}),Fs,e("a",{href:"#",class:"navbar-item has-text-white-ter",onClick:t},"Salir")])])])],2)])}}});const Ms={style:{padding:"0.5rem"}},ys=x({setup(d){const n=j(),s=Le(),a=C(!1),o=ee(()=>n.state.isAuthenticated);return(t,r)=>{const p=le("router-view");return f(),D(G,null,[i(o)?(f(),B(Ls,{key:0,onShowDrawer:r[0]||(r[0]=l=>a.value=!a.value)})):T("",!0),i(o)?(f(),B(_s,{key:1,class:$({active:a.value})},null,8,["class"])):T("",!0),e("main",null,[e("div",Ms,[c(p,null,{default:O(({Component:l})=>[c(Me,{name:"route",mode:"out-in"},{default:O(()=>[(f(),D("div",{key:i(s).name},[(f(),B(pe(l)))]))]),_:2},1024)]),_:1})])])],64)}}});var Ce=ye({state:{products:[],user:{},isAuthenticated:!1},mutations:{test(){console.log("hola desde vuex")}},actions:{async fetchProducts({state:d}){try{const s=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/products")).json();return s.success&&(d.products=s.data.reverse()),s}catch(n){return console.log(n.type),{success:!0,message:n}}},async fetchSales({state:d}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sales",{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchUsers({state:d}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/users",{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchBoletas({state:d}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/boletas",{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchFacturas({state:d}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/facturas",{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchSaleDetail({state:d},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/saleDetail/${n}`,{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchBoletaDetail({state:d},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/boletaDetail/${n}`,{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchFacturaDetail({state:d},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/facturaDetail/${n}`,{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchPackProducts({state:d},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/pack_product/${n}`,{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(s){return{data:null,success:!0,message:s}}},async fetchRoles(){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/user_roles")).json()}catch(d){return{success:!0,message:d}}},async userLogin({state:d},{credentials:n}){try{const a=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/login",{method:"POST",body:JSON.stringify(n)})).json();return console.log(a),a.success&&(d.user=a.data,d.isAuthenticated=a.success,localStorage.token=a.data.token),a}catch(s){return console.log(s),{success:!1,message:s}}},async userSignup({state:d},{user:n}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/signup",{method:"POST",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify(n)})).json()}catch(s){return console.log(s),{success:!1,message:s}}},async changePassword({state:d},{currentPassword:n,newPassword:s}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/changePassword",{method:"POST",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify({currentPassword:n,newPassword:s})})).json()}catch(a){return console.log(a),{success:!1,message:a}}},async saveProduct({state:d},{action:n,product:s}){try{const o=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:n==="add"?"POST":"PUT",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify(s)})).json();if(o.success&&(n==="add"&&d.products.unshift(o.data),n==="edit")){const t=d.products.findIndex(r=>r.id===s.id);console.log(t),d.products[t]=o.data}return o}catch{}},async savePackingProduct({state:d},{action:n,data:s}){console.log({action:n});try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:n==="add"?"POST":"PUT",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify(s)})).json()}catch{}},async printerTicket(d,{text:n}){return await(await fetch(`http://localhost:5050/printer/${localStorage.printer}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,qr_content:"hola mundo"})})).text()},async testEncode(d,{text:n}){return await(await fetch("http://localhost:5050/decodeurl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,qr_content:"hola mundo"})})).text()},async getInfoDoc({state:d},{typeDoc:n,document:s}){let a;return console.log(n),n===1&&(a=await fetch(`https://inversionesvilver.com/shop-back/api/v1/dni/${s}`,{headers:{Authorization:`bearer ${d.user.token} `}})),n===6&&(a=await fetch(`https://inversionesvilver.com/shop-back/api/v1/ruc/${s}`,{headers:{Authorization:`bearer ${d.user.token} `}})),(await a.json()).data},async saveSale({state:d},{soldProducts:n,client:s,typeProof:a}){return(await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sale",{method:"POST",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify({soldProducts:n,client:s,userId:d.user.id,typeProof:a})})).json()).data},async sendSummaries({state:d}){return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sendResumenes",{method:"POST",headers:{Authorization:`bearer ${d.user.token} `}})).json()},async testEmail({state:d}){return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/testEmail",{headers:{Authorization:`bearer ${d.user.token} `}})).json()},async darBaja({state:d},{proofId:n,typeProof:s,motivoBaja:a}){let o="",t="";return s==="boleta"&&(o="bajaBoleta",t=JSON.stringify({idBoleta:n})),s==="factura"&&(o="bajaFactura",t=JSON.stringify({idFactura:n,motivoBaja:a})),await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/${o}`,{method:"POST",headers:{Authorization:`bearer ${d.user.token} `},body:t})).json()}},modules:{}});const Ts={class:"columns"},ws={class:"column is-11"},Ns={class:"control has-icons-left"},ks={class:"column is-1"},xs={class:"h-100 oy-scroll"},Ws={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Vs=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th")])],-1),Gs={style:{"padding-top":"2px"}},js=["innerHTML"],$s=["onClick","innerHTML"],Hs=["onClick"],Bs=x({emits:["editProduct"],setup(d,{emit:n}){const s=j(),a=C([]),o=C([]),t=C("");z(async()=>{a.value=s.state.products,o.value=s.state.products});const r=(u,S)=>{if(u.length!==0)return u.forEach(P=>{S=S.toString().toLocaleUpperCase().replace(P.toLocaleUpperCase(),`<span style="background:#6eeeeebb">${P.toLocaleUpperCase()}</span>`)}),S},p=()=>{const u=t.value;setTimeout(()=>{if(u===t.value){const P=t.value.toLowerCase().split(" "),h=[];let g=0;a.value.forEach(I=>{g=0,P.forEach(K=>{(I.name.toLowerCase().includes(K)||I.code.toString().toLowerCase().includes(K))&&(g+=1)}),g!==0&&(I.matchs=g,h.push(I))}),console.log(h),o.value=h.sort((I,K)=>K.matchs-I.matchs)}},500)},l=u=>{console.log("hola")},_=u=>{navigator.clipboard.writeText(u.name)},E=async()=>{await s.dispatch("fetchProducts"),a.value=s.state.products,o.value=s.state.products};return(u,S)=>(f(),D(G,null,[e("div",Ts,[e("div",ws,[e("div",Ns,[v(e("input",{class:"input",type:"search",onInput:S[0]||(S[0]=P=>p()),"onUpdate:modelValue":S[1]||(S[1]=P=>t.value=P),placeholder:"Buscar producto"},null,544),[[b,t.value,void 0,{trim:!0}]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(me))]),_:1})])]),e("div",ks,[e("button",{class:"button is-primary",onClick:S[2]||(S[2]=P=>E())},[c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(de))]),_:1})])])]),e("div",xs,[e("table",Ws,[Vs,e("tbody",Gs,[(f(!0),D(G,null,Z(o.value,P=>(f(),D("tr",{key:P.id},[e("td",{innerHTML:r(t.value.split(" "),P.code)},null,8,js),e("td",{style:{cursor:"copy"},onClick:h=>_(P),innerHTML:r(t.value.split(" "),P.name)},null,8,$s),e("td",null,"S/."+U(P.priceSale),1),e("td",null,U(P.stock),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:h=>(l(),n("editProduct",P.productId))},[c(i(N),null,{default:O(()=>[c(i(ce))]),_:1})],8,Hs)])]))),128))])])])],64))}}),Ks={class:"control"},Xs={key:0,class:"help is-danger"},Js=["disabled","value"],qs={class:"control"},zs={class:"control"},Zs={class:"control"},Ys={class:"control"},Qs={class:"control"},eo={class:"control"},so=x({props:{product:Object},emits:["quit","haveErrors"],setup(d,{emit:n}){const s=d,a=j(),o=q(s.product),t=C(!1),r=C(!1),p=C(),l=C("");z(()=>{o.priceBuy!==0&&o.priceSale!==0&&(o.profitPercent=Math.round((o.priceSale-o.priceBuy)/o.priceBuy*100))});const _=()=>{if(o.packing=o.packing.toLocaleUpperCase(),o.priceBuy===0||o.profitPercent===0)return;const h=o.profitPercent/100;if(h!==0){const g=o.priceBuy+o.priceBuy*h;o.priceSale=Math.round((g+Number.EPSILON)*10)/10}},E=Te("packedProducts");H(()=>{o.code.toString()!==""&&(r.value=E.value.some(h=>o.code.toString()===h.code.toString()&&o.id.toString()!==h.id.toString()),r.value&&(l.value="los codigos no pueden ser iguales"))});const u=()=>{const h=o.code;setTimeout(()=>{o.code===h&&p.value.blur()},100)};H(()=>{n("haveErrors",r.value)});const S=()=>(o.productId!==void 0?(r.value=a.state.products.some(({code:h,productId:g})=>h.toString()===o.code&&g!==o.productId),l.value="Ya existe un producto con este codigo"):r.value=a.state.products.some(({code:h})=>h.toString()===o.code),t.value=!1,r.value),P=()=>{o.code="",r.value=!1,p.value.focus()};return(h,g)=>(f(),D("tr",null,[e("td",Ks,[v(e("input",{autocomplete:"off",onInput:g[0]||(g[0]=I=>u()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:g[1]||(g[1]=I=>I.target.blur()),onBlur:g[2]||(g[2]=I=>S()),onFocus:g[3]||(g[3]=I=>t.value=!0),ref_key:"codeField",ref:p,"onUpdate:modelValue":g[4]||(g[4]=I=>i(o).code=I)},null,544),[[b,i(o).code]]),r.value?(f(),D("span",Xs,U(l.value),1)):T("",!0),ne(" "+U(i(o).code)+" ",1),e("input",{type:"button",onClick:g[5]||(g[5]=I=>P()),disabled:t.value,value:t.value?"Esperando escaneo...":"Escanear codigo",class:"button is-info"},null,8,Js)]),e("td",qs,[v(e("input",{class:"input is-upper",placeholder:"10UND","onUpdate:modelValue":g[6]||(g[6]=I=>i(o).packing=I)},null,512),[[b,i(o).packing,void 0,{trim:!0}]])]),e("td",zs,[v(e("input",{class:$(["input is-upper",{"is-danger":i(o).profitPercent!==void 0&&i(o).profitPercent<.1}]),onInput:g[7]||(g[7]=I=>_()),type:"number",step:"0.1",placeholder:"porcentaje","onUpdate:modelValue":g[8]||(g[8]=I=>i(o).profitPercent=I)},null,34),[[b,i(o).profitPercent,void 0,{number:!0}]])]),e("td",Zs,[v(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"precio de compra","onUpdate:modelValue":g[9]||(g[9]=I=>i(o).priceBuy=I),onInput:g[10]||(g[10]=I=>_())},null,544),[[b,i(o).priceBuy,void 0,{number:!0}]])]),e("td",Ys,[v(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"Precio de Venta","onUpdate:modelValue":g[11]||(g[11]=I=>i(o).priceSale=I)},null,512),[[b,i(o).priceSale]])]),e("td",Qs,[v(e("input",{class:"input is-upper",type:"number",placeholder:"Cantidad","onUpdate:modelValue":g[12]||(g[12]=I=>i(o).stock=I)},null,512),[[b,i(o).stock]])]),e("td",eo,[e("button",{type:"button",class:"button is-danger",onClick:g[13]||(g[13]=I=>n("quit",s.product.id))},[c(i(N),{size:"25"},{default:O(()=>[c(i(we))]),_:1})])])]))}});const oo={class:"card"},no={key:0,class:"card-header"},ao={class:"card-header-title"},ro={class:"card-content"},Q={props:{title:{type:String,default:null},icon:{type:String,default:null},headerIcon:{type:String,default:null}},emits:["header-icon-click"],setup(d,{emit:n}){const s=d;return(a,o)=>(f(),D("div",oo,[d.title?(f(),D("header",no,[e("p",ao,[c(i(N),{size:"25"},{default:O(()=>[s.icon?(f(),B(pe(s.icon),{key:0})):T("",!0)]),_:1}),ne(" "+U(s.title),1)]),d.headerIcon?(f(),D("a",{key:0,href:"#",class:"card-header-icon","aria-label":"more options",onClick:o[0]||(o[0]=se(t=>n("headerIconClick"),["prevent"]))},[c(i(N),{size:"25"},{default:O(()=>[s.headerIcon?(f(),B(pe(s.headerIcon),{key:0})):T("",!0)]),_:1})])):T("",!0)])):T("",!0),e("div",ro,[ge(a.$slots,"default")])]))}},to={class:"field is-horizontal"},io={class:"field-label is-normal"},lo={class:"label"},po={class:"field-body"},mo={class:"field"},W={props:{label:String},setup(d){const n=d;return(s,a)=>(f(),D("div",to,[e("div",io,[e("label",lo,U(n.label),1)]),e("div",po,[e("div",mo,[ge(s.$slots,"default")])])]))}},ae=(d,n,s,a,o)=>{const t=("t"+Date.now()+Math.random()).replace(".",""),r=("b"+Date.now()+Math.random()).replace(".",""),p=` <button class="${r} delete"></button>${d}`,l=document.createElement("div");l.classList.add(t,"notification","is-"+n,"toast","m-1"),l.innerHTML=p,s.appendChild(l),a.appendChild(s);const _=document.querySelector("."+r);_.onclick=()=>{s.removeChild(l)},o!==-1&&setTimeout(()=>{l.style.opacity=0,setTimeout(()=>{s.contains(l)&&s.removeChild(l)},1100)},o-500)},co=()=>{const d=document.querySelector("#app");let n=document.querySelector(".toastContainer");return n||(n=document.createElement("div"),n.classList.add("toastContainer")),{danger:(s,a=-1)=>{ae(s,"danger",n,d,a)},warning:(s,a=-1)=>{ae(s,"warning",n,d,a)},success:(s,a=-1)=>{ae(s,"success",n,d,a)},info:(s,a=-1)=>{ae(s,"info",n,d,a)}}},V=co(),_o={key:0,class:"modal is-active"},uo=e("div",{class:"modal-background"},null,-1),Co={class:"modal-card"},Po={class:"modal-card-head"},So=e("p",{class:"modal-card-title"},"Advertencia",-1),go=e("section",{class:"modal-card-body"},"Algunos codigos estan vacios, \xBFquiere guardar de todas formas?",-1),fo={class:"modal-card-foot"},Eo={class:"control"},Ro={key:0,class:"help is-danger"},Oo=e("hr",null,null,-1),Ao={class:"table is-bordered is-fullwidth"},Do=e("th",null,"CODIGO",-1),ho=e("th",null,"PACKING",-1),Uo=e("th",null,"PORCENTAJE DE GANANCIA",-1),vo=e("th",null,"PRECIO DE COMPRA",-1),bo=e("th",null,"PRECIO DE VENTA",-1),Io=e("th",null,"CANTIDAD",-1),Fo=["disabled"],fe=x({props:{productId:{type:Number,default:-1}},emits:["cancelEdit"],setup(d,{emit:n}){const s=d,a=j(),o=C(!1),t=C(),r=C(!1),p=[{pack:"12 UND",profitPercent:25},{pack:"25 UND",profitPercent:25},{pack:"50 UND",profitPercent:25},{pack:"100 UND",profitPercent:25}],l=C(!1),_=q({id:0,name:"",brand:"",tags:"",description:"",features:{},image:""}),E=C([]),u=C([]),S=()=>{u.value=[{id:"V"+Date.now(),code:"",packing:"UND",profitPercent:50,measureUnit:"NIU",priceSale:0,priceBuy:0,stock:0}],p.forEach((w,L)=>{u.value.push({id:"V"+Date.now()+L+1,code:"",packing:w.pack,profitPercent:w.profitPercent,measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})}),_.name="",_.brand="",_.tags="",_.features={},_.description="",_.image="",n("cancelEdit")};Ne("packedProducts",u),H(async()=>{if(console.log(s.productId),s.productId!==-1){console.log("wwwwjdkdk");const w=await a.dispatch("fetchPackProducts",{id:s.productId});u.value=w.data.packedProducts,_.name=w.data.product.name,_.id=w.data.product.id}else console.log("resetetet"),S()}),z(()=>{});const P=()=>{u.value.push({id:"V"+Date.now(),code:"",packing:"",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})},h=w=>{if(u.value.length===1)return;const L=u.value.findIndex(k=>k.id===w);u.value.splice(L,1)},g=()=>(s.productId!==-1?o.value=a.state.products.some(({name:w,productId:L})=>w.toLowerCase()===_.name.toLowerCase()&&L!==_.id):o.value=a.state.products.some(({name:w})=>w.toLowerCase()===_.name.toLowerCase()),o.value),I=async()=>{if(o.value)return;l.value=!1;const w={action:s.productId!==-1?"edit":"add",data:{product:_,packedProducts:[...u.value]}};(await a.dispatch("savePackingProduct",w)).success&&(S(),V.success("Producto guardado exitosamente",2e3))},K=async()=>{const w={action:s.productId!==-1?"edit":"add",data:{product:_,packedProducts:[...u.value]}};if(g())return;if(u.value.some(k=>k.code==="")){l.value=!0;return}(await a.dispatch("savePackingProduct",w)).success&&(S(),V.success("Producto guardado exitosamente",2e3))};return(w,L)=>(f(),D(G,null,[l.value?(f(),D("div",_o,[uo,e("div",Co,[e("header",Po,[So,e("button",{class:"delete","aria-label":"close",onClick:L[0]||(L[0]=k=>l.value=!1)})]),go,e("footer",fo,[e("button",{onClick:L[1]||(L[1]=k=>I()),class:"button is-success"},"Guardar"),e("button",{onClick:L[2]||(L[2]=k=>l.value=!1),class:"button"},"Cancelar")])])])):T("",!0),c(Q,{title:"Agregar producto",icon:i(Pe)},{default:O(()=>[e("form",{onSubmit:L[9]||(L[9]=se(k=>K(),["prevent"])),ref_key:"form",ref:t},[c(W,{label:"Nombre"},{default:O(()=>[e("p",Eo,[v(e("input",{class:$(["input upper",{"is-danger":o.value}]),onInput:L[3]||(L[3]=k=>g()),required:"","onUpdate:modelValue":L[4]||(L[4]=k=>i(_).name=k)},null,34),[[b,i(_).name,void 0,{trim:!0}]]),o.value?(f(),D("span",Ro,"Ya existe un producto con este nombre")):T("",!0)])]),_:1}),Oo,e("table",Ao,[e("thead",null,[e("tr",null,[Do,ho,Uo,vo,bo,Io,e("th",null,[e("button",{type:"button",class:"button is-info",onClick:L[5]||(L[5]=k=>P())},"+")])])]),e("tbody",null,[(f(!0),D(G,null,Z(u.value,(k,Y)=>(f(),B(so,{key:k.id,product:k,onHaveErrors:L[6]||(L[6]=J=>r.value=J),onQuit:L[7]||(L[7]=J=>h(J)),ref_for:!0,ref:J=>{J&&(E.value[Y]=J)}},null,8,["product"]))),128))])]),e("button",{class:"button is-primary",disabled:r.value},"Guardar producto",8,Fo),s.productId!==-1?(f(),D("button",{key:0,type:"button",onClick:L[8]||(L[8]=k=>n("cancelEdit")),class:"button is-danger"},"Cancelar")):T("",!0)],544)]),_:1},8,["icon"])],64))}}),Lo={key:0,class:"modal is-active"},Mo=e("div",{class:"modal-background"},null,-1),yo={class:"modal-card",style:{width:"75%",height:"80%"}},To=x({setup(d){const n=C(-1),s=C(!1),a=t=>{console.log(t),s.value=!0,n.value=t,console.log(n.value)},o=()=>{s.value=!1,n.value=-1};return(t,r)=>(f(),D(G,null,[s.value?(f(),D("div",Lo,[Mo,e("div",yo,[c(fe,{"product-id":n.value,onCancelEdit:r[0]||(r[0]=p=>o())},null,8,["product-id"])])])):T("",!0),e("div",null,[c(Bs,{onEditProduct:r[1]||(r[1]=p=>a(p))})])],64))}}),wo={key:0,class:"modal is-active",style:{"z-index":"9999"}},No=e("div",{class:"modal-background"},null,-1),ko={class:"modal-content",style:{width:"35%",height:"30%"}},xo={class:"message is-danger"},Wo={class:"message-header"},Vo=e("p",null,"Danger",-1),Go={class:"message-body"},jo=e("span",null,"Una vez que se dea de baja ya no se podra recuperar",-1),$o=e("br",null,null,-1),Ho=e("br",null,null,-1),Bo={key:0,class:"field"},Ko=e("label",{class:"label"},"Motivo de Baja",-1),Xo={class:"control"},Jo=["disabled"],qo={key:1,class:"modal is-active"},zo=e("div",{class:"modal-background"},null,-1),Zo={class:"modal-card",style:{width:"50%",height:"70%"}},Yo={class:"modal-card-head"},Qo=e("p",{class:"modal-card-title"},"Detalles de la venta",-1),en={class:"modal-card-body"},sn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},on=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Comprobante")])],-1),nn={key:0,style:{"padding-top":"2px"}},an=e("th",null,"Tipo",-1),rn=e("th",null,"Serie-Correlativo",-1),tn=e("th",null,"Fecha y hora de emision",-1),ln={colspan:"2"},pn=["disabled"],mn={key:0,class:"tag is-danger m-2"},dn={key:1,style:{"padding-top":"2px"}},cn=e("tr",null,[e("th",null,"SIN COMPROBANTE")],-1),_n=[cn],un={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Cn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"2",style:{"text-align":"center"}},"Cliente")])],-1),Pn={style:{"padding-top":"2px"}},Sn=e("th",null,"Documento",-1),gn=e("th",null,"Nombre",-1),fn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},En=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Productos Vendidos")]),e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto")])],-1),Rn={style:{"padding-top":"2px"}},On=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),An={class:"modal-card-foot"},Dn=["disabled"],hn=x({props:{show:Boolean,saleId:Number},emits:["save","hide"],setup(d,{emit:n}){const s=d,a=j(),o=C(s.show),t=C(!1),r=C("ticket"),p=C(0),l=C({}),_=C({}),E=C({}),u=C(""),S=C(!1),P=C(!1),h=C(!1),g=C(!0),I=C("ERROR EN LOS CALCULOS"),K=C(s.saleId),w=C([]);H(()=>{o.value=s.show}),H(async()=>{if(s.saleId===0)return;S.value=!1,K.value=s.saleId;const y=await a.dispatch("fetchSaleDetail",{id:K.value});console.log(y),S.value=!0,w.value=y.data.soldProducts,p.value=y.data.sale.total,l.value=y.data.client,_.value=y.data.proof,u.value=y.data.legend,E.value=y.data.sale,g.value=_.value.enable===1&&(_.value.status===1||_.value.status===2||_.value.status===4),r.value=_.value===!1?"ticket":_.value.serie.startsWith("B")?"boleta":"factura"});const L=(y,R,m,A,F=[])=>{let M=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return R==="ticket"?M+=`
              TICKET DE VENTA ELECTRONICO 
      `:M+=`
         ${R.toLocaleUpperCase()} ELECTRONICA ${F.serie}-${k(F.correlative)}
      `,M+=`
Fecha de emision:${R!=="ticket"?F.dateTime:m.dateTime}
ID Venta: 00000${m.id}
  `,R!=="ticket"&&(M+=`
CLIENTE:
Documento: ${A.document}
Nombre: ${A.name}
`),M+=J(w.value),M+=`
                OP.GRAVADAS:        S/ ${Math.round((m.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((m.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${m.total}
------------------------------------------------ 
${y}

************************************************
            !GRACIAS POR SU COMPRA!
`,M},k=y=>{let R="";for(let m=0;m<8-y.toString().length;m++)R+="0";return R+y.toString()},Y=y=>{if(y<=0)return"";let R="";for(let m=0;m<y;m++)R+=" ";return R},J=y=>{let R="",m="",A=`
------------------------------------------------
`;return A+=`PRODUCTO                 CANT P.UNI   MONTO
`,A+=`------------------------------------------------
`,y.forEach(F=>{R=F.name.slice(0,24)+Y(24-F.name.length),R+="  ",R+=""+F.quantity+Y(3-(""+F.quantity).length),R+=" S/",R+=""+F.price+Y(6-(""+F.price).length),R+=" S/",R+=""+F.mount+Y(7-(""+F.mount).length),A+=`${R}
`,F.name.length>24&&(m=F.name.slice(24,48),A+=`${m}
`),F.name.length>48&&(m=F.name.length>72?F.name.slice(48,72)+"...":F.name.slice(48),A+=`${m}
`)}),A+=`------------------------------------------------
`,A},te=async()=>{P.value=!0;let y=L(u.value,r.value,E.value,l.value,_.value);try{y=y.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),console.log(y),await a.dispatch("printerTicket",{text:y}),P.value=!1}catch{P.value=!1,V.danger("No se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",3e3)}},ie=async()=>{h.value=!0;try{await a.dispatch("darBaja",{proofId:_.value.id,typeProof:r.value,motivoBaja:I.value}),h.value=!1,V.success("Comprobante Dado de baja con exito",3e3),g.value=!1,t.value=!1}catch(y){h.value=!1,V.danger(y,3e3),g.value=!0}};return(y,R)=>(f(),D(G,null,[t.value?(f(),D("div",wo,[No,e("div",ko,[e("article",xo,[e("div",Wo,[Vo,e("button",{class:"delete",onClick:R[0]||(R[0]=m=>t.value=!1),"aria-label":"delete"})]),e("div",Go,[e("span",null,"\xBF\xBF Esta seguro de dar de baja esta "+U(r.value)+"?",1),jo,$o,Ho,r.value==="factura"?(f(),D("div",Bo,[Ko,e("p",Xo,[v(e("input",{class:"input is-upper",placeholder:"ejemplo: ruc equibocado","onUpdate:modelValue":R[1]||(R[1]=m=>I.value=m)},null,512),[[b,I.value]])])])):T("",!0),e("button",{disabled:h.value,class:"button is-danger mx-2",onClick:R[2]||(R[2]=m=>ie())},"Dar de baja",8,Jo),e("button",{class:"button",onClick:R[3]||(R[3]=m=>t.value=!1)},"Cancelar")])])])])):T("",!0),o.value&&S.value?(f(),D("div",qo,[zo,e("div",Zo,[e("header",Yo,[Qo,e("button",{class:"delete","aria-label":"close",onClick:R[4]||(R[4]=m=>n("hide"))})]),e("section",en,[e("table",sn,[on,_.value!==!1?(f(),D("tbody",nn,[e("tr",null,[an,e("td",null,U(r.value.toLocaleUpperCase()),1)]),e("tr",null,[rn,e("td",null,U(_.value.serie)+"-"+U(k(_.value.correlative)),1)]),e("tr",null,[tn,e("td",null,U(_.value.dateTime),1)]),e("tr",null,[e("td",ln,[e("button",{type:"button",onClick:R[5]||(R[5]=m=>t.value=!0),disabled:!g.value,class:"button is-danger"},"DAR DE BAJA LA "+U(r.value.toLocaleUpperCase()),9,pn),g.value?T("",!0):(f(),D("span",mn," LA "+U(r.value.toLocaleUpperCase())+" YA HA SIDO DADA DE BAJA",1))])])])):T("",!0),_.value===!1?(f(),D("tbody",dn,_n)):T("",!0)]),e("table",un,[Cn,e("tbody",Pn,[e("tr",null,[Sn,e("td",null,U(l.value.document),1)]),e("tr",null,[gn,e("td",null,U(l.value.name),1)])])]),e("table",fn,[En,e("tbody",Rn,[(f(!0),D(G,null,Z(w.value,m=>(f(),D("tr",{key:m.id},[e("td",null,U(m.code),1),e("td",null,U(m.name),1),e("td",null,"S/ "+U(m.price),1),e("td",null,U(m.quantity),1),e("td",null,"S/ "+U(m.mount),1)]))),128)),e("tr",null,[On,e("th",null,"S/. "+U(p.value),1)])])])]),e("footer",An,[e("button",{disabled:P.value||!g.value&&r.value!=="ticket",onClick:R[6]||(R[6]=m=>te()),class:"button is-success"},"Imprimir copia de "+U(r.value),9,Dn),e("button",{onClick:R[7]||(R[7]=m=>n("hide")),class:"button"},"Cancelar")])])])):T("",!0)],64))}}),Un=["value","name"],re={props:{label:String,value:String,modelValue:Number},emits:["update:modelValue"],setup(d,{emit:n}){const s=d,a=C(!1),o=C();return H(()=>{a.value=s.modelValue===parseInt(s.value)}),(t,r)=>(f(),D("label",{class:$(["button is-link m-2",{"is-outlined":!a.value}])},[ne(U(s.label)+" ",1),e("input",{ref_key:"rb",ref:o,type:"radio",value:s.value,name:s.modelValue,onInput:r[0]||(r[0]=p=>n("update:modelValue",p.target.value)),style:{display:"none"}},null,40,Un)],2))}};const vn={class:"columns"},bn={class:"column is-11"},In={class:"control has-icons-left"},Fn={class:"control"},Ln={class:"column is-1"},Mn={class:"h-100 oy-scroll"},yn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Tn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"ID"),e("th",null,"Cliente"),e("th",null,"Documento Cliente"),e("th",null,"Fecha emision"),e("th",null,"Importe Total"),e("th",null,"Tipo de comprobante"),e("th")])],-1),wn={style:{"padding-top":"2px"}},Nn={class:"tag is-primary"},kn={key:0,class:"tag is-danger"},xn=["onClick"],Ee=x({setup(d){const n=j(),s=C([]),a=C([]),o=C(""),t=C(!1),r=C(0),p=C(0);z(async()=>{const u=await n.dispatch("fetchSales");if(!u.success){V.danger(u.message);return}s.value=u.data.reverse(),a.value=s.value}),H(()=>{if(console.log(p.value),o.value="",parseInt(p.value)===0){a.value=s.value;return}a.value=s.value.filter(u=>u.proofType===parseInt(p.value))});const l=u=>u===99?"SIN COMPROBANTE":u===3?"BOLETA":"FACTURA",_=()=>{const u=o.value.toLowerCase();a.value=s.value.filter(S=>(S.clientName.toLowerCase().includes(u)||S.clientDocument.toString().toLowerCase().includes(u))&&(S.proofType===parseInt(p.value)||parseInt(p.value)===0))},E=async()=>{const u=await n.dispatch("fetchSales");s.value=u.data.reverse(),a.value=s.value};return(u,S)=>(f(),D(G,null,[c(hn,{saleId:r.value,show:t.value,onHide:S[0]||(S[0]=P=>t.value=!1)},null,8,["saleId","show"]),e("div",vn,[e("div",bn,[e("div",In,[v(e("input",{class:"input",type:"search",onInput:S[1]||(S[1]=P=>_()),"onUpdate:modelValue":S[2]||(S[2]=P=>o.value=P),placeholder:"Buscar por nombre o documento"},null,544),[[b,o.value,void 0,{trim:!0}]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(me))]),_:1})]),e("div",Fn,[c(re,{label:"Todos",value:"0",modelValue:p.value,"onUpdate:modelValue":S[3]||(S[3]=P=>p.value=P),modelModifiers:{number:!0}},null,8,["modelValue"]),c(re,{label:"Facturas",value:"1",modelValue:p.value,"onUpdate:modelValue":S[4]||(S[4]=P=>p.value=P),modelModifiers:{number:!0}},null,8,["modelValue"]),c(re,{label:"Boletas",value:"3",modelValue:p.value,"onUpdate:modelValue":S[5]||(S[5]=P=>p.value=P),modelModifiers:{number:!0}},null,8,["modelValue"]),c(re,{label:"Sin Comprobate",value:"99",modelValue:p.value,"onUpdate:modelValue":S[6]||(S[6]=P=>p.value=P),modelModifiers:{number:!0}},null,8,["modelValue"])])]),e("div",Ln,[e("button",{class:"button is-primary",onClick:S[7]||(S[7]=P=>E())},[c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(de))]),_:1})])])]),e("div",Mn,[e("table",yn,[Tn,e("tbody",wn,[(f(!0),D(G,null,Z(a.value,P=>(f(),D("tr",{key:P.id,class:$({"has-background-danger-light":P.enable===0})},[e("td",null,U(P.id),1),e("td",null,U(P.clientName),1),e("td",null,U(P.clientDocument),1),e("td",null,U(P.dateTime),1),e("td",null,"S/. "+U(P.total),1),e("td",null,[e("span",Nn,U(l(P.proofType)),1),P.enable===0?(f(),D("span",kn,"ANULADO")):T("",!0)]),e("td",null,[e("button",{class:"button is-info is-small",onClick:h=>(r.value=P.id,t.value=!0)},[c(i(N),null,{default:O(()=>[c(i(ce))]),_:1})],8,xn)])],2))),128))])])])],64))}}),Wn=x({setup(d){return(n,s)=>(f(),B(Ee))}}),Vn={class:"columns"},Gn={class:"column"},jn=["value"],$n=x({setup(d){const n=C([]),s=C("");z(async()=>{const t=await(await fetch("http://localhost:5050/devices")).json();n.value=t,s.value=localStorage.printer});const a=()=>{localStorage.printer=s.value};return(o,t)=>(f(),D("div",Vn,[e("div",Gn,[v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>s.value=r)},[(f(!0),D(G,null,Z(n.value,r=>(f(),D("option",{key:r.vendor_id,value:r.product_id+"/"+r.vendor_id},U(r.vendor_id)+":"+U(r.product_id)+" "+U(r.name),9,jn))),128))],512),[[_e,s.value]]),e("button",{class:"button is-primary",onClick:t[1]||(t[1]=r=>a())},"Guardar")])]))}}),Hn=["onSubmit"],Bn={class:"field"},Kn=e("label",{class:"label"},"Usuario",-1),Xn={class:"control has-icons-left"},Jn={class:"field"},qn=e("label",{class:"label"},"Contrase\xF1a",-1),zn={class:"control has-icons-left"},Zn={class:"field"},Yn={class:"control is-expanded"},Qn=e("button",{class:"button is-primary is-medium input mt-2"},"Iniciar Sesion",-1),ea={key:0,class:"help is-danger"},sa=x({setup(d){const n=j(),s=C(!1),a=ke(),o=q({userName:"",password:""}),t=async()=>{const r=await n.dispatch("userLogin",{credentials:o});s.value=!r.success,s.value&&V.danger(r.message,3e3),r.success&&(await n.dispatch("fetchProducts"),V.success(r.message,3e3),a.replace("products")),console.log(r.message)};return(r,p)=>(f(),D("form",{onSubmit:se(t,["prevent"]),class:"box column is-4 is-offset-4"},[e("div",Bn,[Kn,e("div",Xn,[v(e("input",{class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":p[0]||(p[0]=l=>i(o).userName=l),placeholder:"Nombre de usuario"},null,512),[[b,i(o).userName]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(xe))]),_:1})])]),e("div",Jn,[qn,e("div",zn,[v(e("input",{class:"input is-medium",required:"","onUpdate:modelValue":p[1]||(p[1]=l=>i(o).password=l),type:"password",placeholder:"************"},null,512),[[b,i(o).password]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(We))]),_:1})])]),e("div",Zn,[e("p",Yn,[Qn,s.value?(f(),D("span",ea,"Error al iniciar session")):T("",!0)])])],40,Hn))}}),oa=["onSubmit"],na={class:"control"},aa=["disabled"],ra=e("hr",null,null,-1),ta={class:"control"},ia=["disabled"],la=e("hr",null,null,-1),pa={class:"control"},ma=["disabled"],da={key:0,class:"help is-danger"},ca={class:"control"},_a=["disabled"],ua={key:0,class:"help is-danger"},Ca=e("hr",null,null,-1),Pa={class:"control"},Sa=["disabled"],ga=e("hr",null,null,-1),fa={class:"control"},Ea=["disabled"],Ra=e("hr",null,null,-1),Oa={class:"control"},Aa=["disabled"],Da=x({setup(d){const n=C(),s=j(),a=C(!1),o=C([]),t=C(!1),r=q({userName:"",dni:"",fullName:"",email:"",password:"",roleId:"1",mobile:""}),p=C(""),l=C(!1),_=()=>{r.password!==p.value?l.value=!0:l.value=!1};z(async()=>{t.value=s.state.user.roleId!==2,t.value&&V.danger("No tiene permisos para agregar usuarios",4e3);const u=await s.dispatch("fetchRoles");o.value=u.data});const E=async()=>{if(r.password!==p.value){l.value=!0;return}const u=await s.dispatch("userSignup",{user:r});if(a.value=u.success,!u.success){V.danger(u.message,4e3);return}n.value.reset(),V.success(u.message,4e3),alert(`usuario registrado 
 UserName: `+u.data.userName)};return(u,S)=>(f(),B(Q,{icon:i(Se),title:"Registrar nuevo usuario"},{default:O(()=>[e("form",{onSubmit:se(E,["prevent"]),ref_key:"form",ref:n},[c(W,{label:"DNI"},{default:O(()=>[e("div",na,[v(e("input",{class:"input",disabled:t.value,ref:"fieldName","onUpdate:modelValue":S[0]||(S[0]=P=>i(r).dni=P),type:"number",placeholder:"documento de identidad"},null,8,aa),[[b,i(r).dni]])])]),_:1}),ra,c(W,{label:"Nombres y Apellidos"},{default:O(()=>[e("div",ta,[v(e("input",{class:"input",disabled:t.value,ref:"fieldName",required:"","onUpdate:modelValue":S[1]||(S[1]=P=>i(r).fullName=P),type:"text",placeholder:"Nombres y apellidos"},null,8,ia),[[b,i(r).fullName]])])]),_:1}),la,c(W,{label:"Contrase\xF1a"},{default:O(()=>[e("div",pa,[v(e("input",{class:$(["input",{"is-danger":l.value}]),disabled:t.value,required:"","onUpdate:modelValue":S[2]||(S[2]=P=>i(r).password=P),type:"password",placeholder:"Contrase\xF1a"},null,10,ma),[[b,i(r).password]]),l.value?(f(),D("span",da,"Las contrase\xF1as no coinciden")):T("",!0)])]),_:1}),c(W,{label:"Repetir Contrase\xF1a"},{default:O(()=>[e("div",ca,[v(e("input",{class:$(["input",{"is-danger":l.value}]),disabled:t.value,onBlur:S[3]||(S[3]=P=>_()),required:"","onUpdate:modelValue":S[4]||(S[4]=P=>p.value=P),type:"password",placeholder:"Vuelva a escribir la contrase\xF1a"},null,42,_a),[[b,p.value]]),l.value?(f(),D("span",ua,"Las contrase\xF1as no coinciden")):T("",!0)])]),_:1}),Ca,c(W,{label:"Celular"},{default:O(()=>[e("div",Pa,[v(e("input",{class:"input",disabled:t.value,step:"0.1","onUpdate:modelValue":S[5]||(S[5]=P=>i(r).mobile=P),type:"number",placeholder:"Numero de celular"},null,8,Sa),[[b,i(r).mobile]])])]),_:1}),ga,c(W,{label:"Email"},{default:O(()=>[e("div",fa,[v(e("input",{class:"input",disabled:t.value,ref:"fieldName","onUpdate:modelValue":S[6]||(S[6]=P=>i(r).email=P),type:"text",placeholder:"Correo electronico"},null,8,Ea),[[b,i(r).email]])])]),_:1}),Ra,c(W,null,{default:O(()=>[e("div",Oa,[e("button",{class:"button is-primary",disabled:t.value},"Registrar usuario",8,Aa)])]),_:1})],40,oa)]),_:1},8,["icon"]))}}),ha={class:"panel"},Ua={class:"panel-block"},va={class:"control has-icons-left"},ba=["title","onClick","innerHTML"],Re=x({emits:["itemSelected"],setup(d,{emit:n}){const s=j(),a=C([]),o=C([]),t=C("");z(async()=>{await s.dispatch("fetchProducts"),a.value=s.state.products});const r=l=>{const _=t.value.split(" ");if(_.length!==0)return _.forEach(E=>{l=l.toString().toLocaleUpperCase().replace(E.toLocaleUpperCase(),`<span style="background:#6eeeeebb">${E.toLocaleUpperCase()}</span>`)}),l},p=()=>{if(t.value===""){o.value=[];return}const l=t.value;setTimeout(()=>{if(l===t.value){const E=t.value.toLowerCase().split(" "),u=[];let S=0;a.value.forEach(P=>{S=0,E.forEach(h=>{(P.name.toLowerCase().includes(h)||P.code.toString().toLowerCase().includes(h))&&(S+=1)}),S!==0&&(P.matchs=S,u.push(P))}),console.log(u),o.value=u.sort((P,h)=>h.matchs-P.matchs).slice(0,15)}},500)};return(l,_)=>(f(),D("div",ha,[e("div",Ua,[e("p",va,[v(e("input",{class:"input upper",type:"search",onInput:_[0]||(_[0]=E=>p()),"onUpdate:modelValue":_[1]||(_[1]=E=>t.value=E),placeholder:"Buscar producto"},null,544),[[b,t.value,void 0,{trim:!0}]]),c(i(N),{class:"icon is-left"},{default:O(()=>[c(i(Ve))]),_:1})])]),(f(!0),D(G,null,Z(o.value,E=>(f(),D("a",{title:"S/. "+E.priceSale,class:"panel-block",style:{display:"block"},onClick:u=>n("itemSelected",E),key:E.id,innerHTML:r(E.name)},null,8,ba))),128))]))}}),Ia=["srcdoc"],Fa=x({props:{product:Object,stock:Number,rows:Number},setup(d){const n=d,s=C(),a=C(),o=C(""),t=async(p,l)=>{const _=a.value.src;let E=`
   <html style="width:105mm;padding:0;margin:0" >
  <head>
   </head>
   <body style="width:105mm;padding:0;margin:0">`;for(let u=0;u<Math.ceil(l/3);u++){E+='<div style="display:block;width:110mm;margin:0 auto">',E+='<div style="margin:0 auto;padding:0 3mm 0 3mm;width:100%;display:flex;grid-template-columns: repeat(3, 1fr);font-family:arial;font-weight: bold;justify-content:space-evenly ;height:20mm ;page-break-after: always">';for(let S=0;S<3;S++)E+=`<div style="display: flex;flex-direction: column;align-items: center;font-size: 10px;widt:30mm;max-width:30mm;border:1px solid black;padding:2px;text-align:center;height:19mm">
    <span style="margin: 0;padding: 0;z-index: 1;word-wrap:break-word;word-break: break-all;">${p.name}</span>
    <img style="width:29mm" src="${_}"/>
    <span style="margin: 0;padding: 0;z-index: 1">${p.code}</span>
    </div>`;E+="</div></div>"}E+=`</div> </body>
  </html>`,o.value=E},r=async(p,l)=>{const _=a.value.src;let E=`
   <html style="width:105mm;padding:0;margin:0" >
  <head>
   </head>
   <body style="width:105mm;padding:0;margin:0">`;for(let u=0;u<Math.ceil(l/2);u++){E+='<div style="display:block;width:108mm;margin:0 auto">',E+='<div style="margin:0 auto;padding:0;width:100%;display:flex;grid-template-columns: repeat(2, 1fr);font-family:arial;font-weight: bold;justify-content:space-evenly ;height:25mm ;page-break-after: always">';for(let S=0;S<2;S++)E+=`<div style="display: flex;flex-direction: column;align-items: center;font-size: 10px;max-width:45mm;border:1px solid black;padding:2px;text-align:center;justify-content:center;height:24mm">
    <span style="margin: 0;padding: 0;z-index: 1;word-wrap:break-word;word-break: break-all;">${p.name}</span>
    <img style="width:42mm" src="${_}"/>
    <span style="margin: 0;padding: 0;z-index: 1">${p.code}</span>
    </div>`;E+="</div></div>"}E+=`</div> </body>
  </html>`,o.value=E};return H(async()=>{Ge("#barcode",n.product.code,{displayValue:!1,height:20,width:1,margin:0}),n.rows===2?await r(n.product,n.stock):await t(n.product,n.stock)}),(p,l)=>(f(),B(Q,{title:"Previsualizacion"},{default:O(()=>[e("iframe",{id:"printf",name:"printf",ref_key:"pdf",ref:s,style:{width:"100%",height:"30rem"},srcdoc:o.value},null,8,Ia),e("img",{ref_key:"img",ref:a,id:"barcode",style:{display:"none"}},null,512)]),_:1}))}}),La={class:"responsive-container"},Ma={class:"control"},ya={class:"control"},Ta=e("option",{value:"3"},"3 por fila",-1),wa=e("option",{value:"2"},"2 por fila",-1),Na=[Ta,wa],ka=e("hr",null,null,-1),xa=x({setup(d){const n=C({}),s=C(6),a=C(3),o=()=>{const r=window;r.frames.printf.focus(),r.frames.printf.print()},t=r=>{n.value=r,console.log(r.code)};return(r,p)=>(f(),D("div",La,[c(Q,{title:"Opciones de codigos de barras"},{default:O(()=>[e("form",null,[c(W,{label:"Cantidad total"},{default:O(()=>[e("div",Ma,[v(e("input",{type:"number",class:"input",required:"","onUpdate:modelValue":p[0]||(p[0]=l=>s.value=l),placeholder:"Cantidad"},null,512),[[b,s.value,void 0,{number:!0}]])])]),_:1}),c(W,{label:"Cantidad por fila"},{default:O(()=>[e("div",ya,[v(e("select",{"onUpdate:modelValue":p[1]||(p[1]=l=>a.value=l),class:"input"},Na,512),[[_e,a.value,void 0,{number:!0}]])])]),_:1}),ka,c(W,null,{default:O(()=>[e("button",{type:"button",onClick:p[2]||(p[2]=l=>o()),class:"button is-primary"},"Imprimir Codigos")]),_:1}),c(Re,{onItemSelected:p[3]||(p[3]=l=>t(l))})])]),_:1}),c(Fa,{product:n.value,stock:s.value,rows:a.value},null,8,["product","stock","rows"])]))}}),Wa={class:"columns"},Va={class:"column is-4"},Ga=x({setup(d){const n=j(),s=()=>{const o=n.dispatch("sendSummaries");console.log(o)},a=()=>{n.dispatch("testEmail")};return(o,t)=>(f(),D("div",Wa,[e("form",Va,[e("button",{type:"button",onClick:t[0]||(t[0]=r=>s()),class:"button is-primary is-medium"},"Generar y envia resumenes"),e("button",{type:"button",onClick:t[1]||(t[1]=r=>a()),class:"button is-primary is-medium"},"Testear email")])]))}}),ja=["onSubmit"],$a={class:"control"},Ha=e("hr",null,null,-1),Ba={class:"control"},Ka=e("hr",null,null,-1),Xa={class:"control"},Ja=e("hr",null,null,-1),qa={class:"control"},za=e("hr",null,null,-1),Za={class:"control"},Ya=e("hr",null,null,-1),Qa={setup(d){const n=j(),s=C(!1),a=q(n.state.user);console.log(n);const o=()=>{s.value=!0,setTimeout(()=>{s.value=!1,this.$buefy.snackbar.open({message:"Demo only",queue:!1})},750)};return(t,r)=>(f(),B(Q,{title:"Editar Perfil",icon:i(je)},{default:O(()=>[e("form",{onSubmit:se(o,["prevent"])},[c(W,{label:"Usuario"},{default:O(()=>[e("p",$a,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[0]||(r[0]=p=>i(a).userName=p)},null,512),[[b,i(a).userName]])])]),_:1}),Ha,c(W,{label:"Nombre Completo"},{default:O(()=>[e("p",Ba,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[1]||(r[1]=p=>i(a).fullName=p)},null,512),[[b,i(a).fullName]])])]),_:1}),Ka,c(W,{label:"Email"},{default:O(()=>[e("p",Xa,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[2]||(r[2]=p=>i(a).email=p)},null,512),[[b,i(a).email]])])]),_:1}),Ja,c(W,{label:"Celular"},{default:O(()=>[e("p",qa,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[3]||(r[3]=p=>i(a).movile=p)},null,512),[[b,i(a).movile]])])]),_:1}),za,c(W,{label:"DNI"},{default:O(()=>[e("p",Za,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[4]||(r[4]=p=>i(a).dni=p)},null,512),[[b,i(a).dni]])])]),_:1}),Ya],40,ja)]),_:1},8,["icon"]))}},er=["onSubmit"],sr=e("hr",null,null,-1),or={key:0,class:"help is-danger"},nr={key:0,class:"help is-danger"},ar=e("hr",null,null,-1),rr={class:"control"},tr={setup(d){const n=C(!1),s=j(),a=C(!1),o=C(),t=q({currentPassword:null,newPassword:null,passwordConfirmation:null}),r=()=>{t.newPassword!==t.passwordConfirmation?n.value=!0:n.value=!1},p=async()=>{a.value=!0;const l=await s.dispatch("changePassword",t);if(!l.success){V.danger(l.message,4e3);return}V.success(l.message,4e3),o.value.reset()};return(l,_)=>(f(),B(Q,{title:"Actualizar contrase\xF1a",icon:"lock"},{default:O(()=>[e("form",{class:"form",onSubmit:se(p,["prevent"]),ref_key:"formPass",ref:o},[c(W,{label:"Contrase\xF1a actual",message:"Required. Your current password"},{default:O(()=>[v(e("input",{class:"input","onUpdate:modelValue":_[0]||(_[0]=E=>i(t).currentPassword=E),type:"password",required:""},null,512),[[b,i(t).currentPassword]])]),_:1}),sr,c(W,{label:"Nueva Contrase\xF1a",message:"Required. New password"},{default:O(()=>[v(e("input",{class:$(["input",{"is-danger":n.value}]),onBlur:_[1]||(_[1]=E=>r()),"onUpdate:modelValue":_[2]||(_[2]=E=>i(t).newPassword=E),type:"password",required:""},null,34),[[b,i(t).newPassword]]),n.value?(f(),D("span",or,"Las contrase\xF1as no coinciden")):T("",!0)]),_:1}),c(W,{label:"Confirmar contrase\xF1a",message:"Required. New password one more time"},{default:O(()=>[v(e("input",{class:$(["input",{"is-danger":n.value}]),onBlur:_[3]||(_[3]=E=>r()),"onUpdate:modelValue":_[4]||(_[4]=E=>i(t).passwordConfirmation=E),type:"password",required:""},null,34),[[b,i(t).passwordConfirmation]]),n.value?(f(),D("span",nr,"Las contrase\xF1as no coinciden")):T("",!0)]),_:1}),ar,c(W,null,{default:O(()=>[e("div",rr,[e("button",{class:$(["button is-primary",{isLoading:a.value}])}," Cambiar contrase\xF1a ",2)])]),_:1})],40,er)]),_:1}))}};const ir={class:"profile"},lr={setup(d){return(n,s)=>(f(),D("div",ir,[c(Qa),c(tr)]))}},pr={class:"code-sold-product"},mr={class:"name-sold-product"},dr={class:"price-sold-product"},cr={class:"control quantity-sold-product"},_r={class:"mount-sold-product"},ur={class:"p-1",style:{width:"1rem"}},Cr=x({props:{product:Object},emits:["quit"],setup(d,{emit:n}){const s=d,a=q(s.product);return H(()=>{a.quantity=a.quantity<1?1:a.quantity,a.mount=a.quantity*a.priceSale}),(o,t)=>(f(),D("tr",null,[e("td",pr,U(i(a).code),1),e("td",mr,U(i(a).name),1),e("td",dr,"S/. "+U(i(a).priceSale),1),e("td",cr,[v(e("input",{class:"input is-upper",type:"number",min:"1",onClick:t[0]||(t[0]=r=>r.target.select()),placeholder:"Cantidad","onUpdate:modelValue":t[1]||(t[1]=r=>i(a).quantity=r)},null,512),[[b,i(a).quantity]])]),e("td",_r,"S/. "+U(i(a).mount),1),e("td",ur,[e("button",{type:"button",class:"button is-danger p-2 m-0",onClick:t[2]||(t[2]=r=>n("quit",s.product.id))},[c(i(N),{size:"15"},{default:O(()=>[c(i($e))]),_:1})])])]))}}),Pr={key:0,class:"modal is-active"},Sr=e("div",{class:"modal-background"},null,-1),gr={class:"modal-card"},fr={class:"modal-card-head"},Er=e("p",{class:"modal-card-title"},"Agregar producto manual",-1),Rr={class:"modal-card-body"},Or={class:"field"},Ar=e("label",{class:"label"},"Nombre del producto",-1),Dr={class:"control"},hr={class:"field is-horizontal"},Ur={class:"field-body"},vr={class:"field"},br=e("label",{class:"label"},"Precio",-1),Ir={class:"control"},Fr={class:"field"},Lr=e("label",{class:"label"},"Cantidad",-1),Mr={class:"control"},yr={class:"modal-card-foot"},Tr=x({props:{show:Boolean},emits:["addProduct","hide"],setup(d,{emit:n}){const s=d,a=C(s.show),o=q({id:"MP"+Date.now(),code:"MP"+Date.now(),name:"",priceSale:0,quantity:1}),t=()=>{o.name=o.name.toLocaleUpperCase(),n("addProduct",o),o.id="MP"+Date.now(),o.code="MP"+Date.now(),o.name="",o.priceSale=0,o.quantity=1,n("hide")};return H(()=>{a.value=s.show}),(r,p)=>a.value?(f(),D("div",Pr,[Sr,e("div",gr,[e("header",fr,[Er,e("button",{class:"delete","aria-label":"close",onClick:p[0]||(p[0]=l=>n("hide"))})]),e("section",Rr,[e("div",Or,[Ar,e("p",Dr,[v(e("input",{class:"input is-upper",placeholder:"NOMBRE","onUpdate:modelValue":p[1]||(p[1]=l=>i(o).name=l)},null,512),[[b,i(o).name]])])]),e("div",hr,[e("div",Ur,[e("div",vr,[br,e("p",Ir,[v(e("input",{class:"input is-upper",placeholder:"Precio",min:"0.1",step:"0.01","onUpdate:modelValue":p[2]||(p[2]=l=>i(o).priceSale=l)},null,512),[[b,i(o).priceSale]])])]),e("div",Fr,[Lr,e("p",Mr,[v(e("input",{class:"input is-upper",placeholder:"Precio",min:"0.1",step:"0.01","onUpdate:modelValue":p[3]||(p[3]=l=>i(o).quantity=l)},null,512),[[b,i(o).quantity]])])])])])]),e("footer",yr,[e("button",{onClick:p[4]||(p[4]=l=>t()),class:"button is-success"},"Agregar producto"),e("button",{onClick:p[5]||(p[5]=l=>n("hide")),class:"button"},"Cancelar")])])])):T("",!0)}}),wr={key:0,class:"modal is-active"},Nr=e("div",{class:"modal-background"},null,-1),kr={class:"modal-card"},xr={class:"modal-card-head"},Wr=e("p",{class:"modal-card-title"},"Nueva Venta",-1),Vr={class:"modal-card-body"},Gr={style:{display:"none"}},jr={key:0,class:"column"},$r={class:"field is-horizontal"},Hr={class:"field-body"},Br={class:"field has-addons"},Kr={class:"control"},Xr={class:"select"},Jr=["disabled"],qr=["value"],zr={class:"control"},Zr=["placeholder"],Yr={class:"field"},Qr={class:"control is-expanded"},et=["disabled"],st={key:0,class:"field"},ot={class:"control is-expanded"},nt={class:"modal-card-foot"},at=["disabled"],rt=["disabled"],tt=x({props:{show:Boolean,client:Object,loading:{type:Boolean,default:!1}},emits:["save","hide"],setup(d,{emit:n}){const s=d,a=j(),o=C(s.show),t=C(s.loading),r=C("ticket"),p=[{code:1,name:"DNI",length:8},{code:4,name:"CARNET DE EXTRANGERIA",length:12},{code:6,name:"RUC",length:11},{code:7,name:"PASAPORTE",length:12}],l=q(s.client);H(()=>{o.value=s.show}),H(()=>{t.value=s.loading}),H(()=>{l.documentType=1,l.document="",l.name="",l.email="",r.value==="factura"&&(l.documentType=6,l.document="",l.name="")});const _=ee(()=>p.find(P=>P.code===l.documentType)),E=async()=>{if(_.value.code!==1&&_.value.code!==6)return;if((""+l.document).length!==_.value.length){l.name="";return}const P=await a.dispatch("getInfoDoc",{typeDoc:_.value.code,document:l.document});if(P===null||P.error){V.warning("Este numero de "+_.value.name+" no existe");return}l.name=P.nombre},u=()=>{if(r.value!=="ticket"){if(l.document===""||l.name===""){V.warning("El documento o el nombre no puede ser vacio");return}if(r.value==="factura"&&l.email===""){V.warning("Se nesesita un email para emitir factura");return}}n("save",r.value)},S=()=>{l.document=l.document.replace(/\D/,""),l.document.length>_.value.length&&(l.document=l.document.slice(0,_.value.length))};return(P,h)=>o.value?(f(),D("div",wr,[Nr,e("div",kr,[e("header",xr,[Wr,e("button",{class:"delete","aria-label":"close",onClick:h[0]||(h[0]=g=>n("hide"))})]),e("section",Vr,[e("label",{for:"ticket",class:$(["button",{"is-primary":r.value==="ticket"}])},"Ticket",2),e("label",{for:"boleta",class:$(["button",{"is-primary":r.value==="boleta"}])},"Boleta",2),e("label",{for:"factura",class:$(["button",{"is-primary":r.value==="factura"}])},"Factura",2),e("div",Gr,[v(e("input",{type:"radio","onUpdate:modelValue":h[1]||(h[1]=g=>r.value=g),id:"boleta",value:"boleta"},null,512),[[ue,r.value]]),v(e("input",{type:"radio","onUpdate:modelValue":h[2]||(h[2]=g=>r.value=g),id:"factura",value:"factura"},null,512),[[ue,r.value]]),v(e("input",{type:"radio","onUpdate:modelValue":h[3]||(h[3]=g=>r.value=g),id:"ticket",value:"ticket"},null,512),[[ue,r.value]])]),r.value!=="ticket"?(f(),D("div",jr,[e("div",$r,[e("div",Hr,[e("div",Br,[e("p",Kr,[e("span",Xr,[v(e("select",{"onUpdate:modelValue":h[4]||(h[4]=g=>i(l).documentType=g),disabled:r.value==="factura"},[(f(),D(G,null,Z(p,g=>e("option",{key:g.code,value:g.code},U(g.name),9,qr)),64))],8,Jr),[[_e,i(l).documentType]])])]),e("p",zr,[v(e("input",{class:"input is-upper",placeholder:i(_).name,onInput:h[5]||(h[5]=g=>(S(),E())),"onUpdate:modelValue":h[6]||(h[6]=g=>i(l).document=g)},null,40,Zr),[[b,i(l).document]])])])])]),e("div",Yr,[e("p",Qr,[v(e("input",{class:"input is-upper",placeholder:"nombre",type:"text","onUpdate:modelValue":h[7]||(h[7]=g=>i(l).name=g),disabled:i(l).documentType===6||i(l).documentType===1},null,8,et),[[b,i(l).name]])])]),r.value==="factura"?(f(),D("div",st,[e("p",ot,[v(e("input",{class:"input",placeholder:"Email",type:"text","onUpdate:modelValue":h[8]||(h[8]=g=>i(l).email=g)},null,512),[[b,i(l).email]])])])):T("",!0)])):T("",!0)]),e("footer",nt,[e("button",{disabled:t.value,onClick:h[9]||(h[9]=g=>u()),class:"button is-success"},"Guardar e Imprimir "+U(r.value),9,at),e("button",{disabled:t.value,onClick:h[10]||(h[10]=g=>u()),class:"button is-success"},"Solo guardar "+U(r.value),9,rt),e("button",{onClick:h[11]||(h[11]=g=>n("hide")),class:"button"},"Cancelar")])])])):T("",!0)}});const it={class:"responsive-container"},lt={class:"field"},pt={class:"label"},mt={class:"control"},dt=["disabled"],ct={class:"field"},_t={class:"field"},ut={class:"table is-bordered is-striped is-fullwidth"},Ct=e("thead",null,[e("tr",null,[e("th",{class:"code-sold-product"},"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",{class:"quantity-sold-product"},"Cant"),e("th",{class:"mount-sold-product"},"Monto"),e("th")])],-1),Pt={colspan:"20",style:{"text-align":"center"}},St=e("div",null,null,-1),gt=["disabled"],ft={style:{display:"none"}},Et=["srcdoc"],Rt=x({setup(d){const n=j(),s=C(""),a=C(),o=C(!1),t=C([]),r=C(""),p=C(!1),l=C(!1),_=C(!1),E=q({documentType:1,document:"0",name:"",email:""}),u=ee(()=>`
  <html>
  <head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300&display=swap" rel="stylesheet">
   <style>
  pre{
    font-family: 'Roboto Mono', monospace;
    font-weight: bold;
    padding:1rem;
    width:460px
    
  }
  </style></head>
  <body>
 
  <pre >
      ${P.value}
  </pre>
  </body>
  </html>
  `),S=R=>{if(R<=0)return"";let m="";for(let A=0;A<R;A++)m+=" ";return m},P=ee(()=>`
            INVERSIONES VILVER E.I.R.L
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba   

    BOLETA DE VENTA ELECTRONICA 0000-0000000

Fecha de emision:2006-04-09
ID Venta: 0000546-5s654-sds645-sds65

DNI Cliente:${E.document}
Nombre Cliente:${E.name}
${r.value}
                 Subtotal:           S/${Math.round((w.value*(100/118)+Number.EPSILON)*10)/10}
                 IGV(18%):           S/${Math.round((w.value*(18/118)+Number.EPSILON)*10)/10}
                 Total:              S/${w.value}
------------------------------------------------  `),h=R=>{let m="";for(let A=0;A<8-R.toString().length;A++)m+="0";return m+R.toString()},g=()=>{E.documentType=1,E.document="0",E.name="",E.email="",t.value=[]},I=(R,m,A,F,M=[])=>{let X=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return m==="ticket"?X+=`
              TICKET DE VENTA ELECTRONICO 
      `:X+=`
         ${m.toLocaleUpperCase()} ELECTRONICA ${M.serie}-${h(M.correlative)}
      `,X+=`
Fecha de emision:${m!=="ticket"?M.dateTime:A.dateTime}
ID Venta: 00000${A.id}
  `,m!=="ticket"&&(X+=`
CLIENTE:
Documento: ${F.document}
Nombre: ${F.name}
`),X+=K(t.value),X+=`
                OP.GRAVADAS:        S/ ${Math.round((A.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((A.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${A.total}
------------------------------------------------ 
${R}

************************************************
            !GRACIAS POR SU COMPRA!
`,X},K=R=>{let m="",A="",F=`
------------------------------------------------
`;return F+=`PRODUCTO                 CANT P.UNI   MONTO
`,F+=`------------------------------------------------
`,R.forEach(M=>{m=M.name.slice(0,24)+S(24-M.name.length),m+="  ",m+=""+M.quantity+S(3-(""+M.quantity).length),m+=" S/",m+=""+M.priceSale+S(6-(""+M.priceSale).length),m+=" S/",m+=""+M.mount+S(7-(""+M.mount).length),F+=`${m}
`,M.name.length>24&&(A=M.name.slice(24,48),F+=`${A}
`),M.name.length>48&&(A=M.name.length>72?M.name.slice(48,72)+"...":M.name.slice(48),F+=`${A}
`)}),F+=`------------------------------------------------
`,F},w=ee(()=>t.value.reduce((R,m)=>R+m.mount,0)),L=R=>n.state.products.find(({code:A})=>A.toString()===s.value),k=({id:R,code:m,name:A,priceSale:F,quantity:M})=>{const X={id:R,code:m,name:A,priceSale:F,quantity:M!=null?M:1,mount:F*1};if(t.value.every(oe=>oe.id!==R))t.value.push(X);else{const oe=t.value.findIndex(De=>De.id===R);t.value[oe].quantity+=1,t.value[oe].mount=X.priceSale*t.value[oe].quantity}t.value.length===0&&t.value.push(X),s.value=""},Y=R=>{const m=t.value.findIndex(A=>A.id===R);t.value.splice(m,1)};z(async()=>{try{await n.dispatch("fetchProducts");const m=await(await fetch("http://localhost:5050/devices")).json()}catch{V.danger("No se encuentra el controlador de la impresora por favor inicie el controlador y configure la impresora")}});const J=()=>{const R=s.value;setTimeout(()=>{if(s.value===R){const m=L(s.value);m&&k(m),s.value=""}},100)},te=async R=>{l.value=!0;const m=await n.dispatch("saveSale",{soldProducts:t.value,client:E,typeProof:R});let A="";R!=="ticket"?A=I(m.legend,R,m.sale,m.client,m.proof.data):A=I(m.legend,R,m.sale,m.client,[]),console.log(A);try{A=A.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),await n.dispatch("printerTicket",{text:A}),l.value=!1}catch{l.value=!1,V.warning("La venta se ha registrado exitosamente, pero no se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado")}finally{g(),p.value=!1}},ie=()=>{s.value="",a.value.focus()},y=()=>{if(t.value.some(R=>R.priceSale===0)){V.danger("Los precios no pueden ser cero",3e3);return}p.value=!0};return(R,m)=>(f(),D(G,null,[c(tt,{show:p.value,onHide:m[0]||(m[0]=A=>p.value=!1),client:i(E),onSave:m[1]||(m[1]=A=>te(A)),loading:l.value},null,8,["show","client","loading"]),c(Tr,{show:_.value,onHide:m[2]||(m[2]=A=>_.value=!1),onAddProduct:m[3]||(m[3]=A=>k(A))},null,8,["show"]),e("div",it,[c(Q,{title:"Agrgar producto a la venta",class:"add-sold-product"},{default:O(()=>[v(e("input",{required:"",autocomplete:"off",onInput:m[4]||(m[4]=A=>J()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:m[5]||(m[5]=A=>A.target.blur()),onBlur:m[6]||(m[6]=A=>o.value=!1),onFocus:m[7]||(m[7]=A=>o.value=!0),ref_key:"fieldCode",ref:a,"onUpdate:modelValue":m[8]||(m[8]=A=>s.value=A)},null,544),[[b,s.value]]),e("div",lt,[e("label",pt,"Codigo "+U(": "+s.value),1),e("div",mt,[e("button",{tabindex:"-1",class:"button is-success",disabled:o.value,type:"button",onClick:m[9]||(m[9]=A=>ie())},U(o.value?"Escaneando codigos...":"Escanear codigos"),9,dt)])]),e("div",ct,[e("input",{type:"button",class:"button is-info",onClick:m[10]||(m[10]=A=>_.value=!0),value:"Agregar producto manualmente"})]),e("div",_t,[c(Re,{onItemSelected:m[11]||(m[11]=A=>k(A))})])]),_:1}),c(Q,{title:"Productos a vender",class:"sold-products"},{default:O(()=>[e("table",ut,[Ct,e("tbody",null,[(f(!0),D(G,null,Z(t.value,A=>(f(),B(Cr,{key:A.id,product:A,onQuit:m[12]||(m[12]=F=>Y(F))},null,8,["product"]))),128)),e("tr",null,[e("th",Pt,"TOTAL: S/. "+U(i(w)),1)])])]),St,e("button",{disabled:t.value.length===0,onClick:m[13]||(m[13]=A=>y()),class:"button is-primary"},"Realizar venta",8,gt)]),_:1}),e("div",ft,[e("iframe",{style:{width:"550px",height:"900px",padding:"0"},name:"page-printer",srcdoc:i(u)},null,8,Et)])])],64))}});const Ot={class:"columns"},At={class:"column is-11"},Dt={class:"control has-icons-left"},ht={class:"column is-1"},Ut={class:"h-100 oy-scroll"},vt={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},bt=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"ID"),e("th",null,"Nombres"),e("th",null,"Usuario"),e("th",null,"Email"),e("th",null,"DNI"),e("th",null,"Celular"),e("th")])],-1),It={style:{"padding-top":"2px"}},Ft=["onClick"],Lt=x({setup(d){const n=j(),s=C([]),a=C([]),o=C(""),t=C(!1),r=C(0);z(async()=>{const _=await n.dispatch("fetchUsers");if(!_.success){V.danger(_.message,4e3);return}s.value=_.data.reverse(),a.value=s.value});const p=()=>{const _=o.value.toLowerCase();a.value=s.value.filter(E=>E.fullName.toLowerCase().includes(_)||E.userName.toString().toLowerCase().includes(_))},l=async()=>{const _=await n.dispatch("fetchUsers");s.value=_.data.reverse(),a.value=s.value};return(_,E)=>(f(),D(G,null,[e("div",Ot,[e("div",At,[e("div",Dt,[v(e("input",{class:"input",type:"search",onInput:E[0]||(E[0]=u=>p()),"onUpdate:modelValue":E[1]||(E[1]=u=>o.value=u),placeholder:"Buscar por nombre o documento"},null,544),[[b,o.value,void 0,{trim:!0}]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(me))]),_:1})])]),e("div",ht,[e("button",{class:"button is-primary",onClick:E[2]||(E[2]=u=>l())},[c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(de))]),_:1})])])]),e("div",Ut,[e("table",vt,[bt,e("tbody",It,[(f(!0),D(G,null,Z(a.value,u=>(f(),D("tr",{key:u.id,class:$({"has-background-danger-light":u.enable===0})},[e("td",null,U(u.id),1),e("td",null,U(u.fullName),1),e("td",null,U(u.userName),1),e("td",null,U(u.email),1),e("td",null,U(u.dni),1),e("td",null,U(u.mobile),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:S=>(r.value=u.id,t.value=!0)},[c(i(N),null,{default:O(()=>[c(i(ce))]),_:1})],8,Ft)])],2))),128))])])])],64))}}),Mt=[{path:"/login",name:"login",component:sa},{path:"/profile",name:"profile",component:lr},{path:"/sales",name:"sales",component:Wn},{path:"/listSales",name:"listSales",component:Ee},{path:"/newSale",name:"newSale",component:Rt},{path:"/printers",name:"printers",component:$n},{path:"/products",name:"products",component:To},{path:"/newProduct",name:"newProduct",component:fe},{path:"/signup",name:"signup",component:Da},{path:"/users",name:"users",component:Lt},{path:"/barcodes",name:"barcodes",component:xa},{path:"/proofPayments",name:"proofPayments",component:Ga}],Oe=He({history:Be("vilcherrez"),routes:Mt});Oe.beforeEach(async(d,n)=>{if(!Ce.state.isAuthenticated&&d.name!=="login")return{name:"login"};if(Ce.state.isAuthenticated&&d.name==="login")return{name:"sales"}});const Ae=Ke(ys);Ae.use(Ce).use(Oe).mount("#app");Ae.config.globalProperties.$log=console.log;
