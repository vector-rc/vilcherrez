import{d as k,u as j,c as Y,a as g,b as p,e as R,w,f as se,g as y,h as e,r as ie,o as S,I as x,B as ge,S as Ee,i as fe,j as Re,P as Oe,k as Ae,l as u,m as z,n as b,v as L,p as le,A as pe,F as V,q as X,t as D,E as me,s as q,x as oe,D as de,y as H,z as Q,C as ae,G as re,H as ce,J as De,K as Ue,L as he,M as Ie,N as ve,O as be,Q as Me}from"./vendor.6a6ef53a.js";const Te=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}};Te();const Le={class:"is-fluid columns p-5"},ye={key:0,class:"column is-1"},Fe=e("span",null,"Productos",-1),Ne=e("span",null,"Ventas",-1),we=e("span",null,"Configs",-1),ke=e("span",null,"Barcodes",-1),xe=e("span",null,"Usuarios",-1),We={class:"column is-11"},Ve=k({setup(c){const a=j(),s=Y(()=>a.state.user.userName),t=Y(()=>a.state.isAuthenticated);return(n,o)=>{const i=ie("router-link"),d=ie("router-view");return S(),g("main",Le,[p(t)?(S(),g("div",ye,[R(i,{class:"item_menu",to:"/products"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(ge))]),_:1}),Fe]),_:1}),R(i,{class:"item_menu",to:"/sales"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(Ee))]),_:1}),Ne]),_:1}),R(i,{class:"item_menu",to:"/printers"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(fe))]),_:1}),we]),_:1}),R(i,{class:"item_menu",to:"/barcodes"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(Re))]),_:1}),ke]),_:1}),p(s)==="Balta"?(S(),se(i,{key:0,class:"item_menu",to:"/signup"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(Oe))]),_:1}),xe]),_:1})):y("",!0)])):y("",!0),e("div",We,[R(d)])])}}});var te=Ae({state:{products:[],user:{},isAuthenticated:!1},mutations:{test(){console.log("hola desde vuex")}},actions:{async fetchProducts({state:c}){try{const s=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/products")).json();return s.success&&(c.products=s.data.reverse()),s}catch(a){return console.log(a.type),{success:!0,message:a}}},async fetchSales({state:c}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sales",{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(a){return console.log(a.type),{success:!1,message:a}}},async fetchBoletas({state:c}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/boletas",{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(a){return console.log(a.type),{success:!1,message:a}}},async fetchFacturas({state:c}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/facturas",{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(a){return console.log(a.type),{success:!1,message:a}}},async fetchSaleDetail({state:c},{id:a}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/saleDetail/${a}`,{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchBoletaDetail({state:c},{id:a}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/boletaDetail/${a}`,{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchFacturaDetail({state:c},{id:a}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/facturaDetail/${a}`,{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchPackProducts({state:c},{id:a}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/pack_product/${a}`,{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(s){return{data:null,success:!0,message:s}}},async fetchRoles(){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/user_roles")).json()}catch(c){return{success:!0,message:c}}},async userLogin({state:c},{credentials:a}){try{const t=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/login",{method:"POST",body:JSON.stringify(a)})).json();return console.log(t),t.success&&(c.user=t.data,c.isAuthenticated=t.success,localStorage.token=t.data.token),t}catch(s){return console.log(s),{success:!1,message:s}}},async userSignup({state:c},{user:a}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/signup",{method:"POST",body:JSON.stringify(a)})).json()}catch(s){return console.log(s),{success:!1,message:s}}},async saveProduct({state:c},{action:a,product:s}){try{const n=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:a==="add"?"POST":"PUT",headers:{Authorization:`bearer ${c.user.token} `},body:JSON.stringify(s)})).json();if(n.success&&(a==="add"&&c.products.unshift(n.data),a==="edit")){const o=c.products.findIndex(i=>i.id===s.id);console.log(o),c.products[o]=n.data}return n}catch{}},async savePackingProduct({state:c},{action:a,data:s}){console.log({action:a});try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:a==="add"?"POST":"PUT",headers:{Authorization:`bearer ${c.user.token} `},body:JSON.stringify(s)})).json()}catch{}},async printerTicket(c,{text:a}){return await(await fetch(`http://localhost:5050/printer/${localStorage.printer}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a,qr_content:"hola mundo"})})).text()},async testEncode(c,{text:a}){return await(await fetch("http://localhost:5050/decodeurl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a,qr_content:"hola mundo"})})).text()},async getInfoDoc({state:c},{typeDoc:a,document:s}){let t;return console.log(a),a===1&&(t=await fetch(`https://inversionesvilver.com/shop-back/api/v1/dni/${s}`,{headers:{Authorization:`bearer ${c.user.token} `}})),a===6&&(t=await fetch(`https://inversionesvilver.com/shop-back/api/v1/ruc/${s}`,{headers:{Authorization:`bearer ${c.user.token} `}})),(await t.json()).data},async saveSale({state:c},{soldProducts:a,client:s,typeProof:t}){return(await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sale",{method:"POST",headers:{Authorization:`bearer ${c.user.token} `},body:JSON.stringify({soldProducts:a,client:s,userId:c.user.id,typeProof:t})})).json()).data},async sendSummaries({state:c}){return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sendResumenes",{method:"POST",headers:{Authorization:`bearer ${c.user.token} `}})).json()},async darBaja({state:c},{proofId:a,typeProof:s,motivoBaja:t}){let n="",o="";return s==="boleta"&&(n="bajaBoleta",o=JSON.stringify({idBoleta:a})),s==="factura"&&(n="bajaFactura",o=JSON.stringify({idFactura:a,motivoBaja:t})),await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/${n}`,{method:"POST",headers:{Authorization:`bearer ${c.user.token} `},body:o})).json()}},modules:{}});const Ge={class:"columns"},je={class:"column is-11"},$e={class:"control has-icons-left"},He={class:"column is-1"},Be={class:"h-100 oy-scroll"},Ke={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Je=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th")])],-1),Xe={style:{"padding-top":"2px"}},qe=["onClick"],ze=["onClick"],Ye=k({emits:["editProduct"],setup(c,{emit:a}){const s=j(),t=u([]),n=u([]),o=u("");z(async()=>{t.value=s.state.products,n.value=s.state.products});const i=()=>{const C=o.value.toLowerCase().split(" "),m=[];C.forEach((E,v)=>{if(E.length<2)return;t.value.filter(({name:A,code:U})=>A.toLowerCase().includes(E)||U.toString().toLowerCase().includes(E)).forEach((A,U)=>{if(m.length===0){m.push(A);return}if(m.every(({id:G})=>G!==A.id))m.push(A);else{const G=m.findIndex(({id:K})=>K===A.id);m.splice(G,1),m.unshift(A)}})}),n.value=m},d=l=>{console.log("hola")},f=l=>{navigator.clipboard.writeText(l.name)},O=async()=>{await s.dispatch("fetchProducts"),t.value=s.state.products,n.value=s.state.products};return(l,C)=>(S(),g(V,null,[e("div",Ge,[e("div",je,[e("div",$e,[b(e("input",{class:"input",type:"search",onInput:C[0]||(C[0]=m=>i()),"onUpdate:modelValue":C[1]||(C[1]=m=>o.value=m),placeholder:"Buscar producto"},null,544),[[L,o.value,void 0,{trim:!0}]]),R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(le))]),_:1})])]),e("div",He,[e("button",{class:"button is-primary",onClick:C[2]||(C[2]=m=>O())},[R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(pe))]),_:1})])])]),e("div",Be,[e("table",Ke,[Je,e("tbody",Xe,[(S(!0),g(V,null,X(n.value,m=>(S(),g("tr",{key:m.id},[e("td",null,D(m.code),1),e("td",{style:{cursor:"copy"},onClick:E=>f(m)},D(m.name),9,qe),e("td",null,"S/."+D(m.priceSale),1),e("td",null,D(m.stock),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:E=>(d(),a("editProduct",m.productId))},[R(p(x),null,{default:w(()=>[R(p(me))]),_:1})],8,ze)])]))),128))])])])],64))}}),Qe={class:"control"},Ze={key:0,class:"help is-danger"},es=["disabled","value"],ss={class:"control"},os={class:"control"},ns={class:"control"},as={class:"control"},rs={class:"control"},ts=k({props:{product:Object},emits:["quit"],setup(c,{emit:a}){const s=c,t=j(),n=q(s.product),o=u(!1),i=u(!1),d=u(),f=()=>{if(n.priceBuy===0)return;let m=0;switch(n.packing.toLocaleUpperCase()){case"UND":m=.5;break;case"10 UND":m=.25;break;case"12 UND":m=.25;break;case"DOCENA":m=.25;break;case"25 UND":m=.25;break;case"50 UND":m=.25;break;case"100 UND":m=.25;break}if(m!==0){const E=n.priceBuy+n.priceBuy*m;n.packing==="UND"?n.priceSale=Math.round((E+Number.EPSILON)*10)/10:n.priceSale=Math.ceil(E)}},O=()=>{const m=n.code;setTimeout(()=>{n.code===m&&d.value.blur()},100)},l=()=>(n.productId!==void 0?i.value=t.state.products.some(({code:m,productId:E})=>m.toString()===n.code&&E!==n.productId):i.value=t.state.products.some(({code:m})=>m.toString()===n.code),o.value=!1,i.value),C=()=>{n.code="",i.value=!1,d.value.focus()};return(m,E)=>(S(),g("tr",null,[e("td",Qe,[b(e("input",{autocomplete:"off",onInput:E[0]||(E[0]=v=>O()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:E[1]||(E[1]=v=>v.target.blur()),onBlur:E[2]||(E[2]=v=>l()),onFocus:E[3]||(E[3]=v=>o.value=!0),ref_key:"codeField",ref:d,"onUpdate:modelValue":E[4]||(E[4]=v=>p(n).code=v)},null,544),[[L,p(n).code]]),i.value?(S(),g("span",Ze,"Ya hay un producto con este codigo")):y("",!0),oe(" "+D(p(n).code)+" ",1),e("input",{type:"button",onClick:E[5]||(E[5]=v=>C()),disabled:o.value,value:o.value?"Esperando escaneo...":"Escanear codigo",class:"button is-info"},null,8,es)]),e("td",ss,[b(e("input",{class:"input is-upper",placeholder:"10UND","onUpdate:modelValue":E[6]||(E[6]=v=>p(n).packing=v)},null,512),[[L,p(n).packing]])]),e("td",os,[b(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"precio de compra","onUpdate:modelValue":E[7]||(E[7]=v=>p(n).priceBuy=v),onInput:E[8]||(E[8]=v=>f())},null,544),[[L,p(n).priceBuy]])]),e("td",ns,[b(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"Precio de Venta","onUpdate:modelValue":E[9]||(E[9]=v=>p(n).priceSale=v)},null,512),[[L,p(n).priceSale]])]),e("td",as,[b(e("input",{class:"input is-upper",type:"number",placeholder:"Cantidad","onUpdate:modelValue":E[10]||(E[10]=v=>p(n).stock=v)},null,512),[[L,p(n).stock]])]),e("td",rs,[e("button",{type:"button",class:"button is-danger",onClick:E[11]||(E[11]=v=>a("quit",s.product.id))},[R(p(x),{size:"25"},{default:w(()=>[R(p(de))]),_:1})])])]))}}),is={key:0,class:"modal is-active"},ls=e("div",{class:"modal-background"},null,-1),ps={class:"modal-card"},ms={class:"modal-card-head"},ds=e("p",{class:"modal-card-title"},"Advertencia",-1),cs=e("section",{class:"modal-card-body"},"Algunos codigos estan vacios, \xBFquiere guardar de todas formas?",-1),_s={class:"modal-card-foot"},Cs={class:"field"},us={class:"control"},Ps={key:0,class:"help is-danger"},Ss={class:"table is-bordered"},gs=e("th",null,"CODIGO",-1),Es=e("th",null,"PACKING",-1),fs=e("th",null,"PRECIO DE COMPRA",-1),Rs=e("th",null,"PRECIO DE VENTA",-1),Os=e("th",null,"CANTIDAD",-1),As=e("button",{class:"button is-primary"},"Guardar producto",-1),Ds={key:1,class:"notification is-success"},Us=e("button",{class:"delete"},null,-1),hs=oe(" Producto guardado con exito "),Is=[Us,hs],vs=k({props:{productId:{type:Number,default:-1}},emits:["cancelEdit"],setup(c,{emit:a}){const s=c,t=j(),n=u(),o=u(!1),i=u(),d=u(!1),f=["12 UND","25 UND","50 UND","100 UND"],O=u(!1),l=q({id:0,name:"",brand:"",tags:"",description:"",features:{},image:""}),C=u([]),m=u([]),E=()=>{m.value=[{id:"V"+Date.now(),code:"",packing:"UND",measureUnit:"NIU",priceSale:0,priceBuy:0,stock:0}],f.forEach((N,h)=>{m.value.push({id:"V"+Date.now()+h+1,code:"",packing:N,measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})}),l.name="",l.brand="",l.tags="",l.features={},l.description="",l.image="",a("cancelEdit")};H(async()=>{if(s.productId!==-1){const N=await t.dispatch("fetchPackProducts",{id:s.productId});m.value=N.data.packedProducts,l.name=N.data.product.name,l.id=N.data.product.id}else E()}),z(()=>{E()});const v=()=>{m.value.push({id:"V"+Date.now(),code:"",packing:"",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})},W=N=>{if(m.value.length===1)return;const h=m.value.findIndex(F=>F.id===N);m.value.splice(h,1)},A=()=>(s.productId!==-1?o.value=t.state.products.some(({name:N,productId:h})=>N.toLowerCase()===l.name.toLowerCase()&&h!==l.id):o.value=t.state.products.some(({name:N})=>N.toLowerCase()===l.name.toLowerCase()),o.value),U=async()=>{if(o.value)return;O.value=!1;const N={action:s.productId!==-1?"edit":"add",data:{product:l,packedProducts:[...m.value]}};(await t.dispatch("savePackingProduct",N)).success&&(E(),K())},G=()=>{n.value.select()},K=()=>{d.value=!0,setTimeout(()=>{d.value=!1},2e3)},B=async()=>{const N={action:s.productId!==-1?"edit":"add",data:{product:l,packedProducts:[...m.value]}};if(A())return;if(m.value.some(F=>F.code==="")){O.value=!0;return}(await t.dispatch("savePackingProduct",N)).success&&(E(),K())};return(N,h)=>(S(),g(V,null,[O.value?(S(),g("div",is,[ls,e("div",ps,[e("header",ms,[ds,e("button",{class:"delete","aria-label":"close",onClick:h[0]||(h[0]=F=>O.value=!1)})]),cs,e("footer",_s,[e("button",{onClick:h[1]||(h[1]=F=>U()),class:"button is-success"},"Guradar"),e("button",{onClick:h[2]||(h[2]=F=>O.value=!1),class:"button"},"Cancelar")])])])):y("",!0),e("form",{onSubmit:h[9]||(h[9]=ae(F=>B(),["prevent"])),ref_key:"form",ref:i,class:"box"},[e("div",Cs,[e("label",{class:"label",onClick:h[3]||(h[3]=F=>G())},"Nombre"),e("div",us,[b(e("input",{class:Q(["input upper",{"is-danger":o.value}]),onInput:h[4]||(h[4]=F=>A()),ref_key:"fieldName",ref:n,required:"","onUpdate:modelValue":h[5]||(h[5]=F=>p(l).name=F),type:"text",placeholder:"Nombre"},null,34),[[L,p(l).name,void 0,{trim:!0}]]),o.value?(S(),g("span",Ps,"Ya existe un producto con este nombre")):y("",!0)])]),e("table",Ss,[e("thead",null,[e("tr",null,[gs,Es,fs,Rs,Os,e("th",null,[e("button",{type:"button",class:"button is-info",onClick:h[6]||(h[6]=F=>v())},"+")])])]),e("tbody",null,[(S(!0),g(V,null,X(m.value,(F,Z)=>(S(),se(ts,{key:F.id,product:F,onQuit:h[7]||(h[7]=J=>W(J)),ref_for:!0,ref:J=>{J&&(C.value[Z]=J)}},null,8,["product"]))),128))])]),As,s.productId!==-1?(S(),g("button",{key:0,type:"button",onClick:h[8]||(h[8]=F=>a("cancelEdit")),class:"button is-danger"},"Cancelar")):y("",!0)],544),d.value?(S(),g("div",Ds,Is)):y("",!0)],64))}}),bs={class:"columns"},Ms={class:"column is-6"},Ts={class:"column is-6"},Ls=k({setup(c){const a=u(-1),s=n=>{a.value=n},t=()=>{a.value=-1};return(n,o)=>(S(),g("div",bs,[e("div",Ms,[R(vs,{"product-id":a.value,onCancelEdit:o[0]||(o[0]=i=>t())},null,8,["product-id"])]),e("div",Ts,[R(Ye,{onEditProduct:o[1]||(o[1]=i=>s(i))})])]))}}),ys={class:"menu"},Fs={class:"menu-list"},Ns=["onClick"],_e=k({emits:["itemSelected"],setup(c,{emit:a}){const s=j(),t=u([]),n=u([]),o=u("");z(async()=>{await s.dispatch("fetchProducts"),t.value=s.state.products});const i=()=>{if(o.value===""){n.value=[];return}const d=o.value.toLowerCase();n.value=t.value.filter(({name:f,code:O})=>f.toLowerCase().includes(d)||O.toString().toLowerCase().includes(d))};return(d,f)=>(S(),g("div",ys,[b(e("input",{class:"input upper",type:"search",onInput:f[0]||(f[0]=O=>i()),"onUpdate:modelValue":f[1]||(f[1]=O=>o.value=O),placeholder:"Buscar producto"},null,544),[[L,o.value,void 0,{trim:!0}]]),e("ul",Fs,[(S(!0),g(V,null,X(n.value,O=>(S(),g("li",{onClick:l=>a("itemSelected",O),key:O.id},D(O.name),9,Ns))),128))])]))}}),ws={class:"control",style:{width:"6.5rem"}},ks={class:"control"},xs=k({props:{product:Object},emits:["quit"],setup(c,{emit:a}){const s=c,t=q(s.product);return H(()=>{t.quantity=t.quantity<1?1:t.quantity,t.mount=t.quantity*t.priceSale}),(n,o)=>(S(),g("tr",null,[e("td",null,D(p(t).code),1),e("td",null,D(p(t).name),1),e("td",null,"S/. "+D(p(t).priceSale),1),e("td",ws,[b(e("input",{class:"input is-upper",type:"number",min:"1",onClick:o[0]||(o[0]=i=>i.target.select()),placeholder:"Cantidad","onUpdate:modelValue":o[1]||(o[1]=i=>p(t).quantity=i)},null,512),[[L,p(t).quantity]])]),e("td",null,"S/. "+D(p(t).mount),1),e("td",ks,[e("button",{type:"button",class:"button is-danger",onClick:o[2]||(o[2]=i=>a("quit",s.product.id))},[R(p(x),null,{default:w(()=>[R(p(de))]),_:1})])])]))}}),Ws={key:0,class:"modal is-active"},Vs=e("div",{class:"modal-background"},null,-1),Gs={class:"modal-card"},js={class:"modal-card-head"},$s=e("p",{class:"modal-card-title"},"Agregar producto manual",-1),Hs={class:"modal-card-body"},Bs={class:"field is-horizontal"},Ks=e("div",{class:"field-label is-normal"},[e("label",{class:"label"},"Nombre del producto")],-1),Js={class:"field-body"},Xs={class:"field"},qs={class:"control"},zs={class:"field is-horizontal"},Ys=e("div",{class:"field-label is-normal"},[e("label",{class:"label"},"Precio")],-1),Qs={class:"field-body"},Zs={class:"field"},eo={class:"control",style:{width:"7rem"}},so={class:"modal-card-foot"},oo=k({props:{show:Boolean},emits:["addProduct","hide"],setup(c,{emit:a}){const s=c,t=u(s.show),n=q({id:"MP"+Date.now(),code:"MP"+Date.now(),name:"",priceSale:0,quantity:1}),o=()=>{a("addProduct",n),n.id="MP"+Date.now(),n.code="MP"+Date.now(),n.name="",n.priceSale=0,n.quantity=1,a("hide")};return H(()=>{t.value=s.show}),(i,d)=>t.value?(S(),g("div",Ws,[Vs,e("div",Gs,[e("header",js,[$s,e("button",{class:"delete","aria-label":"close",onClick:d[0]||(d[0]=f=>a("hide"))})]),e("section",Hs,[e("div",Bs,[Ks,e("div",Js,[e("div",Xs,[e("p",qs,[b(e("input",{class:"input is-upper",placeholder:"NOMBRE","onUpdate:modelValue":d[1]||(d[1]=f=>p(n).name=f)},null,512),[[L,p(n).name]])])])])]),e("div",zs,[Ys,e("div",Qs,[e("div",Zs,[e("p",eo,[b(e("input",{class:"input is-upper",placeholder:"Precio",min:"0.1",step:"0.01","onUpdate:modelValue":d[2]||(d[2]=f=>p(n).priceSale=f)},null,512),[[L,p(n).priceSale]])])])])])]),e("footer",so,[e("button",{onClick:d[3]||(d[3]=f=>o()),class:"button is-success"},"Agregar producto"),e("button",{onClick:d[4]||(d[4]=f=>a("hide")),class:"button"},"Cancelar")])])])):y("",!0)}}),no={key:0,class:"modal is-active"},ao=e("div",{class:"modal-background"},null,-1),ro={class:"modal-card"},to={class:"modal-card-head"},io=e("p",{class:"modal-card-title"},"Nueva Venta",-1),lo={class:"modal-card-body"},po={style:{display:"none"}},mo={key:0,class:"column"},co={class:"field is-horizontal"},_o={class:"field-body"},Co={class:"field has-addons"},uo={class:"control"},Po={class:"select"},So=["disabled"],go=["value"],Eo={class:"control"},fo=["placeholder"],Ro={class:"field"},Oo={class:"control is-expanded"},Ao=["disabled"],Do={key:0,class:"field"},Uo={class:"control is-expanded"},ho={key:1,class:"notification is-danger mt-5"},Io={class:"modal-card-foot"},vo=["disabled"],bo=k({props:{show:Boolean,client:Object,loading:{type:Boolean,default:!1}},emits:["save","hide"],setup(c,{emit:a}){const s=c,t=j(),n=u(s.show),o=u(s.loading),i=u("ticket"),d=u(!1),f=u(""),O=[{code:1,name:"DNI",length:8},{code:4,name:"CARNET DE EXTRANGERIA",length:12},{code:6,name:"RUC",length:11},{code:7,name:"PASAPORTE",length:12}],l=q(s.client);H(()=>{n.value=s.show}),H(()=>{o.value=s.loading}),H(()=>{l.documentType=1,l.document="",l.name="",l.email="",i.value==="factura"&&(l.documentType=6,l.document="",l.name="")});const C=Y(()=>O.find(W=>W.code===l.documentType)),m=async()=>{if(!(C.value.code!==1&&C.value.code!==6)&&(""+l.document).length===C.value.length){const W=await t.dispatch("getInfoDoc",{typeDoc:C.value.code,document:l.document});l.name=W.nombre}};H(()=>{d.value&&setTimeout(()=>{d.value=!1},2500)});const E=()=>{if(i.value!=="ticket"){if(l.document===""||l.name===""){f.value="El documento o el nombre no puede ser vacio",d.value=!0;return}if(i.value==="factura"&&l.email===""){f.value="Se nesesita un email para emitir factura",d.value=!0;return}}a("save",i.value)},v=()=>{l.document=l.document.replace(/\D/,""),l.document.length>C.value.length&&(l.document=l.document.slice(0,C.value.length))};return(W,A)=>n.value?(S(),g("div",no,[ao,e("div",ro,[e("header",to,[io,e("button",{class:"delete","aria-label":"close",onClick:A[0]||(A[0]=U=>a("hide"))})]),e("section",lo,[e("label",{for:"ticket",class:Q(["button",{"is-primary":i.value==="ticket"}])},"Ticket",2),e("label",{for:"boleta",class:Q(["button",{"is-primary":i.value==="boleta"}])},"Boleta",2),e("label",{for:"factura",class:Q(["button",{"is-primary":i.value==="factura"}])},"Factura",2),e("div",po,[b(e("input",{type:"radio","onUpdate:modelValue":A[1]||(A[1]=U=>i.value=U),id:"boleta",value:"boleta"},null,512),[[re,i.value]]),b(e("input",{type:"radio","onUpdate:modelValue":A[2]||(A[2]=U=>i.value=U),id:"factura",value:"factura"},null,512),[[re,i.value]]),b(e("input",{type:"radio","onUpdate:modelValue":A[3]||(A[3]=U=>i.value=U),id:"ticket",value:"ticket"},null,512),[[re,i.value]])]),i.value!=="ticket"?(S(),g("div",mo,[e("div",co,[e("div",_o,[e("div",Co,[e("p",uo,[e("span",Po,[b(e("select",{"onUpdate:modelValue":A[4]||(A[4]=U=>p(l).documentType=U),disabled:i.value==="factura"},[(S(),g(V,null,X(O,U=>e("option",{key:U.code,value:U.code},D(U.name),9,go)),64))],8,So),[[ce,p(l).documentType]])])]),e("p",Eo,[b(e("input",{class:"input is-upper",placeholder:p(C).name,onInput:A[5]||(A[5]=U=>(v(),m())),"onUpdate:modelValue":A[6]||(A[6]=U=>p(l).document=U)},null,40,fo),[[L,p(l).document]])])])])]),e("div",Ro,[e("p",Oo,[b(e("input",{class:"input is-upper",placeholder:"nombre",type:"text","onUpdate:modelValue":A[7]||(A[7]=U=>p(l).name=U),disabled:p(l).documentType===6||p(l).documentType===1},null,8,Ao),[[L,p(l).name]])])]),i.value==="factura"?(S(),g("div",Do,[e("p",Uo,[b(e("input",{class:"input",placeholder:"Email",type:"text","onUpdate:modelValue":A[8]||(A[8]=U=>p(l).email=U)},null,512),[[L,p(l).email]])])])):y("",!0)])):y("",!0),d.value?(S(),g("div",ho,[e("button",{onClick:A[9]||(A[9]=U=>d.value=!1),class:"delete"}),oe(" "+D(f.value),1)])):y("",!0)]),e("footer",Io,[e("button",{disabled:o.value,onClick:A[10]||(A[10]=U=>E()),class:"button is-success"},"Imprimir "+D(i.value),9,vo),e("button",{onClick:A[11]||(A[11]=U=>a("hide")),class:"button"},"Cancelar")])])])):y("",!0)}}),Mo={class:"columns"},To={class:"column is-4"},Lo={class:"field"},yo={class:"label"},Fo={class:"control"},No=["disabled"],wo={class:"field"},ko={class:"field"},xo={class:"column is-8"},Wo={class:"table is-bordered is-striped is-fullwidth"},Vo=e("thead",null,[e("tr",null,[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto"),e("th")])],-1),Go=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),jo=e("th",null,null,-1),$o=e("div",null,null,-1),Ho=["disabled"],Bo={key:0,class:"notification is-danger mt-5"},Ko={style:{display:"none"}},Jo=["srcdoc"],Xo=k({setup(c){const a=j(),s=u(""),t=u(),n=u(!1),o=u([]),i=u(""),d=u(!1),f=u(!1),O=u(!1),l=u(!1),C=u(""),m=q({documentType:1,document:"0",name:"",email:""}),E=Y(()=>`
  <html>
  <head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300&display=swap" rel="stylesheet">
   <style>
  pre{
    font-family: 'Roboto Mono', monospace;
    font-weight: bold;
    padding:1rem;
    width:460px
    
  }
  </style></head>
  <body>
 
  <pre >
      ${W.value}
  </pre>
  </body>
  </html>
  `),v=_=>{if(_<=0)return"";let r="";for(let P=0;P<_;P++)r+=" ";return r},W=Y(()=>`
            INVERSIONES VILVER E.I.R.L
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba   

    BOLETA DE VENTA ELECTRONICA 0000-0000000

Fecha de emision:2006-04-09
ID Venta: 0000546-5s654-sds645-sds65

DNI Cliente:${m.document}
Nombre Cliente:${m.name}
${i.value}
                 Subtotal:           S/${Math.round((B.value*(100/118)+Number.EPSILON)*10)/10}
                 IGV(18%):           S/${Math.round((B.value*(18/118)+Number.EPSILON)*10)/10}
                 Total:              S/${B.value}
------------------------------------------------  `),A=_=>{let r="";for(let P=0;P<8-_.toString().length;P++)r+="0";return r+_.toString()},U=()=>{m.documentType=1,m.document="0",m.name="",m.email="",o.value=[]},G=(_,r,P,I,M=[])=>{let $=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return r==="ticket"?$+=`
              TICKET DE VENTA ELECTRONICO 
      `:$+=`
         ${r.toLocaleUpperCase()} ELECTRONICA ${M.serie}-${A(M.correlative)}
      `,$+=`
Fecha de emision:${r!=="ticket"?M.dateTime:P.dateTime}
ID Venta: 00000${P.id}
  `,r!=="ticket"&&($+=`
CLIENTE:
Documento: ${I.document}
Nombre: ${I.name}
`),$+=K(o.value),$+=`
                OP.GRAVADAS:        S/ ${Math.round((P.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((P.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${P.total}
------------------------------------------------ 
${_}

************************************************
            !GRACIAS POR SU COMPRA!
`,$},K=_=>{let r="",P="",I=`
------------------------------------------------
`;return I+=`PRODUCTO                 CANT P.UNI   MONTO
`,I+=`------------------------------------------------
`,_.forEach(M=>{r=M.name.slice(0,24)+v(24-M.name.length),r+="  ",r+=""+M.quantity+v(3-(""+M.quantity).length),r+=" S/",r+=""+M.priceSale+v(6-(""+M.priceSale).length),r+=" S/",r+=""+M.mount+v(7-(""+M.mount).length),I+=`${r}
`,M.name.length>24&&(P=M.name.slice(24,48),I+=`${P}
`),M.name.length>48&&(P=M.name.length>72?M.name.slice(48,72)+"...":M.name.slice(48),I+=`${P}
`)}),I+=`------------------------------------------------
`,I},B=Y(()=>o.value.reduce((_,r)=>_+r.mount,0)),N=_=>a.state.products.find(({code:P})=>P.toString()===s.value),h=({id:_,code:r,name:P,priceSale:I},M=1)=>{const $={id:_,code:r,name:P,priceSale:I,quantity:M,mount:I*1};if(o.value.every(ee=>ee.id!==_))o.value.push($);else{const ee=o.value.findIndex(Se=>Se.id===_);o.value[ee].quantity+=1,o.value[ee].mount=$.priceSale*o.value[ee].quantity}o.value.length===0&&o.value.push($),s.value=""},F=_=>{const r=o.value.findIndex(P=>P.id===_);o.value.splice(r,1)};z(async()=>{try{await a.dispatch("fetchProducts");const r=await(await fetch("http://localhost:5050/devices")).json()}catch{l.value=!0,C.value="No se encuentra el controlador de la impresora por favor inicie el controlador y configure la impresora"}});const Z=()=>{const _=s.value;setTimeout(()=>{if(s.value===_){const r=N(s.value);r&&h(r),s.value=""}},100)},J=async _=>{f.value=!0;const r=await a.dispatch("saveSale",{soldProducts:o.value,client:m,typeProof:_});let P="";_!=="ticket"?r.proof.status!=="ACEPTADA"?(C.value=r.proof.description,l.value=!0,setTimeout(()=>{l.value=!1},3e3)):P=G(r.legend,_,r.sale,r.client,r.proof.data):P=G(r.legend,_,r.sale,r.client,[]),console.log(P);try{P=P.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),await a.dispatch("printerTicket",{text:P}),f.value=!1}catch{f.value=!1,C.value="La venta se ha registrado exitosamente, pero no se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",l.value=!0}finally{U(),d.value=!1}},ne=()=>{s.value="",t.value.focus()},T=()=>{if(o.value.some(_=>_.priceSale===0)){C.value="Los precios no pueden ser cero",l.value=!0,setTimeout(()=>{l.value=!1},3e3);return}d.value=!0};return(_,r)=>(S(),g(V,null,[R(bo,{show:d.value,onHide:r[0]||(r[0]=P=>d.value=!1),client:p(m),onSave:r[1]||(r[1]=P=>J(P)),loading:f.value},null,8,["show","client","loading"]),R(oo,{show:O.value,onHide:r[2]||(r[2]=P=>O.value=!1),onAddProduct:r[3]||(r[3]=P=>h(P))},null,8,["show"]),e("div",Mo,[e("div",To,[b(e("input",{required:"",autocomplete:"off",onInput:r[4]||(r[4]=P=>Z()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:r[5]||(r[5]=P=>P.target.blur()),onBlur:r[6]||(r[6]=P=>n.value=!1),onFocus:r[7]||(r[7]=P=>n.value=!0),ref_key:"fieldCode",ref:t,"onUpdate:modelValue":r[8]||(r[8]=P=>s.value=P)},null,544),[[L,s.value]]),e("div",Lo,[e("label",yo,"Codigo "+D(": "+s.value),1),e("div",Fo,[e("button",{tabindex:"-1",class:"button is-success",disabled:n.value,type:"button",onClick:r[9]||(r[9]=P=>ne())},D(n.value?"Escaneando codigos...":"Escanear codigos"),9,No)])]),e("div",wo,[e("input",{type:"button",class:"button is-info",onClick:r[10]||(r[10]=P=>O.value=!0),value:"Agregar producto manualmente"})]),e("div",ko,[R(_e,{onItemSelected:r[11]||(r[11]=P=>h(P))})])]),e("div",xo,[e("table",Wo,[Vo,e("tbody",null,[(S(!0),g(V,null,X(o.value,P=>(S(),se(xs,{key:P.id,product:P,onQuit:r[12]||(r[12]=I=>F(I))},null,8,["product"]))),128)),e("tr",null,[Go,e("th",null,"S/. "+D(p(B)),1),jo])])]),$o,e("button",{disabled:o.value.length===0,onClick:r[13]||(r[13]=P=>T()),class:"button is-primary"},"Realizar venta",8,Ho),l.value?(S(),g("div",Bo,[e("button",{onClick:r[14]||(r[14]=P=>l.value=!1),class:"delete"}),oe(" "+D(C.value),1)])):y("",!0)]),e("div",Ko,[e("iframe",{style:{width:"550px",height:"900px",padding:"0"},name:"page-printer",srcdoc:p(E)},null,8,Jo)])])],64))}}),qo={key:0,class:"modal is-active",style:{"z-index":"9999"}},zo=e("div",{class:"modal-background"},null,-1),Yo={class:"modal-content",style:{width:"35%",height:"30%"}},Qo={class:"message is-danger"},Zo={class:"message-header"},en=e("p",null,"Danger",-1),sn={class:"message-body"},on=e("span",null,"Una vez que se dea de baja ya no se podra recuperar",-1),nn=e("br",null,null,-1),an=e("br",null,null,-1),rn={key:0,class:"field"},tn=e("label",{class:"label"},"Motivo de Baja",-1),ln={class:"control"},pn=["disabled"],mn={key:1,class:"modal is-active"},dn=e("div",{class:"modal-background"},null,-1),cn={class:"modal-card",style:{width:"50%",height:"70%"}},_n={class:"modal-card-head"},Cn=e("p",{class:"modal-card-title"},"Detalles de la venta",-1),un={class:"modal-card-body"},Pn={key:0,class:"notification is-danger"},Sn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},gn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Comprobante")])],-1),En={key:0,style:{"padding-top":"2px"}},fn=e("th",null,"Tipo",-1),Rn=e("th",null,"Serie-Correlativo",-1),On=e("th",null,"Fecha y hora de emision",-1),An={colspan:"2"},Dn=["disabled"],Un={class:"tag is-danger m-2"},hn={key:1,style:{"padding-top":"2px"}},In=e("tr",null,[e("th",null,"SIN COMPROBANTE")],-1),vn=[In],bn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Mn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"2",style:{"text-align":"center"}},"Cliente")])],-1),Tn={style:{"padding-top":"2px"}},Ln=e("th",null,"Documento",-1),yn=e("th",null,"Nombre",-1),Fn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Nn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Productos Vendidos")]),e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto")])],-1),wn={style:{"padding-top":"2px"}},kn=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),xn={class:"modal-card-foot"},Wn=["disabled"],Vn=k({props:{show:Boolean,saleId:Number},emits:["save","hide"],setup(c,{emit:a}){const s=c,t=j(),n=u(s.show),o=u(!1),i=u("ticket"),d=u(!1),f=u(""),O=u(0),l=u({}),C=u({}),m=u({}),E=u(""),v=u(!1),W=u(!1),A=u(!1),U=u(!0),G=u(""),K=u(s.saleId),B=u([]);H(()=>{n.value=s.show}),H(async()=>{if(s.saleId===0)return;v.value=!1,K.value=s.saleId;const T=await t.dispatch("fetchSaleDetail",{id:K.value});console.log(T),v.value=!0,B.value=T.data.soldProducts,O.value=T.data.sale.total,l.value=T.data.client,C.value=T.data.proof,E.value=T.data.legend,m.value=T.data.sale,U.value=C.value.enable===1&&(C.value.status===1||C.value.status===2||C.value.status===4),i.value=C.value===!1?"ticket":C.value.serie.startsWith("B")?"boleta":"factura"}),H(()=>{d.value&&setTimeout(()=>{d.value=!1},2500)});const N=(T,_,r,P,I=[])=>{let M=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return _==="ticket"?M+=`
              TICKET DE VENTA ELECTRONICO 
      `:M+=`
         ${_.toLocaleUpperCase()} ELECTRONICA ${I.serie}-${h(I.correlative)}
      `,M+=`
Fecha de emision:${_!=="ticket"?I.dateTime:r.dateTime}
ID Venta: 00000${r.id}
  `,_!=="ticket"&&(M+=`
CLIENTE:
Documento: ${P.document}
Nombre: ${P.name}
`),M+=Z(B.value),M+=`
                OP.GRAVADAS:        S/ ${Math.round((r.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((r.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${r.total}
------------------------------------------------ 
${T}

************************************************
            !GRACIAS POR SU COMPRA!
`,M},h=T=>{let _="";for(let r=0;r<8-T.toString().length;r++)_+="0";return _+T.toString()},F=T=>{if(T<=0)return"";let _="";for(let r=0;r<T;r++)_+=" ";return _},Z=T=>{let _="",r="",P=`
------------------------------------------------
`;return P+=`PRODUCTO                 CANT P.UNI   MONTO
`,P+=`------------------------------------------------
`,T.forEach(I=>{_=I.name.slice(0,24)+F(24-I.name.length),_+="  ",_+=""+I.quantity+F(3-(""+I.quantity).length),_+=" S/",_+=""+I.price+F(6-(""+I.price).length),_+=" S/",_+=""+I.mount+F(7-(""+I.mount).length),P+=`${_}
`,I.name.length>24&&(r=I.name.slice(24,48),P+=`${r}
`),I.name.length>48&&(r=I.name.length>72?I.name.slice(48,72)+"...":I.name.slice(48),P+=`${r}
`)}),P+=`------------------------------------------------
`,P},J=async()=>{W.value=!0;let T=N(E.value,i.value,m.value,l.value,C.value);try{T=T.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),console.log(T),await t.dispatch("printerTicket",{text:T}),W.value=!1}catch{W.value=!1,f.value="No se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",d.value=!0,setTimeout(()=>{d.value=!1},1e4)}},ne=async()=>{A.value=!0;try{await t.dispatch("darBaja",{proofId:C.value.id,typeProof:i.value,motivoBaja:G.value}),A.value=!1,f.value="Comprobante Dado de baja con exito",d.value=!0,U.value=!1,o.value=!1,setTimeout(()=>{d.value=!1},1e4)}catch(T){A.value=!1,f.value=T,d.value=!0,U.value=!0,setTimeout(()=>{d.value=!1},1e4)}};return(T,_)=>(S(),g(V,null,[o.value?(S(),g("div",qo,[zo,e("div",Yo,[e("article",Qo,[e("div",Zo,[en,e("button",{class:"delete",onClick:_[0]||(_[0]=r=>o.value=!1),"aria-label":"delete"})]),e("div",sn,[e("span",null,"\xBF\xBF Esta seguro de dar de baja esta "+D(i.value)+"?",1),on,nn,an,i.value==="factura"?(S(),g("div",rn,[tn,e("p",ln,[b(e("input",{class:"input is-upper",placeholder:"ejemplo: ruc equibocado","onUpdate:modelValue":_[1]||(_[1]=r=>G.value=r)},null,512),[[L,G.value]])])])):y("",!0),e("button",{disabled:A.value,class:"button is-danger mx-2",onClick:_[2]||(_[2]=r=>ne())},"Dar de baja",8,pn),e("button",{class:"button",onClick:_[3]||(_[3]=r=>o.value=!1)},"Cancelar")])])])])):y("",!0),n.value&&v.value?(S(),g("div",mn,[dn,e("div",cn,[e("header",_n,[Cn,e("button",{class:"delete","aria-label":"close",onClick:_[4]||(_[4]=r=>a("hide"))})]),e("section",un,[d.value?(S(),g("div",Pn,[e("button",{onClick:_[5]||(_[5]=r=>d.value=!1),class:"delete"}),oe(" "+D(f.value),1)])):y("",!0),e("table",Sn,[gn,C.value!==!1?(S(),g("tbody",En,[e("tr",null,[fn,e("td",null,D(i.value.toLocaleUpperCase()),1)]),e("tr",null,[Rn,e("td",null,D(C.value.serie)+"-"+D(h(C.value.correlative)),1)]),e("tr",null,[On,e("td",null,D(C.value.dateTime),1)]),e("tr",null,[e("td",An,[e("button",{type:"button",onClick:_[6]||(_[6]=r=>o.value=!0),disabled:!U.value,class:"button is-danger"},"DAR DE BAJA LA "+D(i.value.toLocaleUpperCase()),9,Dn),e("span",Un," LA "+D(i.value.toLocaleUpperCase())+" YA HA SIDO DADA DE BAJA",1)])])])):y("",!0),C.value===!1?(S(),g("tbody",hn,vn)):y("",!0)]),e("table",bn,[Mn,e("tbody",Tn,[e("tr",null,[Ln,e("td",null,D(l.value.document),1)]),e("tr",null,[yn,e("td",null,D(l.value.name),1)])])]),e("table",Fn,[Nn,e("tbody",wn,[(S(!0),g(V,null,X(B.value,r=>(S(),g("tr",{key:r.id},[e("td",null,D(r.code),1),e("td",null,D(r.name),1),e("td",null,"S/ "+D(r.price),1),e("td",null,D(r.quantity),1),e("td",null,"S/ "+D(r.mount),1)]))),128)),e("tr",null,[kn,e("th",null,"S/. "+D(O.value),1)])])])]),e("footer",xn,[e("button",{disabled:W.value||!U.value,onClick:_[7]||(_[7]=r=>J()),class:"button is-success"},"Imprimir copia de "+D(i.value),9,Wn),e("button",{onClick:_[8]||(_[8]=r=>a("hide")),class:"button"},"Cancelar")])])])):y("",!0)],64))}});const Gn={class:"columns"},jn={class:"column is-11"},$n={class:"control has-icons-left"},Hn={class:"column is-1"},Bn={class:"h-100 oy-scroll"},Kn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Jn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"ID"),e("th",null,"Cliente"),e("th",null,"Documento Cliente"),e("th",null,"Fecha emision"),e("th",null,"Importe Total"),e("th")])],-1),Xn={style:{"padding-top":"2px"}},qn=["onClick"],Ce=k({setup(c){const a=j(),s=u([]),t=u([]),n=u(""),o=u(!1),i=u(0);z(async()=>{const O=await a.dispatch("fetchSales");s.value=O.data.reverse(),t.value=s.value});const d=()=>{const O=n.value.toLowerCase();t.value=s.value.filter(l=>l.clientName.toLowerCase().includes(O)||l.clientDocument.toString().toLowerCase().includes(O))},f=async()=>{const O=await a.dispatch("fetchSales");s.value=O.data.reverse(),t.value=s.value};return(O,l)=>(S(),g(V,null,[R(Vn,{saleId:i.value,show:o.value,onHide:l[0]||(l[0]=C=>o.value=!1)},null,8,["saleId","show"]),e("div",Gn,[e("div",jn,[e("div",$n,[b(e("input",{class:"input",type:"search",onInput:l[1]||(l[1]=C=>d()),"onUpdate:modelValue":l[2]||(l[2]=C=>n.value=C),placeholder:"Buscar por nombre o documento"},null,544),[[L,n.value,void 0,{trim:!0}]]),R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(le))]),_:1})])]),e("div",Hn,[e("button",{class:"button is-primary",onClick:l[3]||(l[3]=C=>f())},[R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(pe))]),_:1})])])]),e("div",Bn,[e("table",Kn,[Jn,e("tbody",Xn,[(S(!0),g(V,null,X(t.value,C=>(S(),g("tr",{key:C.id},[e("td",null,D(C.id),1),e("td",null,D(C.clientName),1),e("td",null,D(C.clientDocument),1),e("td",null,D(C.dateTime),1),e("td",null,D(C.total),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:m=>(i.value=C.id,o.value=!0)},[R(p(x),null,{default:w(()=>[R(p(me))]),_:1})],8,qn)])]))),128))])])])],64))}}),zn=k({setup(c){const a=u("new");return(s,t)=>(S(),g("div",null,[e("button",{class:"button is-info",onClick:t[0]||(t[0]=n=>a.value="new")},"Nueva Venta"),e("button",{class:"button is-info",onClick:t[1]||(t[1]=n=>a.value="list")},"Lista de ventas"),a.value==="new"?(S(),se(Xo,{key:0})):y("",!0),a.value==="list"?(S(),se(Ce,{key:1})):y("",!0)]))}}),Yn={class:"columns"},Qn={class:"column"},Zn=["value"],ea=k({setup(c){const a=u([]),s=u("");z(async()=>{const o=await(await fetch("http://localhost:5050/devices")).json();a.value=o,s.value=localStorage.printer});const t=()=>{localStorage.printer=s.value};return(n,o)=>(S(),g("div",Yn,[e("div",Qn,[b(e("select",{"onUpdate:modelValue":o[0]||(o[0]=i=>s.value=i)},[(S(!0),g(V,null,X(a.value,i=>(S(),g("option",{key:i.vendor_id,value:i.product_id+"/"+i.vendor_id},D(i.vendor_id)+":"+D(i.product_id)+" "+D(i.name),9,Zn))),128))],512),[[ce,s.value]]),e("button",{class:"button is-primary",onClick:o[1]||(o[1]=i=>t())},"Guardar")])]))}}),sa=["onSubmit"],oa={class:"field"},na=e("label",{class:"label"},"Usuario",-1),aa={class:"control has-icons-left"},ra={class:"field"},ta=e("label",{class:"label"},"Contrase\xF1a",-1),ia={class:"control has-icons-left"},la={class:"field"},pa={class:"control is-expanded"},ma=e("button",{class:"button is-primary is-medium input mt-2"},"Iniciar Sesion",-1),da={key:0,class:"help is-danger"},ca=k({setup(c){const a=j(),s=u(!1),t=De(),n=q({userName:"",password:""}),o=async()=>{const i=await a.dispatch("userLogin",{credentials:n});if(s.value=!i.success,i.success){const d=await a.dispatch("fetchProducts");console.log(d),t.replace("products")}console.log(i.message)};return(i,d)=>(S(),g("form",{onSubmit:ae(o,["prevent"]),class:"box column is-4 is-offset-4"},[e("div",oa,[na,e("div",aa,[b(e("input",{class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":d[0]||(d[0]=f=>p(n).userName=f),placeholder:"Nombre de usuario"},null,512),[[L,p(n).userName]]),R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(Ue))]),_:1})])]),e("div",ra,[ta,e("div",ia,[b(e("input",{class:"input is-medium",required:"","onUpdate:modelValue":d[1]||(d[1]=f=>p(n).password=f),type:"password",placeholder:"************"},null,512),[[L,p(n).password]]),R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(he))]),_:1})])]),e("div",la,[e("p",pa,[ma,s.value?(S(),g("span",da,"Error al iniciar session")):y("",!0)])])],40,sa))}}),_a=["onSubmit"],Ca={class:"field"},ua={class:"control"},Pa={key:0,class:"help is-danger"},Sa={class:"field"},ga=e("label",{class:"label"},"DNI",-1),Ea={class:"control"},fa={class:"field"},Ra=e("label",{class:"label"},"Nombres y Apellidos",-1),Oa={class:"control"},Aa={class:"field"},Da=e("label",{class:"label"},"Contrase\xF1a",-1),Ua={class:"control"},ha={key:0,class:"help is-danger"},Ia={class:"field"},va=e("label",{class:"label"},"Repetir Contrase\xF1a",-1),ba={class:"control"},Ma={key:0,class:"help is-danger"},Ta={class:"field"},La=e("label",{class:"label"},"Celular",-1),ya={class:"control"},Fa={class:"field"},Na=e("label",{class:"label"},"Email",-1),wa={class:"control"},ka=e("button",{class:"button is-primary"},"Registrar usuario",-1),xa=k({setup(c){const a=u(),s=j(),t=u(!1),n=u([]),o=q({userName:"",dni:"",fullName:"",email:"",password:"",roleId:"1",mobile:""}),i=u(""),d=u(!1),f=()=>{o.password!==i.value?d.value=!0:d.value=!1};z(async()=>{const l=await s.dispatch("fetchRoles");n.value=l.data});const O=async()=>{if(o.password!==i.value){d.value=!0;return}const l=await s.dispatch("userSignup",{user:o});t.value=l.success,l.success&&(a.value.reset(),alert(`usuario registrado 
 UserName: `+l.data.userName)),console.log(l.message)};return(l,C)=>(S(),g("form",{onSubmit:ae(O,["prevent"]),ref_key:"form",ref:a},[e("div",Ca,[e("div",ua,[t.value?y("",!0):(S(),g("span",Pa,"Ya existe un producto con este codigo"))])]),e("div",Sa,[ga,e("div",Ea,[b(e("input",{class:"input",ref:"fieldName","onUpdate:modelValue":C[0]||(C[0]=m=>p(o).dni=m),type:"number",placeholder:"documento de identidad"},null,512),[[L,p(o).dni]])])]),e("div",fa,[Ra,e("div",Oa,[b(e("input",{class:"input",ref:"fieldName",required:"","onUpdate:modelValue":C[1]||(C[1]=m=>p(o).fullName=m),type:"text",placeholder:"Nombres y apellidos"},null,512),[[L,p(o).fullName]])])]),e("div",Aa,[Da,e("div",Ua,[b(e("input",{class:Q(["input",{"is-danger":d.value}]),required:"",step:"0.1","onUpdate:modelValue":C[2]||(C[2]=m=>p(o).password=m),type:"password",placeholder:"Contrase\xF1a"},null,2),[[L,p(o).password]]),d.value?(S(),g("span",ha,"Las contrase\xF1as deven ser iguales")):y("",!0)])]),e("div",Ia,[va,e("div",ba,[b(e("input",{class:Q(["input",{"is-danger":d.value}]),onBlur:C[3]||(C[3]=m=>f()),required:"",step:"0.1","onUpdate:modelValue":C[4]||(C[4]=m=>i.value=m),type:"password",placeholder:"Vuelva a escribir la contrase\xF1a"},null,34),[[L,i.value]]),d.value?(S(),g("span",Ma,"Las contrase\xF1as deven ser iguales")):y("",!0)])]),e("div",Ta,[La,e("div",ya,[b(e("input",{class:"input",step:"0.1","onUpdate:modelValue":C[5]||(C[5]=m=>p(o).mobile=m),type:"number",placeholder:"Numero de celular"},null,512),[[L,p(o).mobile]])])]),e("div",Fa,[Na,e("div",wa,[b(e("input",{class:"input",ref:"fieldName","onUpdate:modelValue":C[6]||(C[6]=m=>p(o).email=m),type:"text",placeholder:"Correo electronico"},null,512),[[L,p(o).email]])])]),ka],40,_a))}}),Wa={class:"menu"},Va=["srcdoc"],Ga=k({props:{product:Object,stock:Number},setup(c){const a=c,s=u(),t=u(),n=u(""),o=async(i,d)=>{const f=t.value.src;let O=`
   <html>
  <head>
  <style>
  *{

  }
  </style>
   </head>
   <body style="width:108mm;padding:0;margin:0">
   <div style="margin:0 2.5mm;padding:0;width:103mm;display:grid;grid-template-columns: repeat(3, 1fr);font-family:arial;font-weight: bold;justify-content:center ;height:21mm ;page-break-after: always">`;for(let l=0;l<d;l++)O+=`<div style="display: flex;flex-direction: column;align-items: center;font-size: 10px;widt:30mm;max-width:30mm;border:1px solid black;padding:2px;text-align:center;height:20mm;page-break-after: always">
    <span style="margin: 0;padding: 0;z-index: 1;word-wrap:break-word;word-break: break-all;">${i.name}</span>
    <img style="width:29mm" src="${f}"/>
    <span style="margin: 0;padding: 0;z-index: 1">${i.code}</span>
    </div>`;O+=`</div> </body>
  </html>`,n.value=O};return H(async()=>{Ie("#barcode",a.product.code,{displayValue:!1,height:20,width:1,margin:0}),await o(a.product,a.stock)}),(i,d)=>(S(),g("div",Wa,[e("iframe",{id:"printf",name:"printf",ref_key:"pdf",ref:s,style:{width:"1000px",height:"900px",border:"1x solid red"},srcdoc:n.value},null,8,Va),e("img",{ref_key:"img",ref:t,id:"barcode",style:{display:"none"}},null,512)]))}}),ja={class:"columns"},$a={class:"column is-4"},Ha={class:"field"},Ba=e("label",{class:"label"},"Usuario",-1),Ka={class:"control"},Ja=k({setup(c){const a=u({}),s=u(9),t=()=>{const o=window;o.frames.printf.focus(),o.frames.printf.print()},n=o=>{a.value=o,console.log(o.code)};return(o,i)=>(S(),g("div",ja,[e("form",$a,[e("div",Ha,[Ba,e("div",Ka,[b(e("input",{type:"number",class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":i[0]||(i[0]=d=>s.value=d),placeholder:"Cantidad"},null,512),[[L,s.value,void 0,{number:!0}]])])]),e("button",{type:"button",onClick:i[1]||(i[1]=d=>t()),class:"button is-primary is-medium"},"Imprimir Codigos"),R(_e,{onItemSelected:i[2]||(i[2]=d=>n(d))})]),R(Ga,{class:"column is-8",product:a.value,stock:s.value},null,8,["product","stock"])]))}}),Xa={class:"columns"},qa={class:"column is-4"},za=k({setup(c){const a=j(),s=()=>{const t=a.dispatch("sendSummaries");console.log(t)};return(t,n)=>(S(),g("div",Xa,[e("form",qa,[e("button",{type:"button",onClick:n[0]||(n[0]=o=>s()),class:"button is-primary is-medium"},"Generar y envia resumenes")])]))}}),Ya=[{path:"/login",name:"login",component:ca},{path:"/sales",name:"sales",component:zn},{path:"/listSales",name:"listSales",component:Ce},{path:"/printers",name:"printers",component:ea},{path:"/products",name:"products",component:Ls},{path:"/signup",name:"signup",component:xa},{path:"/barcodes",name:"barcodes",component:Ja},{path:"/proofPayments",name:"proofPayments",component:za}],ue=ve({history:be("vilcherrez"),routes:Ya});ue.beforeEach(async(c,a)=>{if(!te.state.isAuthenticated&&c.name!=="login")return{name:"login"};if(te.state.isAuthenticated&&c.name==="login")return{name:"sales"}});const Pe=Me(Ve);Pe.use(te).use(ue).mount("#app");Pe.config.globalProperties.$log=console.log;
