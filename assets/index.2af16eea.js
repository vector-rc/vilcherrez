import{d as k,u as j,c as Q,a as g,b as p,e as R,w,f as oe,g as y,h as e,r as ie,o as S,I as x,B as ge,S as Ee,i as fe,j as Re,P as Oe,k as Ae,l as _,m as z,n as b,v as L,p as le,A as pe,F as V,q as X,t as D,E as me,s as q,x as Y,D as de,y as H,z as Z,C as ae,G as re,H as ce,J as De,K as Ue,L as he,M as Ie,N as ve,O as be,Q as Me}from"./vendor.6a6ef53a.js";const Te=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}};Te();const Le={class:"is-fluid columns p-5"},ye={key:0,class:"column is-1"},Fe=e("span",null,"Productos",-1),Ne=e("span",null,"Ventas",-1),we=e("span",null,"Configs",-1),ke=e("span",null,"Barcodes",-1),xe=e("span",null,"Usuarios",-1),We={class:"column is-11"},Ve=k({setup(c){const a=j(),s=Q(()=>a.state.user.userName),t=Q(()=>a.state.isAuthenticated);return(n,o)=>{const i=ie("router-link"),d=ie("router-view");return S(),g("main",Le,[p(t)?(S(),g("div",ye,[R(i,{class:"item_menu",to:"/products"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(ge))]),_:1}),Fe]),_:1}),R(i,{class:"item_menu",to:"/sales"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(Ee))]),_:1}),Ne]),_:1}),R(i,{class:"item_menu",to:"/printers"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(fe))]),_:1}),we]),_:1}),R(i,{class:"item_menu",to:"/barcodes"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(Re))]),_:1}),ke]),_:1}),p(s)==="Balta"?(S(),oe(i,{key:0,class:"item_menu",to:"/signup"},{default:w(()=>[R(p(x),{size:"30"},{default:w(()=>[R(p(Oe))]),_:1}),xe]),_:1})):y("",!0)])):y("",!0),e("div",We,[R(d)])])}}});var te=Ae({state:{products:[],user:{},isAuthenticated:!1},mutations:{test(){console.log("hola desde vuex")}},actions:{async fetchProducts({state:c}){try{const s=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/products")).json();return s.success&&(c.products=s.data.reverse()),s}catch(a){return console.log(a.type),{success:!0,message:a}}},async fetchSales({state:c}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sales",{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(a){return console.log(a.type),{success:!1,message:a}}},async fetchBoletas({state:c}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/boletas",{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(a){return console.log(a.type),{success:!1,message:a}}},async fetchFacturas({state:c}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/facturas",{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(a){return console.log(a.type),{success:!1,message:a}}},async fetchSaleDetail({state:c},{id:a}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/saleDetail/${a}`,{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchBoletaDetail({state:c},{id:a}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/boletaDetail/${a}`,{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchFacturaDetail({state:c},{id:a}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/facturaDetail/${a}`,{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchPackProducts({state:c},{id:a}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/pack_product/${a}`,{headers:{Authorization:`bearer ${c.user.token} `}})).json()}catch(s){return{data:null,success:!0,message:s}}},async fetchRoles(){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/user_roles")).json()}catch(c){return{success:!0,message:c}}},async userLogin({state:c},{credentials:a}){try{const t=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/login",{method:"POST",body:JSON.stringify(a)})).json();return console.log(t),t.success&&(c.user=t.data,c.isAuthenticated=t.success,localStorage.token=t.data.token),t}catch(s){return console.log(s),{success:!1,message:s}}},async userSignup({state:c},{user:a}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/signup",{method:"POST",body:JSON.stringify(a)})).json()}catch(s){return console.log(s),{success:!1,message:s}}},async saveProduct({state:c},{action:a,product:s}){try{const n=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:a==="add"?"POST":"PUT",headers:{Authorization:`bearer ${c.user.token} `},body:JSON.stringify(s)})).json();if(n.success&&(a==="add"&&c.products.unshift(n.data),a==="edit")){const o=c.products.findIndex(i=>i.id===s.id);console.log(o),c.products[o]=n.data}return n}catch{}},async savePackingProduct({state:c},{action:a,data:s}){console.log({action:a});try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:a==="add"?"POST":"PUT",headers:{Authorization:`bearer ${c.user.token} `},body:JSON.stringify(s)})).json()}catch{}},async printerTicket(c,{text:a}){return await(await fetch(`http://localhost:5050/printer/${localStorage.printer}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a,qr_content:"hola mundo"})})).text()},async testEncode(c,{text:a}){return await(await fetch("http://localhost:5050/decodeurl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a,qr_content:"hola mundo"})})).text()},async getInfoDoc({state:c},{typeDoc:a,document:s}){let t;return console.log(a),a===1&&(t=await fetch(`https://inversionesvilver.com/shop-back/api/v1/dni/${s}`,{headers:{Authorization:`bearer ${c.user.token} `}})),a===6&&(t=await fetch(`https://inversionesvilver.com/shop-back/api/v1/ruc/${s}`,{headers:{Authorization:`bearer ${c.user.token} `}})),(await t.json()).data},async saveSale({state:c},{soldProducts:a,client:s,typeProof:t}){return(await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sale",{method:"POST",headers:{Authorization:`bearer ${c.user.token} `},body:JSON.stringify({soldProducts:a,client:s,userId:c.user.id,typeProof:t})})).json()).data},async sendSummaries({state:c}){return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sendResumenes",{method:"POST",headers:{Authorization:`bearer ${c.user.token} `}})).json()},async darBaja({state:c},{proofId:a,typeProof:s,motivoBaja:t}){let n="",o="";return s==="boleta"&&(n="bajaBoleta",o=JSON.stringify({idBoleta:a})),s==="factura"&&(n="bajaFactura",o=JSON.stringify({idFactura:a,motivoBaja:t})),await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/${n}`,{method:"POST",headers:{Authorization:`bearer ${c.user.token} `},body:o})).json()}},modules:{}});const Ge={class:"columns"},je={class:"column is-11"},$e={class:"control has-icons-left"},He={class:"column is-1"},Be={class:"h-100 oy-scroll"},Ke={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Je=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th")])],-1),Xe={style:{"padding-top":"2px"}},qe=["onClick"],ze=["onClick"],Qe=k({emits:["editProduct"],setup(c,{emit:a}){const s=j(),t=_([]),n=_([]),o=_("");z(async()=>{t.value=s.state.products,n.value=s.state.products});const i=()=>{const C=o.value.toLowerCase().split(" "),m=[];C.forEach((E,v)=>{if(E.length<2)return;t.value.filter(({name:A,code:I})=>A.toLowerCase().includes(E)||I.toString().toLowerCase().includes(E)).forEach((A,I)=>{if(m.length===0){m.push(A);return}if(m.every(({id:G})=>G!==A.id))m.push(A);else{const G=m.findIndex(({id:K})=>K===A.id);m.splice(G,1),m.unshift(A)}})}),n.value=m},d=l=>{console.log("hola")},f=l=>{navigator.clipboard.writeText(l.name)},O=async()=>{await s.dispatch("fetchProducts"),t.value=s.state.products,n.value=s.state.products};return(l,C)=>(S(),g(V,null,[e("div",Ge,[e("div",je,[e("div",$e,[b(e("input",{class:"input",type:"search",onInput:C[0]||(C[0]=m=>i()),"onUpdate:modelValue":C[1]||(C[1]=m=>o.value=m),placeholder:"Buscar producto"},null,544),[[L,o.value,void 0,{trim:!0}]]),R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(le))]),_:1})])]),e("div",He,[e("button",{class:"button is-primary",onClick:C[2]||(C[2]=m=>O())},[R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(pe))]),_:1})])])]),e("div",Be,[e("table",Ke,[Je,e("tbody",Xe,[(S(!0),g(V,null,X(n.value,m=>(S(),g("tr",{key:m.id},[e("td",null,D(m.code),1),e("td",{style:{cursor:"copy"},onClick:E=>f(m)},D(m.name),9,qe),e("td",null,"S/."+D(m.priceSale),1),e("td",null,D(m.stock),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:E=>(d(),a("editProduct",m.productId))},[R(p(x),null,{default:w(()=>[R(p(me))]),_:1})],8,ze)])]))),128))])])])],64))}}),Ye={class:"control"},Ze={key:0,class:"help is-danger"},es=["disabled","value"],ss={class:"control"},os={class:"control"},ns={class:"control"},as={class:"control"},rs={class:"control"},ts=k({props:{product:Object},emits:["quit"],setup(c,{emit:a}){const s=c,t=j(),n=q(s.product),o=_(!1),i=_(!1),d=_(),f=()=>{if(n.priceBuy===0)return;let m=0;switch(n.packing.toLocaleUpperCase()){case"UND":m=.5;break;case"10 UND":m=.25;break;case"12 UND":m=.25;break;case"DOCENA":m=.25;break;case"25 UND":m=.25;break;case"50 UND":m=.25;break;case"100 UND":m=.25;break}if(m!==0){const E=n.priceBuy+n.priceBuy*m;n.packing==="UND"?n.priceSale=Math.round((E+Number.EPSILON)*10)/10:n.priceSale=Math.ceil(E)}},O=()=>{const m=n.code;setTimeout(()=>{n.code===m&&d.value.blur()},100)},l=()=>(n.productId!==void 0?i.value=t.state.products.some(({code:m,productId:E})=>m.toString()===n.code&&E!==n.productId):i.value=t.state.products.some(({code:m})=>m.toString()===n.code),o.value=!1,i.value),C=()=>{n.code="",i.value=!1,d.value.focus()};return(m,E)=>(S(),g("tr",null,[e("td",Ye,[b(e("input",{autocomplete:"off",onInput:E[0]||(E[0]=v=>O()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:E[1]||(E[1]=v=>v.target.blur()),onBlur:E[2]||(E[2]=v=>l()),onFocus:E[3]||(E[3]=v=>o.value=!0),ref_key:"codeField",ref:d,"onUpdate:modelValue":E[4]||(E[4]=v=>p(n).code=v)},null,544),[[L,p(n).code]]),i.value?(S(),g("span",Ze,"Ya hay un producto con este codigo")):y("",!0),Y(" "+D(p(n).code)+" ",1),e("input",{type:"button",onClick:E[5]||(E[5]=v=>C()),disabled:o.value,value:o.value?"Esperando escaneo...":"Escanear codigo",class:"button is-info"},null,8,es)]),e("td",ss,[b(e("input",{class:"input is-upper",placeholder:"10UND","onUpdate:modelValue":E[6]||(E[6]=v=>p(n).packing=v)},null,512),[[L,p(n).packing]])]),e("td",os,[b(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"precio de compra","onUpdate:modelValue":E[7]||(E[7]=v=>p(n).priceBuy=v),onInput:E[8]||(E[8]=v=>f())},null,544),[[L,p(n).priceBuy]])]),e("td",ns,[b(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"Precio de Venta","onUpdate:modelValue":E[9]||(E[9]=v=>p(n).priceSale=v)},null,512),[[L,p(n).priceSale]])]),e("td",as,[b(e("input",{class:"input is-upper",type:"number",placeholder:"Cantidad","onUpdate:modelValue":E[10]||(E[10]=v=>p(n).stock=v)},null,512),[[L,p(n).stock]])]),e("td",rs,[e("button",{type:"button",class:"button is-danger",onClick:E[11]||(E[11]=v=>a("quit",s.product.id))},[R(p(x),{size:"25"},{default:w(()=>[R(p(de))]),_:1})])])]))}}),is={key:0,class:"modal is-active"},ls=e("div",{class:"modal-background"},null,-1),ps={class:"modal-card"},ms={class:"modal-card-head"},ds=e("p",{class:"modal-card-title"},"Advertencia",-1),cs=e("section",{class:"modal-card-body"},"Algunos codigos estan vacios, \xBFquiere guardar de todas formas?",-1),_s={class:"modal-card-foot"},Cs={class:"field"},Ps={class:"control"},us={key:0,class:"help is-danger"},Ss={class:"table is-bordered"},gs=e("th",null,"CODIGO",-1),Es=e("th",null,"PACKING",-1),fs=e("th",null,"PRECIO DE COMPRA",-1),Rs=e("th",null,"PRECIO DE VENTA",-1),Os=e("th",null,"CANTIDAD",-1),As=e("button",{class:"button is-primary"},"Guardar producto",-1),Ds={key:1,class:"notification is-success"},Us=e("button",{class:"delete"},null,-1),hs=Y(" Producto guardado con exito "),Is=[Us,hs],vs=k({props:{productId:{type:Number,default:-1}},emits:["cancelEdit"],setup(c,{emit:a}){const s=c,t=j(),n=_(),o=_(!1),i=_(),d=_(!1),f=["12 UND","25 UND","50 UND","100 UND"],O=_(!1),l=q({id:0,name:"",brand:"",tags:"",description:"",features:{},image:""}),C=_([]),m=_([]),E=()=>{m.value=[{id:"V"+Date.now(),code:"",packing:"UND",measureUnit:"NIU",priceSale:0,priceBuy:0,stock:0}],f.forEach((N,U)=>{m.value.push({id:"V"+Date.now()+U+1,code:"",packing:N,measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})}),l.name="",l.brand="",l.tags="",l.features={},l.description="",l.image="",a("cancelEdit")};H(async()=>{if(s.productId!==-1){const N=await t.dispatch("fetchPackProducts",{id:s.productId});m.value=N.data.packedProducts,l.name=N.data.product.name,l.id=N.data.product.id}else E()}),z(()=>{E()});const v=()=>{m.value.push({id:"V"+Date.now(),code:"",packing:"",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})},W=N=>{if(m.value.length===1)return;const U=m.value.findIndex(F=>F.id===N);m.value.splice(U,1)},A=()=>(s.productId!==-1?o.value=t.state.products.some(({name:N,productId:U})=>N.toLowerCase()===l.name.toLowerCase()&&U!==l.id):o.value=t.state.products.some(({name:N})=>N.toLowerCase()===l.name.toLowerCase()),o.value),I=async()=>{if(o.value)return;O.value=!1;const N={action:s.productId!==-1?"edit":"add",data:{product:l,packedProducts:[...m.value]}};(await t.dispatch("savePackingProduct",N)).success&&(E(),K())},G=()=>{n.value.select()},K=()=>{d.value=!0,setTimeout(()=>{d.value=!1},2e3)},B=async()=>{const N={action:s.productId!==-1?"edit":"add",data:{product:l,packedProducts:[...m.value]}};if(A())return;if(m.value.some(F=>F.code==="")){O.value=!0;return}(await t.dispatch("savePackingProduct",N)).success&&(E(),K())};return(N,U)=>(S(),g(V,null,[O.value?(S(),g("div",is,[ls,e("div",ps,[e("header",ms,[ds,e("button",{class:"delete","aria-label":"close",onClick:U[0]||(U[0]=F=>O.value=!1)})]),cs,e("footer",_s,[e("button",{onClick:U[1]||(U[1]=F=>I()),class:"button is-success"},"Guradar"),e("button",{onClick:U[2]||(U[2]=F=>O.value=!1),class:"button"},"Cancelar")])])])):y("",!0),e("form",{onSubmit:U[9]||(U[9]=ae(F=>B(),["prevent"])),ref_key:"form",ref:i,class:"box"},[e("div",Cs,[e("label",{class:"label",onClick:U[3]||(U[3]=F=>G())},"Nombre"),e("div",Ps,[b(e("input",{class:Z(["input upper",{"is-danger":o.value}]),onInput:U[4]||(U[4]=F=>A()),ref_key:"fieldName",ref:n,required:"","onUpdate:modelValue":U[5]||(U[5]=F=>p(l).name=F),type:"text",placeholder:"Nombre"},null,34),[[L,p(l).name,void 0,{trim:!0}]]),o.value?(S(),g("span",us,"Ya existe un producto con este nombre")):y("",!0)])]),e("table",Ss,[e("thead",null,[e("tr",null,[gs,Es,fs,Rs,Os,e("th",null,[e("button",{type:"button",class:"button is-info",onClick:U[6]||(U[6]=F=>v())},"+")])])]),e("tbody",null,[(S(!0),g(V,null,X(m.value,(F,ee)=>(S(),oe(ts,{key:F.id,product:F,onQuit:U[7]||(U[7]=J=>W(J)),ref_for:!0,ref:J=>{J&&(C.value[ee]=J)}},null,8,["product"]))),128))])]),As,s.productId!==-1?(S(),g("button",{key:0,type:"button",onClick:U[8]||(U[8]=F=>a("cancelEdit")),class:"button is-danger"},"Cancelar")):y("",!0)],544),d.value?(S(),g("div",Ds,Is)):y("",!0)],64))}}),bs={class:"columns"},Ms={class:"column is-6"},Ts={class:"column is-6"},Ls=k({setup(c){const a=_(-1),s=n=>{a.value=n},t=()=>{a.value=-1};return(n,o)=>(S(),g("div",bs,[e("div",Ms,[R(vs,{"product-id":a.value,onCancelEdit:o[0]||(o[0]=i=>t())},null,8,["product-id"])]),e("div",Ts,[R(Qe,{onEditProduct:o[1]||(o[1]=i=>s(i))})])]))}}),ys={class:"menu"},Fs={class:"menu-list"},Ns=["onClick"],_e=k({emits:["itemSelected"],setup(c,{emit:a}){const s=j(),t=_([]),n=_([]),o=_("");z(async()=>{await s.dispatch("fetchProducts"),t.value=s.state.products});const i=()=>{if(o.value===""){n.value=[];return}const d=o.value.toLowerCase();n.value=t.value.filter(({name:f,code:O})=>f.toLowerCase().includes(d)||O.toString().toLowerCase().includes(d))};return(d,f)=>(S(),g("div",ys,[b(e("input",{class:"input upper",type:"search",onInput:f[0]||(f[0]=O=>i()),"onUpdate:modelValue":f[1]||(f[1]=O=>o.value=O),placeholder:"Buscar producto"},null,544),[[L,o.value,void 0,{trim:!0}]]),e("ul",Fs,[(S(!0),g(V,null,X(n.value,O=>(S(),g("li",{onClick:l=>a("itemSelected",O),key:O.id},D(O.name),9,Ns))),128))])]))}}),ws={class:"control",style:{width:"6.5rem"}},ks={class:"control"},xs=k({props:{product:Object},emits:["quit"],setup(c,{emit:a}){const s=c,t=q(s.product);return H(()=>{t.quantity=t.quantity<1?1:t.quantity,t.mount=t.quantity*t.priceSale}),(n,o)=>(S(),g("tr",null,[e("td",null,D(p(t).code),1),e("td",null,D(p(t).name),1),e("td",null,"S/. "+D(p(t).priceSale),1),e("td",ws,[b(e("input",{class:"input is-upper",type:"number",min:"1",onClick:o[0]||(o[0]=i=>i.target.select()),placeholder:"Cantidad","onUpdate:modelValue":o[1]||(o[1]=i=>p(t).quantity=i)},null,512),[[L,p(t).quantity]])]),e("td",null,"S/. "+D(p(t).mount),1),e("td",ks,[e("button",{type:"button",class:"button is-danger",onClick:o[2]||(o[2]=i=>a("quit",s.product.id))},[R(p(x),null,{default:w(()=>[R(p(de))]),_:1})])])]))}}),Ws={key:0,class:"modal is-active"},Vs=e("div",{class:"modal-background"},null,-1),Gs={class:"modal-card"},js={class:"modal-card-head"},$s=e("p",{class:"modal-card-title"},"Agregar producto manual",-1),Hs={class:"modal-card-body"},Bs={class:"field is-horizontal"},Ks=e("div",{class:"field-label is-normal"},[e("label",{class:"label"},"Nombre del producto")],-1),Js={class:"field-body"},Xs={class:"field"},qs={class:"control"},zs={class:"field is-horizontal"},Qs=e("div",{class:"field-label is-normal"},[e("label",{class:"label"},"Precio")],-1),Ys={class:"field-body"},Zs={class:"field"},eo={class:"control",style:{width:"7rem"}},so={class:"modal-card-foot"},oo=k({props:{show:Boolean},emits:["addProduct","hide"],setup(c,{emit:a}){const s=c,t=_(s.show),n=q({id:"MP"+Date.now(),code:"MP"+Date.now(),name:"",priceSale:0,quantity:1}),o=()=>{a("addProduct",n),n.id="MP"+Date.now(),n.code="MP"+Date.now(),n.name="",n.priceSale=0,n.quantity=1,a("hide")};return H(()=>{t.value=s.show}),(i,d)=>t.value?(S(),g("div",Ws,[Vs,e("div",Gs,[e("header",js,[$s,e("button",{class:"delete","aria-label":"close",onClick:d[0]||(d[0]=f=>a("hide"))})]),e("section",Hs,[e("div",Bs,[Ks,e("div",Js,[e("div",Xs,[e("p",qs,[b(e("input",{class:"input is-upper",placeholder:"NOMBRE","onUpdate:modelValue":d[1]||(d[1]=f=>p(n).name=f)},null,512),[[L,p(n).name]])])])])]),e("div",zs,[Qs,e("div",Ys,[e("div",Zs,[e("p",eo,[b(e("input",{class:"input is-upper",placeholder:"Precio",min:"0.1",step:"0.01","onUpdate:modelValue":d[2]||(d[2]=f=>p(n).priceSale=f)},null,512),[[L,p(n).priceSale]])])])])])]),e("footer",so,[e("button",{onClick:d[3]||(d[3]=f=>o()),class:"button is-success"},"Agregar producto"),e("button",{onClick:d[4]||(d[4]=f=>a("hide")),class:"button"},"Cancelar")])])])):y("",!0)}}),no={key:0,class:"modal is-active"},ao=e("div",{class:"modal-background"},null,-1),ro={class:"modal-card"},to={class:"modal-card-head"},io=e("p",{class:"modal-card-title"},"Nueva Venta",-1),lo={class:"modal-card-body"},po={style:{display:"none"}},mo={key:0,class:"column"},co={class:"field is-horizontal"},_o={class:"field-body"},Co={class:"field has-addons"},Po={class:"control"},uo={class:"select"},So=["disabled"],go=["value"],Eo={class:"control"},fo=["placeholder"],Ro={class:"field"},Oo={class:"control is-expanded"},Ao=["disabled"],Do={key:0,class:"field"},Uo={class:"control is-expanded"},ho={key:1,class:"notification is-danger mt-5"},Io={class:"modal-card-foot"},vo=["disabled"],bo=k({props:{show:Boolean,client:Object,loading:{type:Boolean,default:!1}},emits:["save","hide"],setup(c,{emit:a}){const s=c,t=j(),n=_(s.show),o=_(s.loading),i=_("ticket"),d=_(!1),f=_(""),O=[{code:1,name:"DNI",length:8},{code:4,name:"CARNET DE EXTRANGERIA",length:12},{code:6,name:"RUC",length:11},{code:7,name:"PASAPORTE",length:12}],l=q(s.client);H(()=>{n.value=s.show}),H(()=>{o.value=s.loading}),H(()=>{l.documentType=1,l.document="",l.name="",l.email="",i.value==="factura"&&(l.documentType=6,l.document="",l.name="")});const C=Q(()=>O.find(W=>W.code===l.documentType)),m=async()=>{if(!(C.value.code!==1&&C.value.code!==6)&&(""+l.document).length===C.value.length){const W=await t.dispatch("getInfoDoc",{typeDoc:C.value.code,document:l.document});l.name=W.nombre}};H(()=>{d.value&&setTimeout(()=>{d.value=!1},2500)});const E=()=>{if(i.value!=="ticket"){if(l.document===""||l.name===""){f.value="El documento o el nombre no puede ser vacio",d.value=!0;return}if(i.value==="factura"&&l.email===""){f.value="Se nesesita un email para emitir factura",d.value=!0;return}}a("save",i.value)},v=()=>{l.document=l.document.replace(/\D/,""),l.document.length>C.value.length&&(l.document=l.document.slice(0,C.value.length))};return(W,A)=>n.value?(S(),g("div",no,[ao,e("div",ro,[e("header",to,[io,e("button",{class:"delete","aria-label":"close",onClick:A[0]||(A[0]=I=>a("hide"))})]),e("section",lo,[e("label",{for:"ticket",class:Z(["button",{"is-primary":i.value==="ticket"}])},"Ticket",2),e("label",{for:"boleta",class:Z(["button",{"is-primary":i.value==="boleta"}])},"Boleta",2),e("label",{for:"factura",class:Z(["button",{"is-primary":i.value==="factura"}])},"Factura",2),e("div",po,[b(e("input",{type:"radio","onUpdate:modelValue":A[1]||(A[1]=I=>i.value=I),id:"boleta",value:"boleta"},null,512),[[re,i.value]]),b(e("input",{type:"radio","onUpdate:modelValue":A[2]||(A[2]=I=>i.value=I),id:"factura",value:"factura"},null,512),[[re,i.value]]),b(e("input",{type:"radio","onUpdate:modelValue":A[3]||(A[3]=I=>i.value=I),id:"ticket",value:"ticket"},null,512),[[re,i.value]])]),i.value!=="ticket"?(S(),g("div",mo,[e("div",co,[e("div",_o,[e("div",Co,[e("p",Po,[e("span",uo,[b(e("select",{"onUpdate:modelValue":A[4]||(A[4]=I=>p(l).documentType=I),disabled:i.value==="factura"},[(S(),g(V,null,X(O,I=>e("option",{key:I.code,value:I.code},D(I.name),9,go)),64))],8,So),[[ce,p(l).documentType]])])]),e("p",Eo,[b(e("input",{class:"input is-upper",placeholder:p(C).name,onInput:A[5]||(A[5]=I=>(v(),m())),"onUpdate:modelValue":A[6]||(A[6]=I=>p(l).document=I)},null,40,fo),[[L,p(l).document]])])])])]),e("div",Ro,[e("p",Oo,[b(e("input",{class:"input is-upper",placeholder:"nombre",type:"text","onUpdate:modelValue":A[7]||(A[7]=I=>p(l).name=I),disabled:p(l).documentType===6||p(l).documentType===1},null,8,Ao),[[L,p(l).name]])])]),i.value==="factura"?(S(),g("div",Do,[e("p",Uo,[b(e("input",{class:"input",placeholder:"Email",type:"text","onUpdate:modelValue":A[8]||(A[8]=I=>p(l).email=I)},null,512),[[L,p(l).email]])])])):y("",!0)])):y("",!0),d.value?(S(),g("div",ho,[e("button",{onClick:A[9]||(A[9]=I=>d.value=!1),class:"delete"}),Y(" "+D(f.value),1)])):y("",!0)]),e("footer",Io,[e("button",{disabled:o.value,onClick:A[10]||(A[10]=I=>E()),class:"button is-success"},"Imprimir "+D(i.value),9,vo),e("button",{onClick:A[11]||(A[11]=I=>a("hide")),class:"button"},"Cancelar")])])])):y("",!0)}}),Mo={class:"columns"},To={class:"column is-4"},Lo={class:"field"},yo={class:"label"},Fo={class:"control"},No=["disabled"],wo={class:"field"},ko={class:"field"},xo={class:"column is-8"},Wo={class:"table is-bordered is-striped is-fullwidth"},Vo=e("thead",null,[e("tr",null,[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto"),e("th")])],-1),Go=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),jo=e("th",null,null,-1),$o=e("div",null,null,-1),Ho=["disabled"],Bo={key:0,class:"notification is-danger mt-5"},Ko={style:{display:"none"}},Jo=["srcdoc"],Xo=k({setup(c){const a=j(),s=_(""),t=_(),n=_(!1),o=_([]),i=_(""),d=_(!1),f=_(!1),O=_(!1),l=_(!1),C=_(""),m=q({documentType:1,document:"0",name:"",email:""}),E=Q(()=>`
  <html>
  <head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300&display=swap" rel="stylesheet">
   <style>
  pre{
    font-family: 'Roboto Mono', monospace;
    font-weight: bold;
    padding:1rem;
    width:460px
    
  }
  </style></head>
  <body>
 
  <pre >
      ${W.value}
  </pre>
  </body>
  </html>
  `),v=P=>{if(P<=0)return"";let r="";for(let u=0;u<P;u++)r+=" ";return r},W=Q(()=>`
            INVERSIONES VILVER E.I.R.L
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba   

    BOLETA DE VENTA ELECTRONICA 0000-0000000

Fecha de emision:2006-04-09
ID Venta: 0000546-5s654-sds645-sds65

DNI Cliente:${m.document}
Nombre Cliente:${m.name}
${i.value}
                 Subtotal:           S/${Math.round((B.value*(100/118)+Number.EPSILON)*10)/10}
                 IGV(18%):           S/${Math.round((B.value*(18/118)+Number.EPSILON)*10)/10}
                 Total:              S/${B.value}
------------------------------------------------  `),A=P=>{let r="";for(let u=0;u<8-P.toString().length;u++)r+="0";return r+P.toString()},I=()=>{m.documentType=1,m.document="0",m.name="",m.email="",o.value=[]},G=(P,r,u,h,M=[])=>{let $=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return r==="ticket"?$+=`
              TICKET DE VENTA ELECTRONICO 
      `:$+=`
         ${r.toLocaleUpperCase()} ELECTRONICA ${M.serie}-${A(M.correlative)}
      `,$+=`
Fecha de emision:${r!=="ticket"?M.dateTime:u.dateTime}
ID Venta: 00000${u.id}
  `,r!=="ticket"&&($+=`
CLIENTE:
Documento: ${h.document}
Nombre: ${h.name}
`),$+=K(o.value),$+=`
                OP.GRAVADAS:        S/ ${Math.round((u.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((u.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${u.total}
------------------------------------------------ 
${P}

************************************************
            !GRACIAS POR SU COMPRA!
`,$},K=P=>{let r="",u="",h=`
------------------------------------------------
`;return h+=`PRODUCTO                 CANT P.UNI   MONTO
`,h+=`------------------------------------------------
`,P.forEach(M=>{r=M.name.slice(0,24)+v(24-M.name.length),r+="  ",r+=""+M.quantity+v(3-(""+M.quantity).length),r+=" S/",r+=""+M.priceSale+v(6-(""+M.priceSale).length),r+=" S/",r+=""+M.mount+v(7-(""+M.mount).length),h+=`${r}
`,M.name.length>24&&(u=M.name.slice(24,48),h+=`${u}
`),M.name.length>48&&(u=M.name.length>72?M.name.slice(48,72)+"...":M.name.slice(48),h+=`${u}
`)}),h+=`------------------------------------------------
`,h},B=Q(()=>o.value.reduce((P,r)=>P+r.mount,0)),N=P=>a.state.products.find(({code:u})=>u.toString()===s.value),U=({id:P,code:r,name:u,priceSale:h},M=1)=>{const $={id:P,code:r,name:u,priceSale:h,quantity:M,mount:h*1};if(o.value.every(se=>se.id!==P))o.value.push($);else{const se=o.value.findIndex(Se=>Se.id===P);o.value[se].quantity+=1,o.value[se].mount=$.priceSale*o.value[se].quantity}o.value.length===0&&o.value.push($),s.value=""},F=P=>{const r=o.value.findIndex(u=>u.id===P);o.value.splice(r,1)};z(async()=>{try{await a.dispatch("fetchProducts");const r=await(await fetch("http://localhost:5050/devices")).json()}catch{l.value=!0,C.value="No se encuentra el controlador de la impresora por favor inicie el controlador y configure la impresora"}});const ee=()=>{const P=s.value;setTimeout(()=>{if(s.value===P){const r=N(s.value);r&&U(r),s.value=""}},100)},J=async P=>{f.value=!0;const r=await a.dispatch("saveSale",{soldProducts:o.value,client:m,typeProof:P});let u="";P!=="ticket"?r.proof.status!=="ACEPTADA"?(C.value=r.proof.description,l.value=!0,setTimeout(()=>{l.value=!1},3e3)):u=G(r.legend,P,r.sale,r.client,r.proof.data):u=G(r.legend,P,r.sale,r.client,[]),console.log(u);try{u=u.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),await a.dispatch("printerTicket",{text:u}),f.value=!1}catch{f.value=!1,C.value="No se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",l.value=!0,setTimeout(()=>{l.value=!1},1e4)}finally{I(),d.value=!1}},ne=()=>{s.value="",t.value.focus()},T=()=>{if(o.value.some(P=>P.priceSale===0)){C.value="Los precios no pueden ser cero",l.value=!0,setTimeout(()=>{l.value=!1},3e3);return}d.value=!0};return(P,r)=>(S(),g(V,null,[R(bo,{show:d.value,onHide:r[0]||(r[0]=u=>d.value=!1),client:p(m),onSave:r[1]||(r[1]=u=>J(u)),loading:f.value},null,8,["show","client","loading"]),R(oo,{show:O.value,onHide:r[2]||(r[2]=u=>O.value=!1),onAddProduct:r[3]||(r[3]=u=>U(u))},null,8,["show"]),e("div",Mo,[e("div",To,[b(e("input",{required:"",autocomplete:"off",onInput:r[4]||(r[4]=u=>ee()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:r[5]||(r[5]=u=>u.target.blur()),onBlur:r[6]||(r[6]=u=>n.value=!1),onFocus:r[7]||(r[7]=u=>n.value=!0),ref_key:"fieldCode",ref:t,"onUpdate:modelValue":r[8]||(r[8]=u=>s.value=u)},null,544),[[L,s.value]]),e("div",Lo,[e("label",yo,"Codigo "+D(": "+s.value),1),e("div",Fo,[e("button",{tabindex:"-1",class:"button is-success",disabled:n.value,type:"button",onClick:r[9]||(r[9]=u=>ne())},D(n.value?"Escaneando codigos...":"Escanear codigos"),9,No)])]),e("div",wo,[e("input",{type:"button",class:"button is-info",onClick:r[10]||(r[10]=u=>O.value=!0),value:"Agregar producto manualmente"})]),e("div",ko,[R(_e,{onItemSelected:r[11]||(r[11]=u=>U(u))})])]),e("div",xo,[e("table",Wo,[Vo,e("tbody",null,[(S(!0),g(V,null,X(o.value,u=>(S(),oe(xs,{key:u.id,product:u,onQuit:r[12]||(r[12]=h=>F(h))},null,8,["product"]))),128)),e("tr",null,[Go,e("th",null,"S/. "+D(p(B)),1),jo])])]),$o,e("button",{disabled:o.value.length===0,onClick:r[13]||(r[13]=u=>T()),class:"button is-primary"},"Realizar venta",8,Ho),l.value?(S(),g("div",Bo,[e("button",{onClick:r[14]||(r[14]=u=>l.value=!1),class:"delete"}),Y(" "+D(C.value),1)])):y("",!0)]),e("div",Ko,[e("iframe",{style:{width:"550px",height:"900px",padding:"0"},name:"page-printer",srcdoc:p(E)},null,8,Jo)])])],64))}}),qo={key:0,class:"modal is-active",style:{"z-index":"9999"}},zo=e("div",{class:"modal-background"},null,-1),Qo={class:"modal-card",style:{width:"35%",height:"35%"}},Yo={class:"modal-card-body has-background-danger-light has-text-danger"},Zo={class:"field is-horizontal"},en=e("div",{class:"field-label is-normal"},[e("label",{class:"label"},"Motivo de Baja")],-1),sn={class:"field-body"},on={class:"field"},nn={class:"control"},an=["disabled"],rn={key:1,class:"modal is-active"},tn=e("div",{class:"modal-background"},null,-1),ln={class:"modal-card",style:{width:"50%",height:"70%"}},pn={class:"modal-card-head"},mn=e("p",{class:"modal-card-title"},"Detalles de la venta",-1),dn={class:"modal-card-body"},cn={key:0,class:"notification is-danger"},_n={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Cn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Comprobante")])],-1),Pn={key:0,style:{"padding-top":"2px"}},un=e("th",null,"Tipo",-1),Sn=e("th",null,"Serie-Correlativo",-1),gn=e("th",null,"Fecha y hora de emision",-1),En={key:1,style:{"padding-top":"2px"}},fn=e("tr",null,[e("th",null,"SIN COMPROBANTE")],-1),Rn=[fn],On={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},An=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"2",style:{"text-align":"center"}},"Cliente")])],-1),Dn={style:{"padding-top":"2px"}},Un=e("th",null,"Documento",-1),hn=e("th",null,"Nombre",-1),In={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},vn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Productos Vendidos")]),e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto")])],-1),bn={style:{"padding-top":"2px"}},Mn=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),Tn={class:"modal-card-foot"},Ln=["disabled"],yn=k({props:{show:Boolean,saleId:Number},emits:["save","hide"],setup(c,{emit:a}){const s=c,t=j(),n=_(s.show),o=_(!1),i=_("ticket"),d=_(!1),f=_(""),O=_(0),l=_({}),C=_({}),m=_({}),E=_(""),v=_(!1),W=_(!1),A=_(!1),I=_(!0),G=_(""),K=_(s.saleId),B=_([]);H(()=>{n.value=s.show}),H(async()=>{if(s.saleId===0)return;v.value=!1,K.value=s.saleId;const T=await t.dispatch("fetchSaleDetail",{id:K.value});console.log(T),v.value=!0,B.value=T.data.soldProducts,O.value=T.data.sale.total,l.value=T.data.client,C.value=T.data.proof,E.value=T.data.legend,m.value=T.data.sale,I.value=C.value.enable===1,i.value=C.value===!1?"ticket":C.value.serie.startsWith("B")?"boleta":"factura"}),H(()=>{d.value&&setTimeout(()=>{d.value=!1},2500)});const N=(T,P,r,u,h=[])=>{let M=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return P==="ticket"?M+=`
              TICKET DE VENTA ELECTRONICO 
      `:M+=`
         ${P.toLocaleUpperCase()} ELECTRONICA ${h.serie}-${U(h.correlative)}
      `,M+=`
Fecha de emision:${P!=="ticket"?h.dateTime:r.dateTime}
ID Venta: 00000${r.id}
  `,P!=="ticket"&&(M+=`
CLIENTE:
Documento: ${u.document}
Nombre: ${u.name}
`),M+=ee(B.value),M+=`
                OP.GRAVADAS:        S/ ${Math.round((r.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((r.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${r.total}
------------------------------------------------ 
${T}

************************************************
            !GRACIAS POR SU COMPRA!
`,M},U=T=>{let P="";for(let r=0;r<8-T.toString().length;r++)P+="0";return P+T.toString()},F=T=>{if(T<=0)return"";let P="";for(let r=0;r<T;r++)P+=" ";return P},ee=T=>{let P="",r="",u=`
------------------------------------------------
`;return u+=`PRODUCTO                 CANT P.UNI   MONTO
`,u+=`------------------------------------------------
`,T.forEach(h=>{P=h.name.slice(0,24)+F(24-h.name.length),P+="  ",P+=""+h.quantity+F(3-(""+h.quantity).length),P+=" S/",P+=""+h.price+F(6-(""+h.price).length),P+=" S/",P+=""+h.mount+F(7-(""+h.mount).length),u+=`${P}
`,h.name.length>24&&(r=h.name.slice(24,48),u+=`${r}
`),h.name.length>48&&(r=h.name.length>72?h.name.slice(48,72)+"...":h.name.slice(48),u+=`${r}
`)}),u+=`------------------------------------------------
`,u},J=async()=>{W.value=!0;let T=N(E.value,i.value,m.value,l.value,C.value);try{T=T.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),console.log(T),await t.dispatch("printerTicket",{text:T}),W.value=!1}catch{W.value=!1,f.value="No se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",d.value=!0,setTimeout(()=>{d.value=!1},1e4)}},ne=async()=>{A.value=!0;try{await t.dispatch("darBaja",{proofId:C.value.id,typeProof:i.value,motivoBaja:G.value}),A.value=!1,f.value="Comprobante Dado de baja con exito",d.value=!0,I.value=!1,o.value=!1,setTimeout(()=>{d.value=!1},1e4)}catch(T){A.value=!1,f.value=T,d.value=!0,I.value=!0,setTimeout(()=>{d.value=!1},1e4)}};return(T,P)=>(S(),g(V,null,[o.value?(S(),g("div",qo,[zo,e("div",Qo,[e("section",Yo,[e("div",Zo,[en,e("div",sn,[e("div",on,[e("p",nn,[b(e("input",{class:"input is-upper",placeholder:"ejemplo: ruc equibocado","onUpdate:modelValue":P[0]||(P[0]=r=>G.value=r)},null,512),[[L,G.value]])])])])]),Y(" \xBF\xBF Esta seguro de dar de baja esta "+D(i.value)+"? Una vez que se dea de baja ya no se podra recuperar ",1),e("button",{class:"button",onClick:P[1]||(P[1]=r=>o.value=!1)},"cancel"),e("button",{disabled:A.value,class:"button is-danger",onClick:P[2]||(P[2]=r=>ne())},"Dar de baja",8,an)])])])):y("",!0),n.value&&v.value?(S(),g("div",rn,[tn,e("div",ln,[e("header",pn,[mn,e("button",{class:"delete","aria-label":"close",onClick:P[3]||(P[3]=r=>a("hide"))})]),e("section",dn,[d.value?(S(),g("div",cn,[e("button",{onClick:P[4]||(P[4]=r=>d.value=!1),class:"delete"}),Y(" "+D(f.value),1)])):y("",!0),e("table",_n,[Cn,C.value!==!1?(S(),g("tbody",Pn,[e("tr",null,[un,e("td",null,D(i.value.toLocaleUpperCase()),1)]),e("tr",null,[Sn,e("td",null,D(C.value.serie)+"-"+D(U(C.value.correlative)),1)]),e("tr",null,[gn,e("td",null,D(C.value.dateTime),1)])])):y("",!0),C.value===!1?(S(),g("tbody",En,Rn)):y("",!0)]),e("table",On,[An,e("tbody",Dn,[e("tr",null,[Un,e("td",null,D(l.value.document),1)]),e("tr",null,[hn,e("td",null,D(l.value.name),1)])])]),e("table",In,[vn,e("tbody",bn,[(S(!0),g(V,null,X(B.value,r=>(S(),g("tr",{key:r.id},[e("td",null,D(r.code),1),e("td",null,D(r.name),1),e("td",null,"S/ "+D(r.price),1),e("td",null,D(r.quantity),1),e("td",null,"S/ "+D(r.mount),1)]))),128)),e("tr",null,[Mn,e("th",null,"S/. "+D(O.value),1)])])])]),e("footer",Tn,[e("button",{disabled:W.value,onClick:P[5]||(P[5]=r=>J()),class:"button is-success"},"Imprimir otra vez",8,Ln),e("button",{onClick:P[6]||(P[6]=r=>a("hide")),class:"button"},"Cancelar")])])])):y("",!0)],64))}});const Fn={class:"columns"},Nn={class:"column is-11"},wn={class:"control has-icons-left"},kn={class:"column is-1"},xn={class:"h-100 oy-scroll"},Wn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Vn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"ID"),e("th",null,"Cliente"),e("th",null,"Documento Cliente"),e("th",null,"Fecha emision"),e("th",null,"Importe Total"),e("th")])],-1),Gn={style:{"padding-top":"2px"}},jn=["onClick"],Ce=k({setup(c){const a=j(),s=_([]),t=_([]),n=_(""),o=_(!1),i=_(0);z(async()=>{const O=await a.dispatch("fetchSales");s.value=O.data.reverse(),t.value=s.value});const d=()=>{const O=n.value.toLowerCase();t.value=s.value.filter(l=>l.clientName.toLowerCase().includes(O)||l.clientDocument.toString().toLowerCase().includes(O))},f=async()=>{const O=await a.dispatch("fetchSales");s.value=O.data.reverse(),t.value=s.value};return(O,l)=>(S(),g(V,null,[R(yn,{saleId:i.value,show:o.value,onHide:l[0]||(l[0]=C=>o.value=!1)},null,8,["saleId","show"]),e("div",Fn,[e("div",Nn,[e("div",wn,[b(e("input",{class:"input",type:"search",onInput:l[1]||(l[1]=C=>d()),"onUpdate:modelValue":l[2]||(l[2]=C=>n.value=C),placeholder:"Buscar por nombre o documento"},null,544),[[L,n.value,void 0,{trim:!0}]]),R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(le))]),_:1})])]),e("div",kn,[e("button",{class:"button is-primary",onClick:l[3]||(l[3]=C=>f())},[R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(pe))]),_:1})])])]),e("div",xn,[e("table",Wn,[Vn,e("tbody",Gn,[(S(!0),g(V,null,X(t.value,C=>(S(),g("tr",{key:C.id},[e("td",null,D(C.id),1),e("td",null,D(C.clientName),1),e("td",null,D(C.clientDocument),1),e("td",null,D(C.dateTime),1),e("td",null,D(C.total),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:m=>(i.value=C.id,o.value=!0)},[R(p(x),null,{default:w(()=>[R(p(me))]),_:1})],8,jn)])]))),128))])])])],64))}}),$n=k({setup(c){const a=_("new");return(s,t)=>(S(),g("div",null,[e("button",{class:"button is-info",onClick:t[0]||(t[0]=n=>a.value="new")},"Nueva Venta"),e("button",{class:"button is-info",onClick:t[1]||(t[1]=n=>a.value="list")},"Lista de ventas"),a.value==="new"?(S(),oe(Xo,{key:0})):y("",!0),a.value==="list"?(S(),oe(Ce,{key:1})):y("",!0)]))}}),Hn={class:"columns"},Bn={class:"column"},Kn=["value"],Jn=k({setup(c){const a=_([]),s=_("");z(async()=>{const o=await(await fetch("http://localhost:5050/devices")).json();a.value=o,s.value=localStorage.printer});const t=()=>{localStorage.printer=s.value};return(n,o)=>(S(),g("div",Hn,[e("div",Bn,[b(e("select",{"onUpdate:modelValue":o[0]||(o[0]=i=>s.value=i)},[(S(!0),g(V,null,X(a.value,i=>(S(),g("option",{key:i.vendor_id,value:i.product_id+"/"+i.vendor_id},D(i.vendor_id)+":"+D(i.product_id)+" "+D(i.name),9,Kn))),128))],512),[[ce,s.value]]),e("button",{class:"button is-primary",onClick:o[1]||(o[1]=i=>t())},"Guardar")])]))}}),Xn=["onSubmit"],qn={class:"field"},zn=e("label",{class:"label"},"Usuario",-1),Qn={class:"control has-icons-left"},Yn={class:"field"},Zn=e("label",{class:"label"},"Contrase\xF1a",-1),ea={class:"control has-icons-left"},sa={class:"field"},oa={class:"control is-expanded"},na=e("button",{class:"button is-primary is-medium input mt-2"},"Iniciar Sesion",-1),aa={key:0,class:"help is-danger"},ra=k({setup(c){const a=j(),s=_(!1),t=De(),n=q({userName:"",password:""}),o=async()=>{const i=await a.dispatch("userLogin",{credentials:n});if(s.value=!i.success,i.success){const d=await a.dispatch("fetchProducts");console.log(d),t.replace("products")}console.log(i.message)};return(i,d)=>(S(),g("form",{onSubmit:ae(o,["prevent"]),class:"box column is-4 is-offset-4"},[e("div",qn,[zn,e("div",Qn,[b(e("input",{class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":d[0]||(d[0]=f=>p(n).userName=f),placeholder:"Nombre de usuario"},null,512),[[L,p(n).userName]]),R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(Ue))]),_:1})])]),e("div",Yn,[Zn,e("div",ea,[b(e("input",{class:"input is-medium",required:"","onUpdate:modelValue":d[1]||(d[1]=f=>p(n).password=f),type:"password",placeholder:"************"},null,512),[[L,p(n).password]]),R(p(x),{class:"icon is-large is-left"},{default:w(()=>[R(p(he))]),_:1})])]),e("div",sa,[e("p",oa,[na,s.value?(S(),g("span",aa,"Error al iniciar session")):y("",!0)])])],40,Xn))}}),ta=["onSubmit"],ia={class:"field"},la={class:"control"},pa={key:0,class:"help is-danger"},ma={class:"field"},da=e("label",{class:"label"},"DNI",-1),ca={class:"control"},_a={class:"field"},Ca=e("label",{class:"label"},"Nombres y Apellidos",-1),Pa={class:"control"},ua={class:"field"},Sa=e("label",{class:"label"},"Contrase\xF1a",-1),ga={class:"control"},Ea={key:0,class:"help is-danger"},fa={class:"field"},Ra=e("label",{class:"label"},"Repetir Contrase\xF1a",-1),Oa={class:"control"},Aa={key:0,class:"help is-danger"},Da={class:"field"},Ua=e("label",{class:"label"},"Celular",-1),ha={class:"control"},Ia={class:"field"},va=e("label",{class:"label"},"Email",-1),ba={class:"control"},Ma=e("button",{class:"button is-primary"},"Registrar usuario",-1),Ta=k({setup(c){const a=_(),s=j(),t=_(!1),n=_([]),o=q({userName:"",dni:"",fullName:"",email:"",password:"",roleId:"1",mobile:""}),i=_(""),d=_(!1),f=()=>{o.password!==i.value?d.value=!0:d.value=!1};z(async()=>{const l=await s.dispatch("fetchRoles");n.value=l.data});const O=async()=>{if(o.password!==i.value){d.value=!0;return}const l=await s.dispatch("userSignup",{user:o});t.value=l.success,l.success&&(a.value.reset(),alert(`usuario registrado 
 UserName: `+l.data.userName)),console.log(l.message)};return(l,C)=>(S(),g("form",{onSubmit:ae(O,["prevent"]),ref_key:"form",ref:a},[e("div",ia,[e("div",la,[t.value?y("",!0):(S(),g("span",pa,"Ya existe un producto con este codigo"))])]),e("div",ma,[da,e("div",ca,[b(e("input",{class:"input",ref:"fieldName","onUpdate:modelValue":C[0]||(C[0]=m=>p(o).dni=m),type:"number",placeholder:"documento de identidad"},null,512),[[L,p(o).dni]])])]),e("div",_a,[Ca,e("div",Pa,[b(e("input",{class:"input",ref:"fieldName",required:"","onUpdate:modelValue":C[1]||(C[1]=m=>p(o).fullName=m),type:"text",placeholder:"Nombres y apellidos"},null,512),[[L,p(o).fullName]])])]),e("div",ua,[Sa,e("div",ga,[b(e("input",{class:Z(["input",{"is-danger":d.value}]),required:"",step:"0.1","onUpdate:modelValue":C[2]||(C[2]=m=>p(o).password=m),type:"password",placeholder:"Contrase\xF1a"},null,2),[[L,p(o).password]]),d.value?(S(),g("span",Ea,"Las contrase\xF1as deven ser iguales")):y("",!0)])]),e("div",fa,[Ra,e("div",Oa,[b(e("input",{class:Z(["input",{"is-danger":d.value}]),onBlur:C[3]||(C[3]=m=>f()),required:"",step:"0.1","onUpdate:modelValue":C[4]||(C[4]=m=>i.value=m),type:"password",placeholder:"Vuelva a escribir la contrase\xF1a"},null,34),[[L,i.value]]),d.value?(S(),g("span",Aa,"Las contrase\xF1as deven ser iguales")):y("",!0)])]),e("div",Da,[Ua,e("div",ha,[b(e("input",{class:"input",step:"0.1","onUpdate:modelValue":C[5]||(C[5]=m=>p(o).mobile=m),type:"number",placeholder:"Numero de celular"},null,512),[[L,p(o).mobile]])])]),e("div",Ia,[va,e("div",ba,[b(e("input",{class:"input",ref:"fieldName","onUpdate:modelValue":C[6]||(C[6]=m=>p(o).email=m),type:"text",placeholder:"Correo electronico"},null,512),[[L,p(o).email]])])]),Ma],40,ta))}}),La={class:"menu"},ya=["srcdoc"],Fa=k({props:{product:Object,stock:Number},setup(c){const a=c,s=_(),t=_(),n=_(""),o=async(i,d)=>{const f=t.value.src;let O=`
   <html>
  <head>
  <style>
  *{

  }
  </style>
   </head>
   <body style="width:108mm;padding:0;margin:0">
   <div style="margin:0 2.5mm;padding:0;width:103mm;display:grid;grid-template-columns: repeat(3, 1fr);font-family:arial;font-weight: bold;justify-content:center ;height:21mm ;page-break-after: always">`;for(let l=0;l<d;l++)O+=`<div style="display: flex;flex-direction: column;align-items: center;font-size: 10px;widt:30mm;max-width:30mm;border:1px solid black;padding:2px;text-align:center;height:20mm;page-break-after: always">
    <span style="margin: 0;padding: 0;z-index: 1;word-wrap:break-word;word-break: break-all;">${i.name}</span>
    <img style="width:29mm" src="${f}"/>
    <span style="margin: 0;padding: 0;z-index: 1">${i.code}</span>
    </div>`;O+=`</div> </body>
  </html>`,n.value=O};return H(async()=>{Ie("#barcode",a.product.code,{displayValue:!1,height:20,width:1,margin:0}),await o(a.product,a.stock)}),(i,d)=>(S(),g("div",La,[e("iframe",{id:"printf",name:"printf",ref_key:"pdf",ref:s,style:{width:"1000px",height:"900px",border:"1x solid red"},srcdoc:n.value},null,8,ya),e("img",{ref_key:"img",ref:t,id:"barcode",style:{display:"none"}},null,512)]))}}),Na={class:"columns"},wa={class:"column is-4"},ka={class:"field"},xa=e("label",{class:"label"},"Usuario",-1),Wa={class:"control"},Va=k({setup(c){const a=_({}),s=_(9),t=()=>{const o=window;o.frames.printf.focus(),o.frames.printf.print()},n=o=>{a.value=o,console.log(o.code)};return(o,i)=>(S(),g("div",Na,[e("form",wa,[e("div",ka,[xa,e("div",Wa,[b(e("input",{type:"number",class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":i[0]||(i[0]=d=>s.value=d),placeholder:"Cantidad"},null,512),[[L,s.value,void 0,{number:!0}]])])]),e("button",{type:"button",onClick:i[1]||(i[1]=d=>t()),class:"button is-primary is-medium"},"Imprimir Codigos"),R(_e,{onItemSelected:i[2]||(i[2]=d=>n(d))})]),R(Fa,{class:"column is-8",product:a.value,stock:s.value},null,8,["product","stock"])]))}}),Ga={class:"columns"},ja={class:"column is-4"},$a=k({setup(c){const a=j(),s=()=>{const t=a.dispatch("sendSummaries");console.log(t)};return(t,n)=>(S(),g("div",Ga,[e("form",ja,[e("button",{type:"button",onClick:n[0]||(n[0]=o=>s()),class:"button is-primary is-medium"},"Generar y envia resumenes")])]))}}),Ha=[{path:"/login",name:"login",component:ra},{path:"/sales",name:"sales",component:$n},{path:"/listSales",name:"listSales",component:Ce},{path:"/printers",name:"printers",component:Jn},{path:"/products",name:"products",component:Ls},{path:"/signup",name:"signup",component:Ta},{path:"/barcodes",name:"barcodes",component:Va},{path:"/proofPayments",name:"proofPayments",component:$a}],Pe=ve({history:be("vilcherrez"),routes:Ha});Pe.beforeEach(async(c,a)=>{if(!te.state.isAuthenticated&&c.name!=="login")return{name:"login"};if(te.state.isAuthenticated&&c.name==="login")return{name:"sales"}});const ue=Me(Ve);ue.use(te).use(Pe).mount("#app");ue.config.globalProperties.$log=console.log;
