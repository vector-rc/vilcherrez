import{d as x,r as le,o as f,c as D,a as e,b as c,w as O,u as i,I as N,B as he,A as Pe,S as Ue,C as ve,P as Se,e as be,f as Ie,g as Le,h as $,i as P,j as ee,n as j,t as U,k as ne,l as Te,m as B,p as F,F as G,T as ye,q as pe,s as Me,v as q,x as v,y as I,z as me,D as de,E as Z,G as ce,H as z,J as Fe,K as H,L as we,M as se,N as ge,O as Ne,Q as _e,R as ke,U as xe,V as We,W as Ve,X as Ge,Y as $e,Z as je,_ as ue,$ as He,a0 as Be,a1 as Ke}from"./vendor.85d58f66.js";const Xe=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerpolicy&&(t.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?t.credentials="include":o.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(o){if(o.ep)return;o.ep=!0;const t=s(o);fetch(o.href,t)}};Xe();var Je="/assets/logo.03d6d6da.png";const qe={class:"menu menu-container p-1 has-background-black-ter has-text-white-ter",style:{"font-weight":"bold"}},ze=e("div",{style:{width:"100%",display:"flex",padding:".5rem"}},[e("img",{src:Je,alt:"",style:{width:"2rem"}}),e("h2",{style:{color:"#fff","font-size":"1.5rem"}},"Vilcherrez")],-1),Ze=e("p",{class:"menu-label"},"Productos",-1),Qe={class:"menu-list"},Ye=e("span",null,"Lista de Productos",-1),es=e("span",null,"Agregar Producto",-1),ss=e("p",{class:"menu-label"},"VENTAS",-1),os={class:"menu-list"},ns=e("span",null,"Lista de Ventas",-1),as=e("span",null,"Nueva Venta",-1),rs=e("p",{class:"menu-label"},"Usuarios",-1),ts={class:"menu-list"},is=e("span",null,"Nuevo Usuario",-1),ls=e("span",null,"Usuarios",-1),ps=e("hr",null,null,-1),ms={class:"menu-list"},ds=e("span",null,"Configuraciones",-1),cs=e("span",null,"Codigos de barra",-1),_s=x({setup(d){return(n,s)=>{const a=le("router-link");return f(),D("aside",qe,[ze,Ze,e("ul",Qe,[e("li",null,[c(a,{to:"/products"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(he))]),_:1}),Ye]),_:1})]),e("li",null,[c(a,{to:"/newProduct"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Pe))]),_:1}),es]),_:1})])]),ss,e("ul",os,[e("li",null,[c(a,{to:"/sales"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Ue))]),_:1}),ns]),_:1})]),e("li",null,[c(a,{to:"/newSale"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(ve))]),_:1}),as]),_:1})])]),rs,e("ul",ts,[e("li",null,[c(a,{to:"/signup"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Se))]),_:1}),is]),_:1})]),e("li",null,[c(a,{to:"/Users"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(be))]),_:1}),ls]),_:1})])]),ps,e("ul",ms,[e("li",null,[c(a,{to:"/printers"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Ie))]),_:1}),ds]),_:1})]),e("li",null,[c(a,{to:"/barcodes"},{default:O(()=>[c(i(N),{size:"20"},{default:O(()=>[c(i(Le))]),_:1}),cs]),_:1})])])])}}}),us={class:"navbar box-shadow-y has-background-black-ter has-text-white-ter",style:{width:"100%"}},Cs={class:"navbar-brand"},Ps=e("span",{"aria-hidden":"true"},null,-1),Ss=e("span",{"aria-hidden":"true"},null,-1),gs=e("span",{"aria-hidden":"true"},null,-1),fs=[Ps,Ss,gs],Es=e("a",{href:"#",class:"navbar-item has-text-weight-bold has-text-black"},[e("h2",{style:{color:"#bbb","font-size":"1.4rem","font-weight":"900"}},"VILCHERREZ SYSTEM")],-1),Rs=e("span",{"aria-hidden":"true"},null,-1),Os=e("span",{"aria-hidden":"true"},null,-1),As=e("span",{"aria-hidden":"true"},null,-1),Ds=[Rs,Os,As],hs={class:"navbar-end"},Us={class:"navbar-item has-dropdown is-hoverable has-background-black-ter"},vs={href:"#",class:"navbar-link has-text-white-ter has-background-black-ter"},bs={class:"navbar-dropdown is-right is-boxed has-background-black-ter"},Is=ne("Perfil"),Ls=e("hr",{class:"navbar-divider has-background-grey"},null,-1),Ts=x({emits:["showDrawer"],setup(d,{emit:n}){const s=$(),a=P(!1),o=ee(()=>s.state.user),t=()=>{window.location.reload()};return(r,m)=>{const l=le("router-link");return f(),D("nav",us,[e("div",Cs,[e("a",{role:"button",class:"navbar-burger toggler","aria-label":"menu","aria-expanded":"true",onClick:m[0]||(m[0]=_=>n("showDrawer"))},fs),Es,e("a",{role:"button",class:j(["navbar-burger nav-toggler",{"is-active":a.value}]),onClick:m[1]||(m[1]=_=>a.value=!a.value)},Ds,2)]),e("div",{class:j(["navbar-menu has-text-white-ter",{"is-active":a.value}])},[e("div",hs,[e("div",Us,[e("a",vs,U(i(o).fullName),1),e("div",bs,[c(l,{to:"/profile",class:"navbar-item has-text-white-ter"},{default:O(()=>[Is]),_:1}),Ls,e("a",{href:"#",class:"navbar-item has-text-white-ter",onClick:t},"Salir")])])])],2)])}}});const ys={style:{padding:"0.5rem"}},Ms=x({setup(d){const n=$(),s=Te(),a=P(!1),o=ee(()=>n.state.isAuthenticated);return(t,r)=>{const m=le("router-view");return f(),D(G,null,[i(o)?(f(),B(Ts,{key:0,onShowDrawer:r[0]||(r[0]=l=>a.value=!a.value)})):F("",!0),i(o)?(f(),B(_s,{key:1,class:j({active:a.value})},null,8,["class"])):F("",!0),e("main",null,[e("div",ys,[c(m,null,{default:O(({Component:l})=>[c(ye,{name:"route",mode:"out-in"},{default:O(()=>[(f(),D("div",{key:i(s).name},[(f(),B(pe(l)))]))]),_:2},1024)]),_:1})])])],64)}}});var Ce=Me({state:{products:[],user:{},isAuthenticated:!1},mutations:{test(){console.log("hola desde vuex")}},actions:{async fetchProducts({state:d}){try{const s=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/products")).json();return s.success&&(d.products=s.data.reverse()),s}catch(n){return console.log(n.type),{success:!0,message:n}}},async fetchSales({state:d}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sales",{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchUsers({state:d}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/users",{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchBoletas({state:d}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/boletas",{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchFacturas({state:d}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/facturas",{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(n){return console.log(n.type),{success:!1,message:n}}},async fetchSaleDetail({state:d},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/saleDetail/${n}`,{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchBoletaDetail({state:d},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/boletaDetail/${n}`,{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchFacturaDetail({state:d},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/facturaDetail/${n}`,{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchPackProducts({state:d},{id:n}){try{return await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/pack_product/${n}`,{headers:{Authorization:`bearer ${d.user.token} `}})).json()}catch(s){return{data:null,success:!0,message:s}}},async fetchRoles(){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/user_roles")).json()}catch(d){return{success:!0,message:d}}},async userLogin({state:d},{credentials:n}){try{const a=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/login",{method:"POST",body:JSON.stringify(n)})).json();return console.log(a),a.success&&(d.user=a.data,d.isAuthenticated=a.success,localStorage.token=a.data.token),a}catch(s){return console.log(s),{success:!1,message:s}}},async userSignup({state:d},{user:n}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/signup",{method:"POST",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify(n)})).json()}catch(s){return console.log(s),{success:!1,message:s}}},async changePassword({state:d},{currentPassword:n,newPassword:s}){try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/changePassword",{method:"POST",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify({currentPassword:n,newPassword:s})})).json()}catch(a){return console.log(a),{success:!1,message:a}}},async saveProduct({state:d},{action:n,product:s}){try{const o=await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:n==="add"?"POST":"PUT",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify(s)})).json();if(o.success&&(n==="add"&&d.products.unshift(o.data),n==="edit")){const t=d.products.findIndex(r=>r.id===s.id);console.log(t),d.products[t]=o.data}return o}catch{}},async savePackingProduct({state:d},{action:n,data:s}){console.log({action:n});try{return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/product",{method:n==="add"?"POST":"PUT",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify(s)})).json()}catch{}},async printerTicket(d,{text:n,qrContent:s}){return await(await fetch(`http://localhost:5050/printer/${localStorage.printer}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,qr_content:s})})).text()},async testEncode(d,{text:n}){return await(await fetch("http://localhost:5050/decodeurl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,qr_content:"hola mundo"})})).text()},async getInfoDoc({state:d},{typeDoc:n,document:s}){let a;return console.log(n),n===1&&(a=await fetch(`https://inversionesvilver.com/shop-back/api/v1/dni/${s}`,{headers:{Authorization:`bearer ${d.user.token} `}})),n===6&&(a=await fetch(`https://inversionesvilver.com/shop-back/api/v1/ruc/${s}`,{headers:{Authorization:`bearer ${d.user.token} `}})),(await a.json()).data},async saveSale({state:d},{soldProducts:n,client:s,typeProof:a}){return(await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sale",{method:"POST",headers:{Authorization:`bearer ${d.user.token} `},body:JSON.stringify({soldProducts:n,client:s,userId:d.user.id,typeProof:a})})).json()).data},async sendSummaries({state:d}){return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/sendResumenes",{method:"POST",headers:{Authorization:`bearer ${d.user.token} `}})).json()},async testEmail({state:d}){return await(await fetch("https://inversionesvilver.com/shop-back/api/v1/testEmail",{headers:{Authorization:`bearer ${d.user.token} `}})).json()},async darBaja({state:d},{proofId:n,typeProof:s,motivoBaja:a}){let o="",t="";return s==="boleta"&&(o="bajaBoleta",t=JSON.stringify({idBoleta:n})),s==="factura"&&(o="bajaFactura",t=JSON.stringify({idFactura:n,motivoBaja:a})),await(await fetch(`https://inversionesvilver.com/shop-back/api/v1/${o}`,{method:"POST",headers:{Authorization:`bearer ${d.user.token} `},body:t})).json()}},modules:{}});const Fs={class:"columns"},ws={class:"column is-11"},Ns={class:"control has-icons-left"},ks={class:"column is-1"},xs={class:"h-100 oy-scroll"},Ws={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Vs=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th")])],-1),Gs={style:{"padding-top":"2px"}},$s=["innerHTML"],js=["onClick","innerHTML"],Hs=["onClick"],Bs=x({emits:["editProduct"],setup(d,{emit:n}){const s=$(),a=P([]),o=P([]),t=P("");q(async()=>{a.value=s.state.products,o.value=s.state.products});const r=(C,S)=>{if(C.length!==0)return C.forEach(u=>{S=S.toString().toLocaleUpperCase().replace(u.toLocaleUpperCase(),`<span style="background:#6eeeeebb">${u.toLocaleUpperCase()}</span>`)}),S},m=()=>{const C=t.value;setTimeout(()=>{if(C===t.value){const u=t.value.toLowerCase().split(" "),h=[];let R=0;a.value.forEach(L=>{R=0,u.forEach(K=>{(L.name.toLowerCase().includes(K)||L.code.toString().toLowerCase().includes(K))&&(R+=1)}),R!==0&&(L.matchs=R,h.push(L))}),console.log(h),o.value=h.sort((L,K)=>K.matchs-L.matchs)}},500)},l=C=>{console.log("hola")},_=C=>{navigator.clipboard.writeText(C.name)};q(async()=>{await E()});const E=async()=>{await s.dispatch("fetchProducts"),a.value=s.state.products,o.value=s.state.products};return(C,S)=>(f(),D(G,null,[e("div",Fs,[e("div",ws,[e("div",Ns,[v(e("input",{class:"input",type:"search",onInput:S[0]||(S[0]=u=>m()),"onUpdate:modelValue":S[1]||(S[1]=u=>t.value=u),placeholder:"Buscar producto"},null,544),[[I,t.value,void 0,{trim:!0}]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(me))]),_:1})])]),e("div",ks,[e("button",{class:"button is-primary",onClick:S[2]||(S[2]=u=>E())},[c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(de))]),_:1})])])]),e("div",xs,[e("table",Ws,[Vs,e("tbody",Gs,[(f(!0),D(G,null,Z(o.value,u=>(f(),D("tr",{key:u.id},[e("td",{innerHTML:r(t.value.split(" "),u.code)},null,8,$s),e("td",{style:{cursor:"copy"},onClick:h=>_(u),innerHTML:r(t.value.split(" "),u.name)},null,8,js),e("td",null,"S/."+U(u.priceSale),1),e("td",null,U(u.stock),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:h=>(l(),n("editProduct",u.productId))},[c(i(N),null,{default:O(()=>[c(i(ce))]),_:1})],8,Hs)])]))),128))])])])],64))}}),Ks={class:"control"},Xs={key:0,class:"help is-danger"},Js=["disabled","value"],qs={class:"control"},zs={class:"control"},Zs={class:"control"},Qs={class:"control"},Ys={class:"control"},eo={class:"control"},so=x({props:{product:Object},emits:["quit","haveErrors"],setup(d,{emit:n}){const s=d,a=$(),o=z(s.product),t=P(!1),r=P(!1),m=P(),l=P("");q(()=>{o.priceBuy!==0&&o.priceSale!==0&&(o.profitPercent=Math.round((o.priceSale-o.priceBuy)/o.priceBuy*100))});const _=()=>{if(o.packing=o.packing.toLocaleUpperCase(),o.priceBuy===0||o.profitPercent===0)return;const h=o.profitPercent/100;if(h!==0){const R=o.priceBuy+o.priceBuy*h;o.priceSale=Math.round((R+Number.EPSILON)*10)/10}},E=Fe("packedProducts");H(()=>{o.code.toString()!==""&&(r.value=E.value.some(h=>o.code.toString()===h.code.toString()&&o.id.toString()!==h.id.toString()),r.value&&(l.value="los codigos no pueden ser iguales"))});const C=()=>{const h=o.code;setTimeout(()=>{o.code===h&&m.value.blur()},100)};H(()=>{n("haveErrors",r.value)});const S=()=>(o.productId!==void 0?(r.value=a.state.products.some(({code:h,productId:R})=>h.toString()===o.code&&R!==o.productId),l.value="Ya existe un producto con este codigo"):r.value=a.state.products.some(({code:h})=>h.toString()===o.code),t.value=!1,r.value),u=()=>{o.code="",r.value=!1,m.value.focus()};return(h,R)=>(f(),D("tr",null,[e("td",Ks,[v(e("input",{autocomplete:"off",onInput:R[0]||(R[0]=L=>C()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:R[1]||(R[1]=L=>L.target.blur()),onBlur:R[2]||(R[2]=L=>S()),onFocus:R[3]||(R[3]=L=>t.value=!0),ref_key:"codeField",ref:m,"onUpdate:modelValue":R[4]||(R[4]=L=>i(o).code=L)},null,544),[[I,i(o).code]]),r.value?(f(),D("span",Xs,U(l.value),1)):F("",!0),ne(" "+U(i(o).code)+" ",1),e("input",{type:"button",onClick:R[5]||(R[5]=L=>u()),disabled:t.value,value:t.value?"Esperando escaneo...":"Escanear codigo",class:"button is-info"},null,8,Js)]),e("td",qs,[v(e("input",{class:"input is-upper",placeholder:"10UND","onUpdate:modelValue":R[6]||(R[6]=L=>i(o).packing=L)},null,512),[[I,i(o).packing,void 0,{trim:!0}]])]),e("td",zs,[v(e("input",{class:j(["input is-upper",{"is-danger":i(o).profitPercent!==void 0&&i(o).profitPercent<.1}]),onInput:R[7]||(R[7]=L=>_()),type:"number",step:"0.1",placeholder:"porcentaje","onUpdate:modelValue":R[8]||(R[8]=L=>i(o).profitPercent=L)},null,34),[[I,i(o).profitPercent,void 0,{number:!0}]])]),e("td",Zs,[v(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"precio de compra","onUpdate:modelValue":R[9]||(R[9]=L=>i(o).priceBuy=L),onInput:R[10]||(R[10]=L=>_())},null,544),[[I,i(o).priceBuy,void 0,{number:!0}]])]),e("td",Qs,[v(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"Precio de Venta","onUpdate:modelValue":R[11]||(R[11]=L=>i(o).priceSale=L)},null,512),[[I,i(o).priceSale]])]),e("td",Ys,[v(e("input",{class:"input is-upper",type:"number",placeholder:"Cantidad","onUpdate:modelValue":R[12]||(R[12]=L=>i(o).stock=L)},null,512),[[I,i(o).stock]])]),e("td",eo,[e("button",{type:"button",class:"button is-danger",onClick:R[13]||(R[13]=L=>n("quit",s.product.id))},[c(i(N),{size:"25"},{default:O(()=>[c(i(we))]),_:1})])])]))}});const oo={class:"card"},no={key:0,class:"card-header"},ao={class:"card-header-title"},ro={class:"card-content"},Y={props:{title:{type:String,default:null},icon:{type:String,default:null},headerIcon:{type:String,default:null}},emits:["header-icon-click"],setup(d,{emit:n}){const s=d;return(a,o)=>(f(),D("div",oo,[d.title?(f(),D("header",no,[e("p",ao,[c(i(N),{size:"25"},{default:O(()=>[s.icon?(f(),B(pe(s.icon),{key:0})):F("",!0)]),_:1}),ne(" "+U(s.title),1)]),d.headerIcon?(f(),D("a",{key:0,href:"#",class:"card-header-icon","aria-label":"more options",onClick:o[0]||(o[0]=se(t=>n("headerIconClick"),["prevent"]))},[c(i(N),{size:"25"},{default:O(()=>[s.headerIcon?(f(),B(pe(s.headerIcon),{key:0})):F("",!0)]),_:1})])):F("",!0)])):F("",!0),e("div",ro,[ge(a.$slots,"default")])]))}},to={class:"field is-horizontal"},io={class:"field-label is-normal"},lo={class:"label"},po={class:"field-body"},mo={class:"field"},W={props:{label:String},setup(d){const n=d;return(s,a)=>(f(),D("div",to,[e("div",io,[e("label",lo,U(n.label),1)]),e("div",po,[e("div",mo,[ge(s.$slots,"default")])])]))}},ae=(d,n,s,a,o)=>{const t=("t"+Date.now()+Math.random()).replace(".",""),r=("b"+Date.now()+Math.random()).replace(".",""),m=` <button class="${r} delete"></button>${d}`,l=document.createElement("div");l.classList.add(t,"notification","is-"+n,"toast","m-1"),l.innerHTML=m,s.appendChild(l),a.appendChild(s);const _=document.querySelector("."+r);_.onclick=()=>{s.removeChild(l)},o!==-1&&setTimeout(()=>{l.style.opacity=0,setTimeout(()=>{s.contains(l)&&s.removeChild(l)},1100)},o-500)},co=()=>{const d=document.querySelector("#app");let n=document.querySelector(".toastContainer");return n||(n=document.createElement("div"),n.classList.add("toastContainer")),{danger:(s,a=-1)=>{ae(s,"danger",n,d,a)},warning:(s,a=-1)=>{ae(s,"warning",n,d,a)},success:(s,a=-1)=>{ae(s,"success",n,d,a)},info:(s,a=-1)=>{ae(s,"info",n,d,a)}}},V=co(),_o={key:0,class:"modal is-active"},uo=e("div",{class:"modal-background"},null,-1),Co={class:"modal-card"},Po={class:"modal-card-head"},So=e("p",{class:"modal-card-title"},"Advertencia",-1),go=e("section",{class:"modal-card-body"},"Algunos codigos estan vacios, \xBFquiere guardar de todas formas?",-1),fo={class:"modal-card-foot"},Eo={class:"control"},Ro={key:0,class:"help is-danger"},Oo=e("hr",null,null,-1),Ao={class:"table is-bordered is-fullwidth"},Do=e("th",null,"CODIGO",-1),ho=e("th",null,"PACKING",-1),Uo=e("th",null,"PORCENTAJE DE GANANCIA",-1),vo=e("th",null,"PRECIO DE COMPRA",-1),bo=e("th",null,"PRECIO DE VENTA",-1),Io=e("th",null,"CANTIDAD",-1),Lo=["disabled"],fe=x({props:{productId:{type:Number,default:-1}},emits:["cancelEdit"],setup(d,{emit:n}){const s=d,a=$(),o=P(!1),t=P(),r=P(!1),m=[{pack:"12 UND",profitPercent:25},{pack:"25 UND",profitPercent:25},{pack:"50 UND",profitPercent:25},{pack:"100 UND",profitPercent:25}],l=P(!1),_=z({id:0,name:"",brand:"",tags:"",description:"",features:{},image:""}),E=P([]),C=P([]),S=()=>{C.value=[{id:"V"+Date.now(),code:"",packing:"UND",profitPercent:50,measureUnit:"NIU",priceSale:0,priceBuy:0,stock:0}],m.forEach((w,y)=>{C.value.push({id:"V"+Date.now()+y+1,code:"",packing:w.pack,profitPercent:w.profitPercent,measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})}),_.name="",_.brand="",_.tags="",_.features={},_.description="",_.image="",n("cancelEdit")};Ne("packedProducts",C),H(async()=>{if(console.log(s.productId),s.productId!==-1){console.log("wwwwjdkdk");const w=await a.dispatch("fetchPackProducts",{id:s.productId});C.value=w.data.packedProducts,_.name=w.data.product.name,_.id=w.data.product.id}else console.log("resetetet"),S()}),q(()=>{});const u=()=>{C.value.push({id:"V"+Date.now(),code:"",packing:"",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})},h=w=>{if(C.value.length===1)return;const y=C.value.findIndex(k=>k.id===w);C.value.splice(y,1)},R=()=>(s.productId!==-1?o.value=a.state.products.some(({name:w,productId:y})=>w.toLowerCase()===_.name.toLowerCase()&&y!==_.id):o.value=a.state.products.some(({name:w})=>w.toLowerCase()===_.name.toLowerCase()),o.value),L=async()=>{if(o.value)return;l.value=!1;const w={action:s.productId!==-1?"edit":"add",data:{product:_,packedProducts:[...C.value]}};(await a.dispatch("savePackingProduct",w)).success&&(S(),V.success("Producto guardado exitosamente",2e3))},K=async()=>{const w={action:s.productId!==-1?"edit":"add",data:{product:_,packedProducts:[...C.value]}};if(R())return;if(C.value.some(k=>k.code==="")){l.value=!0;return}(await a.dispatch("savePackingProduct",w)).success&&(S(),V.success("Producto guardado exitosamente",2e3))};return(w,y)=>(f(),D(G,null,[l.value?(f(),D("div",_o,[uo,e("div",Co,[e("header",Po,[So,e("button",{class:"delete","aria-label":"close",onClick:y[0]||(y[0]=k=>l.value=!1)})]),go,e("footer",fo,[e("button",{onClick:y[1]||(y[1]=k=>L()),class:"button is-success"},"Guardar"),e("button",{onClick:y[2]||(y[2]=k=>l.value=!1),class:"button"},"Cancelar")])])])):F("",!0),c(Y,{title:"Agregar producto",icon:i(Pe)},{default:O(()=>[e("form",{onSubmit:y[9]||(y[9]=se(k=>K(),["prevent"])),ref_key:"form",ref:t},[c(W,{label:"Nombre"},{default:O(()=>[e("p",Eo,[v(e("input",{class:j(["input upper",{"is-danger":o.value}]),onInput:y[3]||(y[3]=k=>R()),required:"","onUpdate:modelValue":y[4]||(y[4]=k=>i(_).name=k)},null,34),[[I,i(_).name,void 0,{trim:!0}]]),o.value?(f(),D("span",Ro,"Ya existe un producto con este nombre")):F("",!0)])]),_:1}),Oo,e("table",Ao,[e("thead",null,[e("tr",null,[Do,ho,Uo,vo,bo,Io,e("th",null,[e("button",{type:"button",class:"button is-info",onClick:y[5]||(y[5]=k=>u())},"+")])])]),e("tbody",null,[(f(!0),D(G,null,Z(C.value,(k,Q)=>(f(),B(so,{key:k.id,product:k,onHaveErrors:y[6]||(y[6]=J=>r.value=J),onQuit:y[7]||(y[7]=J=>h(J)),ref_for:!0,ref:J=>{J&&(E.value[Q]=J)}},null,8,["product"]))),128))])]),e("button",{class:"button is-primary",disabled:r.value},"Guardar producto",8,Lo),s.productId!==-1?(f(),D("button",{key:0,type:"button",onClick:y[8]||(y[8]=k=>n("cancelEdit")),class:"button is-danger"},"Cancelar")):F("",!0)],544)]),_:1},8,["icon"])],64))}}),To={key:0,class:"modal is-active"},yo=e("div",{class:"modal-background"},null,-1),Mo={class:"modal-card",style:{width:"75%",height:"80%"}},Fo=x({setup(d){const n=P(-1),s=P(!1),a=t=>{console.log(t),s.value=!0,n.value=t,console.log(n.value)},o=()=>{s.value=!1,n.value=-1};return(t,r)=>(f(),D(G,null,[s.value?(f(),D("div",To,[yo,e("div",Mo,[c(fe,{"product-id":n.value,onCancelEdit:r[0]||(r[0]=m=>o())},null,8,["product-id"])])])):F("",!0),e("div",null,[c(Bs,{onEditProduct:r[1]||(r[1]=m=>a(m))})])],64))}}),wo={key:0,class:"modal is-active",style:{"z-index":"9999"}},No=e("div",{class:"modal-background"},null,-1),ko={class:"modal-content",style:{width:"35%",height:"30%"}},xo={class:"message is-danger"},Wo={class:"message-header"},Vo=e("p",null,"Danger",-1),Go={class:"message-body"},$o=e("span",null,"Una vez que se dea de baja ya no se podra recuperar",-1),jo=e("br",null,null,-1),Ho=e("br",null,null,-1),Bo={key:0,class:"field"},Ko=e("label",{class:"label"},"Motivo de Baja",-1),Xo={class:"control"},Jo=["disabled"],qo={key:1,class:"modal is-active"},zo=e("div",{class:"modal-background"},null,-1),Zo={class:"modal-card",style:{width:"50%",height:"70%"}},Qo={class:"modal-card-head"},Yo=e("p",{class:"modal-card-title"},"Detalles de la venta",-1),en={class:"modal-card-body"},sn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},on=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Comprobante")])],-1),nn={key:0,style:{"padding-top":"2px"}},an=e("th",null,"Tipo",-1),rn=e("th",null,"Serie-Correlativo",-1),tn=e("th",null,"Fecha y hora de emision",-1),ln={colspan:"2"},pn=["disabled"],mn={key:0,class:"tag is-danger m-2"},dn={key:1,style:{"padding-top":"2px"}},cn=e("tr",null,[e("th",null,"SIN COMPROBANTE")],-1),_n=[cn],un={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Cn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"2",style:{"text-align":"center"}},"Cliente")])],-1),Pn={style:{"padding-top":"2px"}},Sn=e("th",null,"Documento",-1),gn=e("th",null,"Nombre",-1),fn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},En=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Productos Vendidos")]),e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto")])],-1),Rn={style:{"padding-top":"2px"}},On=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),An={class:"modal-card-foot"},Dn=["disabled"],hn=x({props:{show:Boolean,saleId:Number},emits:["save","hide"],setup(d,{emit:n}){const s=d,a=$(),o=P(s.show),t=P(!1),r=P("ticket"),m=P(0),l=P({}),_=P({}),E=P({}),C=P(""),S=P(!1),u=P(!1),h=P(!1),R=P(!0),L=P("ERROR EN LOS CALCULOS"),K=P(s.saleId),w=P([]);H(()=>{o.value=s.show}),H(async()=>{if(s.saleId===0)return;S.value=!1,K.value=s.saleId;const M=await a.dispatch("fetchSaleDetail",{id:K.value});console.log(M),S.value=!0,w.value=M.data.soldProducts,m.value=M.data.sale.total,l.value=M.data.client,_.value=M.data.proof,C.value=M.data.legend,E.value=M.data.sale,R.value=_.value.enable===1&&(_.value.status===1||_.value.status===2||_.value.status===4),r.value=_.value===!1?"ticket":_.value.serie.startsWith("B")?"boleta":"factura"});const y=(M,g,p,A,b=[])=>{let T=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return g==="ticket"?T+=`
              TICKET DE VENTA ELECTRONICO 
      `:T+=`
         ${g.toLocaleUpperCase()} ELECTRONICA ${b.serie}-${k(b.correlative)}
      `,T+=`
Fecha de emision:${g!=="ticket"?b.dateTime:p.dateTime}
ID Venta: 00000${p.id}
  `,g!=="ticket"&&(T+=`
CLIENTE:
Documento: ${A.document}
Nombre: ${A.name}
`),T+=J(w.value),T+=`
                OP.GRAVADAS:        S/ ${Math.round((p.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((p.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${p.total}
------------------------------------------------ 
${M}

************************************************
            !GRACIAS POR SU COMPRA!
`,T},k=M=>{let g="";for(let p=0;p<8-M.toString().length;p++)g+="0";return g+M.toString()},Q=M=>{if(M<=0)return"";let g="";for(let p=0;p<M;p++)g+=" ";return g},J=M=>{let g="",p="",A=`
------------------------------------------------
`;return A+=`PRODUCTO                 CANT P.UNI   MONTO
`,A+=`------------------------------------------------
`,M.forEach(b=>{g=b.name.slice(0,24)+Q(24-b.name.length),g+="  ",g+=""+b.quantity+Q(3-(""+b.quantity).length),g+=" S/",g+=""+b.price+Q(6-(""+b.price).length),g+=" S/",g+=""+b.mount+Q(7-(""+b.mount).length),A+=`${g}
`,b.name.length>24&&(p=b.name.slice(24,48),A+=`${p}
`),b.name.length>48&&(p=b.name.length>72?b.name.slice(48,72)+"...":b.name.slice(48),A+=`${p}
`)}),A+=`------------------------------------------------
`,A},te=async()=>{u.value=!0;let M=y(C.value,r.value,E.value,l.value,_.value);try{M=M.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),console.log(M);let g="";r.value!=="ticket"&&(g=`20605808931|${r.value==="boleta"?"03":"01"}|${_.value.serie}|${k(_.value.correlative)}|${Math.round((E.value.total*(18/118)+Number.EPSILON)*10)/10}|${E.value.total}|${_.value.dateTime.slice(0,10)}|0${l.value.documentType}|${l.value.document}`),await a.dispatch("printerTicket",{text:M,qrContent:g}),u.value=!1}catch{u.value=!1,V.danger("No se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",3e3)}},ie=async()=>{h.value=!0;try{await a.dispatch("darBaja",{proofId:_.value.id,typeProof:r.value,motivoBaja:L.value}),h.value=!1,V.success("Comprobante Dado de baja con exito",3e3),R.value=!1,t.value=!1}catch(M){h.value=!1,V.danger(M,3e3),R.value=!0}};return(M,g)=>(f(),D(G,null,[t.value?(f(),D("div",wo,[No,e("div",ko,[e("article",xo,[e("div",Wo,[Vo,e("button",{class:"delete",onClick:g[0]||(g[0]=p=>t.value=!1),"aria-label":"delete"})]),e("div",Go,[e("span",null,"\xBF\xBF Esta seguro de dar de baja esta "+U(r.value)+"?",1),$o,jo,Ho,r.value==="factura"?(f(),D("div",Bo,[Ko,e("p",Xo,[v(e("input",{class:"input is-upper",placeholder:"ejemplo: ruc equibocado","onUpdate:modelValue":g[1]||(g[1]=p=>L.value=p)},null,512),[[I,L.value]])])])):F("",!0),e("button",{disabled:h.value,class:"button is-danger mx-2",onClick:g[2]||(g[2]=p=>ie())},"Dar de baja",8,Jo),e("button",{class:"button",onClick:g[3]||(g[3]=p=>t.value=!1)},"Cancelar")])])])])):F("",!0),o.value&&S.value?(f(),D("div",qo,[zo,e("div",Zo,[e("header",Qo,[Yo,e("button",{class:"delete","aria-label":"close",onClick:g[4]||(g[4]=p=>n("hide"))})]),e("section",en,[e("table",sn,[on,_.value!==!1?(f(),D("tbody",nn,[e("tr",null,[an,e("td",null,U(r.value.toLocaleUpperCase()),1)]),e("tr",null,[rn,e("td",null,U(_.value.serie)+"-"+U(k(_.value.correlative)),1)]),e("tr",null,[tn,e("td",null,U(_.value.dateTime),1)]),e("tr",null,[e("td",ln,[e("button",{type:"button",onClick:g[5]||(g[5]=p=>t.value=!0),disabled:!R.value,class:"button is-danger"},"DAR DE BAJA LA "+U(r.value.toLocaleUpperCase()),9,pn),R.value?F("",!0):(f(),D("span",mn," LA "+U(r.value.toLocaleUpperCase())+" YA HA SIDO DADA DE BAJA",1))])])])):F("",!0),_.value===!1?(f(),D("tbody",dn,_n)):F("",!0)]),e("table",un,[Cn,e("tbody",Pn,[e("tr",null,[Sn,e("td",null,U(l.value.document),1)]),e("tr",null,[gn,e("td",null,U(l.value.name),1)])])]),e("table",fn,[En,e("tbody",Rn,[(f(!0),D(G,null,Z(w.value,p=>(f(),D("tr",{key:p.id},[e("td",null,U(p.code),1),e("td",null,U(p.name),1),e("td",null,"S/ "+U(p.price),1),e("td",null,U(p.quantity),1),e("td",null,"S/ "+U(p.mount),1)]))),128)),e("tr",null,[On,e("th",null,"S/. "+U(m.value),1)])])])]),e("footer",An,[e("button",{disabled:u.value||!R.value&&r.value!=="ticket",onClick:g[6]||(g[6]=p=>te()),class:"button is-success"},"Imprimir copia de "+U(r.value),9,Dn),e("button",{onClick:g[7]||(g[7]=p=>n("hide")),class:"button"},"Cancelar")])])])):F("",!0)],64))}}),Un=["value","name"],re={props:{label:String,value:String,modelValue:Number},emits:["update:modelValue"],setup(d,{emit:n}){const s=d,a=P(!1),o=P();return H(()=>{a.value=s.modelValue===parseInt(s.value)}),(t,r)=>(f(),D("label",{class:j(["button is-link m-2",{"is-outlined":!a.value}])},[ne(U(s.label)+" ",1),e("input",{ref_key:"rb",ref:o,type:"radio",value:s.value,name:s.modelValue,onInput:r[0]||(r[0]=m=>n("update:modelValue",m.target.value)),style:{display:"none"}},null,40,Un)],2))}};const vn={class:"columns"},bn={class:"column is-11"},In={class:"control has-icons-left"},Ln={class:"control"},Tn={class:"column is-1"},yn={class:"h-100 oy-scroll"},Mn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Fn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"ID"),e("th",null,"Cliente"),e("th",null,"Documento Cliente"),e("th",null,"Fecha emision"),e("th",null,"Importe Total"),e("th",null,"Tipo de comprobante"),e("th")])],-1),wn={style:{"padding-top":"2px"}},Nn={class:"tag is-primary"},kn={key:0,class:"tag is-danger"},xn=["onClick"],Ee=x({setup(d){const n=$(),s=P([]),a=P([]),o=P(""),t=P(!1),r=P(0),m=P(0);q(async()=>{const C=await n.dispatch("fetchSales");if(!C.success){V.danger(C.message);return}s.value=C.data.reverse(),a.value=s.value}),H(()=>{if(console.log(m.value),o.value="",parseInt(m.value)===0){a.value=s.value;return}a.value=s.value.filter(C=>C.proofType===parseInt(m.value))});const l=C=>C===99?"SIN COMPROBANTE":C===3?"BOLETA":"FACTURA",_=()=>{const C=o.value.toLowerCase();a.value=s.value.filter(S=>(S.clientName.toLowerCase().includes(C)||S.clientDocument.toString().toLowerCase().includes(C))&&(S.proofType===parseInt(m.value)||parseInt(m.value)===0))},E=async()=>{const C=await n.dispatch("fetchSales");s.value=C.data.reverse(),a.value=s.value};return(C,S)=>(f(),D(G,null,[c(hn,{saleId:r.value,show:t.value,onHide:S[0]||(S[0]=u=>t.value=!1)},null,8,["saleId","show"]),e("div",vn,[e("div",bn,[e("div",In,[v(e("input",{class:"input",type:"search",onInput:S[1]||(S[1]=u=>_()),"onUpdate:modelValue":S[2]||(S[2]=u=>o.value=u),placeholder:"Buscar por nombre o documento"},null,544),[[I,o.value,void 0,{trim:!0}]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(me))]),_:1})]),e("div",Ln,[c(re,{label:"Todos",value:"0",modelValue:m.value,"onUpdate:modelValue":S[3]||(S[3]=u=>m.value=u),modelModifiers:{number:!0}},null,8,["modelValue"]),c(re,{label:"Facturas",value:"1",modelValue:m.value,"onUpdate:modelValue":S[4]||(S[4]=u=>m.value=u),modelModifiers:{number:!0}},null,8,["modelValue"]),c(re,{label:"Boletas",value:"3",modelValue:m.value,"onUpdate:modelValue":S[5]||(S[5]=u=>m.value=u),modelModifiers:{number:!0}},null,8,["modelValue"]),c(re,{label:"Sin Comprobate",value:"99",modelValue:m.value,"onUpdate:modelValue":S[6]||(S[6]=u=>m.value=u),modelModifiers:{number:!0}},null,8,["modelValue"])])]),e("div",Tn,[e("button",{class:"button is-primary",onClick:S[7]||(S[7]=u=>E())},[c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(de))]),_:1})])])]),e("div",yn,[e("table",Mn,[Fn,e("tbody",wn,[(f(!0),D(G,null,Z(a.value,u=>(f(),D("tr",{key:u.id,class:j({"has-background-danger-light":u.enable===0||u.status===3||u.status===5})},[e("td",null,U(u.id),1),e("td",null,U(u.clientName),1),e("td",null,U(u.clientDocument),1),e("td",null,U(u.dateTime),1),e("td",null,"S/. "+U(u.total),1),e("td",null,[e("span",Nn,U(l(u.proofType)),1),u.enable===0||u.status===3||u.status===5?(f(),D("span",kn,"ANULADO")):F("",!0)]),e("td",null,[e("button",{class:"button is-info is-small",onClick:h=>(r.value=u.id,t.value=!0)},[c(i(N),null,{default:O(()=>[c(i(ce))]),_:1})],8,xn)])],2))),128))])])])],64))}}),Wn=x({setup(d){return(n,s)=>(f(),B(Ee))}}),Vn={class:"columns"},Gn={class:"column"},$n=["value"],jn=x({setup(d){const n=P([]),s=P("");q(async()=>{const t=await(await fetch("http://localhost:5050/devices")).json();n.value=t,s.value=localStorage.printer});const a=()=>{localStorage.printer=s.value};return(o,t)=>(f(),D("div",Vn,[e("div",Gn,[v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>s.value=r)},[(f(!0),D(G,null,Z(n.value,r=>(f(),D("option",{key:r.vendor_id,value:r.product_id+"/"+r.vendor_id},U(r.vendor_id)+":"+U(r.product_id)+" "+U(r.name),9,$n))),128))],512),[[_e,s.value]]),e("button",{class:"button is-primary",onClick:t[1]||(t[1]=r=>a())},"Guardar")])]))}}),Hn=["onSubmit"],Bn={class:"field"},Kn=e("label",{class:"label"},"Usuario",-1),Xn={class:"control has-icons-left"},Jn={class:"field"},qn=e("label",{class:"label"},"Contrase\xF1a",-1),zn={class:"control has-icons-left"},Zn={class:"field"},Qn={class:"control is-expanded"},Yn=e("button",{class:"button is-primary is-medium input mt-2"},"Iniciar Sesion",-1),ea={key:0,class:"help is-danger"},sa=x({setup(d){const n=$(),s=P(!1),a=ke(),o=z({userName:"",password:""}),t=async()=>{const r=await n.dispatch("userLogin",{credentials:o});s.value=!r.success,s.value&&V.danger(r.message,3e3),r.success&&(await n.dispatch("fetchProducts"),V.success(r.message,3e3),a.replace("products")),console.log(r.message)};return(r,m)=>(f(),D("form",{onSubmit:se(t,["prevent"]),class:"box column is-4 is-offset-4"},[e("div",Bn,[Kn,e("div",Xn,[v(e("input",{class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":m[0]||(m[0]=l=>i(o).userName=l),placeholder:"Nombre de usuario"},null,512),[[I,i(o).userName]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(xe))]),_:1})])]),e("div",Jn,[qn,e("div",zn,[v(e("input",{class:"input is-medium",required:"","onUpdate:modelValue":m[1]||(m[1]=l=>i(o).password=l),type:"password",placeholder:"************"},null,512),[[I,i(o).password]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(We))]),_:1})])]),e("div",Zn,[e("p",Qn,[Yn,s.value?(f(),D("span",ea,"Error al iniciar session")):F("",!0)])])],40,Hn))}}),oa=["onSubmit"],na={class:"control"},aa=["disabled"],ra=e("hr",null,null,-1),ta={class:"control"},ia=["disabled"],la=e("hr",null,null,-1),pa={class:"control"},ma=["disabled"],da={key:0,class:"help is-danger"},ca={class:"control"},_a=["disabled"],ua={key:0,class:"help is-danger"},Ca=e("hr",null,null,-1),Pa={class:"control"},Sa=["disabled"],ga=e("hr",null,null,-1),fa={class:"control"},Ea=["disabled"],Ra=e("hr",null,null,-1),Oa={class:"control"},Aa=["disabled"],Da=x({setup(d){const n=P(),s=$(),a=P(!1),o=P([]),t=P(!1),r=z({userName:"",dni:"",fullName:"",email:"",password:"",roleId:"1",mobile:""}),m=P(""),l=P(!1),_=()=>{r.password!==m.value?l.value=!0:l.value=!1};q(async()=>{t.value=s.state.user.roleId!==2,t.value&&V.danger("No tiene permisos para agregar usuarios",4e3);const C=await s.dispatch("fetchRoles");o.value=C.data});const E=async()=>{if(r.password!==m.value){l.value=!0;return}const C=await s.dispatch("userSignup",{user:r});if(a.value=C.success,!C.success){V.danger(C.message,4e3);return}n.value.reset(),V.success(C.message,4e3),alert(`usuario registrado 
 UserName: `+C.data.userName)};return(C,S)=>(f(),B(Y,{icon:i(Se),title:"Registrar nuevo usuario"},{default:O(()=>[e("form",{onSubmit:se(E,["prevent"]),ref_key:"form",ref:n},[c(W,{label:"DNI"},{default:O(()=>[e("div",na,[v(e("input",{class:"input",disabled:t.value,ref:"fieldName","onUpdate:modelValue":S[0]||(S[0]=u=>i(r).dni=u),type:"number",placeholder:"documento de identidad"},null,8,aa),[[I,i(r).dni]])])]),_:1}),ra,c(W,{label:"Nombres y Apellidos"},{default:O(()=>[e("div",ta,[v(e("input",{class:"input",disabled:t.value,ref:"fieldName",required:"","onUpdate:modelValue":S[1]||(S[1]=u=>i(r).fullName=u),type:"text",placeholder:"Nombres y apellidos"},null,8,ia),[[I,i(r).fullName]])])]),_:1}),la,c(W,{label:"Contrase\xF1a"},{default:O(()=>[e("div",pa,[v(e("input",{class:j(["input",{"is-danger":l.value}]),disabled:t.value,required:"","onUpdate:modelValue":S[2]||(S[2]=u=>i(r).password=u),type:"password",placeholder:"Contrase\xF1a"},null,10,ma),[[I,i(r).password]]),l.value?(f(),D("span",da,"Las contrase\xF1as no coinciden")):F("",!0)])]),_:1}),c(W,{label:"Repetir Contrase\xF1a"},{default:O(()=>[e("div",ca,[v(e("input",{class:j(["input",{"is-danger":l.value}]),disabled:t.value,onBlur:S[3]||(S[3]=u=>_()),required:"","onUpdate:modelValue":S[4]||(S[4]=u=>m.value=u),type:"password",placeholder:"Vuelva a escribir la contrase\xF1a"},null,42,_a),[[I,m.value]]),l.value?(f(),D("span",ua,"Las contrase\xF1as no coinciden")):F("",!0)])]),_:1}),Ca,c(W,{label:"Celular"},{default:O(()=>[e("div",Pa,[v(e("input",{class:"input",disabled:t.value,step:"0.1","onUpdate:modelValue":S[5]||(S[5]=u=>i(r).mobile=u),type:"number",placeholder:"Numero de celular"},null,8,Sa),[[I,i(r).mobile]])])]),_:1}),ga,c(W,{label:"Email"},{default:O(()=>[e("div",fa,[v(e("input",{class:"input",disabled:t.value,ref:"fieldName","onUpdate:modelValue":S[6]||(S[6]=u=>i(r).email=u),type:"text",placeholder:"Correo electronico"},null,8,Ea),[[I,i(r).email]])])]),_:1}),Ra,c(W,null,{default:O(()=>[e("div",Oa,[e("button",{class:"button is-primary",disabled:t.value},"Registrar usuario",8,Aa)])]),_:1})],40,oa)]),_:1},8,["icon"]))}}),ha={class:"panel"},Ua={class:"panel-block"},va={class:"control has-icons-left"},ba=["title","onClick","innerHTML"],Re=x({emits:["itemSelected"],setup(d,{emit:n}){const s=$(),a=P([]),o=P([]),t=P("");q(async()=>{await s.dispatch("fetchProducts"),a.value=s.state.products});const r=l=>{const _=t.value.split(" ");if(_.length!==0)return _.forEach(E=>{l=l.toString().toLocaleUpperCase().replace(E.toLocaleUpperCase(),`<span style="background:#6eeeeebb">${E.toLocaleUpperCase()}</span>`)}),l},m=()=>{if(t.value===""){o.value=[];return}const l=t.value;setTimeout(()=>{if(l===t.value){const E=t.value.toLowerCase().split(" "),C=[];let S=0;a.value.forEach(u=>{S=0,E.forEach(h=>{(u.name.toLowerCase().includes(h)||u.code.toString().toLowerCase().includes(h))&&(S+=1)}),S!==0&&(u.matchs=S,C.push(u))}),console.log(C),o.value=C.sort((u,h)=>h.matchs-u.matchs).slice(0,15)}},500)};return(l,_)=>(f(),D("div",ha,[e("div",Ua,[e("p",va,[v(e("input",{class:"input upper",type:"search",onInput:_[0]||(_[0]=E=>m()),"onUpdate:modelValue":_[1]||(_[1]=E=>t.value=E),placeholder:"Buscar producto"},null,544),[[I,t.value,void 0,{trim:!0}]]),c(i(N),{class:"icon is-left"},{default:O(()=>[c(i(Ve))]),_:1})])]),(f(!0),D(G,null,Z(o.value,E=>(f(),D("a",{title:"S/. "+E.priceSale,class:"panel-block",style:{display:"block"},onClick:C=>n("itemSelected",E),key:E.id,innerHTML:r(E.name)},null,8,ba))),128))]))}}),Ia=["srcdoc"],La=x({props:{product:Object,stock:Number,rows:Number},setup(d){const n=d,s=P(),a=P(),o=P(""),t=async(m,l)=>{const _=a.value.src;let E=`
   <html style="width:105mm;padding:0;margin:0" >
  <head>
   </head>
   <body style="width:105mm;padding:0;margin:0">`;for(let C=0;C<Math.ceil(l/3);C++){E+='<div style="display:block;width:110mm;margin:0 auto">',E+='<div style="margin:0 auto;padding:0 3mm 0 3mm;width:100%;display:flex;grid-template-columns: repeat(3, 1fr);font-family:arial;font-weight: bold;justify-content:space-evenly ;height:20mm ;page-break-after: always">';for(let S=0;S<3;S++)E+=`<div style="display: flex;flex-direction: column;align-items: center;font-size: 10px;widt:30mm;max-width:30mm;border:1px solid black;padding:2px;text-align:center;height:19mm">
    <span style="margin: 0;padding: 0;z-index: 1;word-wrap:break-word;word-break: break-all;">${m.name}</span>
    <img style="width:29mm" src="${_}"/>
    <span style="margin: 0;padding: 0;z-index: 1">${m.code}</span>
    </div>`;E+="</div></div>"}E+=`</div> </body>
  </html>`,o.value=E},r=async(m,l)=>{const _=a.value.src;let E=`
   <html style="width:105mm;padding:0;margin:0" >
  <head>
   </head>
   <body style="width:105mm;padding:0;margin:0">`;for(let C=0;C<Math.ceil(l/2);C++){E+='<div style="display:block;width:108mm;margin:0 auto">',E+='<div style="margin:0 auto;padding:0;width:100%;display:flex;grid-template-columns: repeat(2, 1fr);font-family:arial;font-weight: bold;justify-content:space-evenly ;height:25mm ;page-break-after: always">';for(let S=0;S<2;S++)E+=`<div style="display: flex;flex-direction: column;align-items: center;font-size: 10px;max-width:45mm;border:1px solid black;padding:2px;text-align:center;justify-content:center;height:24mm">
    <span style="margin: 0;padding: 0;z-index: 1;word-wrap:break-word;word-break: break-all;">${m.name}</span>
    <img style="width:42mm" src="${_}"/>
    <span style="margin: 0;padding: 0;z-index: 1">${m.code}</span>
    </div>`;E+="</div></div>"}E+=`</div> </body>
  </html>`,o.value=E};return H(async()=>{Ge("#barcode",n.product.code,{displayValue:!1,height:20,width:1,margin:0}),n.rows===2?await r(n.product,n.stock):await t(n.product,n.stock)}),(m,l)=>(f(),B(Y,{title:"Previsualizacion"},{default:O(()=>[e("iframe",{id:"printf",name:"printf",ref_key:"pdf",ref:s,style:{width:"100%",height:"30rem"},srcdoc:o.value},null,8,Ia),e("img",{ref_key:"img",ref:a,id:"barcode",style:{display:"none"}},null,512)]),_:1}))}}),Ta={class:"responsive-container"},ya={class:"control"},Ma={class:"control"},Fa=e("option",{value:"3"},"3 por fila",-1),wa=e("option",{value:"2"},"2 por fila",-1),Na=[Fa,wa],ka=e("hr",null,null,-1),xa=x({setup(d){const n=P({}),s=P(6),a=P(3),o=()=>{const r=window;r.frames.printf.focus(),r.frames.printf.print()},t=r=>{n.value=r,console.log(r.code)};return(r,m)=>(f(),D("div",Ta,[c(Y,{title:"Opciones de codigos de barras"},{default:O(()=>[e("form",null,[c(W,{label:"Cantidad total"},{default:O(()=>[e("div",ya,[v(e("input",{type:"number",class:"input",required:"","onUpdate:modelValue":m[0]||(m[0]=l=>s.value=l),placeholder:"Cantidad"},null,512),[[I,s.value,void 0,{number:!0}]])])]),_:1}),c(W,{label:"Cantidad por fila"},{default:O(()=>[e("div",Ma,[v(e("select",{"onUpdate:modelValue":m[1]||(m[1]=l=>a.value=l),class:"input"},Na,512),[[_e,a.value,void 0,{number:!0}]])])]),_:1}),ka,c(W,null,{default:O(()=>[e("button",{type:"button",onClick:m[2]||(m[2]=l=>o()),class:"button is-primary"},"Imprimir Codigos")]),_:1}),c(Re,{onItemSelected:m[3]||(m[3]=l=>t(l))})])]),_:1}),c(La,{product:n.value,stock:s.value,rows:a.value},null,8,["product","stock","rows"])]))}}),Wa={class:"columns"},Va={class:"column is-4"},Ga=x({setup(d){const n=$(),s=()=>{const o=n.dispatch("sendSummaries");console.log(o)},a=()=>{n.dispatch("testEmail")};return(o,t)=>(f(),D("div",Wa,[e("form",Va,[e("button",{type:"button",onClick:t[0]||(t[0]=r=>s()),class:"button is-primary is-medium"},"Generar y envia resumenes"),e("button",{type:"button",onClick:t[1]||(t[1]=r=>a()),class:"button is-primary is-medium"},"Testear email")])]))}}),$a=["onSubmit"],ja={class:"control"},Ha=e("hr",null,null,-1),Ba={class:"control"},Ka=e("hr",null,null,-1),Xa={class:"control"},Ja=e("hr",null,null,-1),qa={class:"control"},za=e("hr",null,null,-1),Za={class:"control"},Qa=e("hr",null,null,-1),Ya={setup(d){const n=$(),s=P(!1),a=z(n.state.user);console.log(n);const o=()=>{s.value=!0,setTimeout(()=>{s.value=!1,this.$buefy.snackbar.open({message:"Demo only",queue:!1})},750)};return(t,r)=>(f(),B(Y,{title:"Editar Perfil",icon:i($e)},{default:O(()=>[e("form",{onSubmit:se(o,["prevent"])},[c(W,{label:"Usuario"},{default:O(()=>[e("p",ja,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[0]||(r[0]=m=>i(a).userName=m)},null,512),[[I,i(a).userName]])])]),_:1}),Ha,c(W,{label:"Nombre Completo"},{default:O(()=>[e("p",Ba,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[1]||(r[1]=m=>i(a).fullName=m)},null,512),[[I,i(a).fullName]])])]),_:1}),Ka,c(W,{label:"Email"},{default:O(()=>[e("p",Xa,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[2]||(r[2]=m=>i(a).email=m)},null,512),[[I,i(a).email]])])]),_:1}),Ja,c(W,{label:"Celular"},{default:O(()=>[e("p",qa,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[3]||(r[3]=m=>i(a).movile=m)},null,512),[[I,i(a).movile]])])]),_:1}),za,c(W,{label:"DNI"},{default:O(()=>[e("p",Za,[v(e("input",{class:"input",required:"","onUpdate:modelValue":r[4]||(r[4]=m=>i(a).dni=m)},null,512),[[I,i(a).dni]])])]),_:1}),Qa],40,$a)]),_:1},8,["icon"]))}},er=["onSubmit"],sr=e("hr",null,null,-1),or={key:0,class:"help is-danger"},nr={key:0,class:"help is-danger"},ar=e("hr",null,null,-1),rr={class:"control"},tr={setup(d){const n=P(!1),s=$(),a=P(!1),o=P(),t=z({currentPassword:null,newPassword:null,passwordConfirmation:null}),r=()=>{t.newPassword!==t.passwordConfirmation?n.value=!0:n.value=!1},m=async()=>{a.value=!0;const l=await s.dispatch("changePassword",t);if(!l.success){V.danger(l.message,4e3);return}V.success(l.message,4e3),o.value.reset()};return(l,_)=>(f(),B(Y,{title:"Actualizar contrase\xF1a",icon:"lock"},{default:O(()=>[e("form",{class:"form",onSubmit:se(m,["prevent"]),ref_key:"formPass",ref:o},[c(W,{label:"Contrase\xF1a actual",message:"Required. Your current password"},{default:O(()=>[v(e("input",{class:"input","onUpdate:modelValue":_[0]||(_[0]=E=>i(t).currentPassword=E),type:"password",required:""},null,512),[[I,i(t).currentPassword]])]),_:1}),sr,c(W,{label:"Nueva Contrase\xF1a",message:"Required. New password"},{default:O(()=>[v(e("input",{class:j(["input",{"is-danger":n.value}]),onBlur:_[1]||(_[1]=E=>r()),"onUpdate:modelValue":_[2]||(_[2]=E=>i(t).newPassword=E),type:"password",required:""},null,34),[[I,i(t).newPassword]]),n.value?(f(),D("span",or,"Las contrase\xF1as no coinciden")):F("",!0)]),_:1}),c(W,{label:"Confirmar contrase\xF1a",message:"Required. New password one more time"},{default:O(()=>[v(e("input",{class:j(["input",{"is-danger":n.value}]),onBlur:_[3]||(_[3]=E=>r()),"onUpdate:modelValue":_[4]||(_[4]=E=>i(t).passwordConfirmation=E),type:"password",required:""},null,34),[[I,i(t).passwordConfirmation]]),n.value?(f(),D("span",nr,"Las contrase\xF1as no coinciden")):F("",!0)]),_:1}),ar,c(W,null,{default:O(()=>[e("div",rr,[e("button",{class:j(["button is-primary",{isLoading:a.value}])}," Cambiar contrase\xF1a ",2)])]),_:1})],40,er)]),_:1}))}};const ir={class:"profile"},lr={setup(d){return(n,s)=>(f(),D("div",ir,[c(Ya),c(tr)]))}},pr={class:"code-sold-product"},mr={class:"name-sold-product"},dr={class:"price-sold-product"},cr={class:"control quantity-sold-product"},_r={class:"mount-sold-product"},ur={class:"p-1",style:{width:"1rem"}},Cr=x({props:{product:Object},emits:["quit"],setup(d,{emit:n}){const s=d,a=z(s.product);return H(()=>{a.quantity=a.quantity<1?1:a.quantity,a.mount=a.quantity*a.priceSale}),(o,t)=>(f(),D("tr",null,[e("td",pr,U(i(a).code),1),e("td",mr,U(i(a).name),1),e("td",dr,"S/. "+U(i(a).priceSale),1),e("td",cr,[v(e("input",{class:"input is-upper",type:"number",min:"1",onClick:t[0]||(t[0]=r=>r.target.select()),placeholder:"Cantidad","onUpdate:modelValue":t[1]||(t[1]=r=>i(a).quantity=r)},null,512),[[I,i(a).quantity]])]),e("td",_r,"S/. "+U(i(a).mount),1),e("td",ur,[e("button",{type:"button",class:"button is-danger p-2 m-0",onClick:t[2]||(t[2]=r=>n("quit",s.product.id))},[c(i(N),{size:"15"},{default:O(()=>[c(i(je))]),_:1})])])]))}}),Pr={key:0,class:"modal is-active"},Sr=e("div",{class:"modal-background"},null,-1),gr={class:"modal-card"},fr={class:"modal-card-head"},Er=e("p",{class:"modal-card-title"},"Agregar producto manual",-1),Rr={class:"modal-card-body"},Or={class:"field"},Ar=e("label",{class:"label"},"Nombre del producto",-1),Dr={class:"control"},hr={class:"field is-horizontal"},Ur={class:"field-body"},vr={class:"field"},br=e("label",{class:"label"},"Precio",-1),Ir={class:"control"},Lr={class:"field"},Tr=e("label",{class:"label"},"Cantidad",-1),yr={class:"control"},Mr={class:"modal-card-foot"},Fr=x({props:{show:Boolean},emits:["addProduct","hide"],setup(d,{emit:n}){const s=d,a=P(s.show),o=z({id:"MP"+Date.now(),code:"MP"+Date.now(),name:"",priceSale:0,quantity:1}),t=()=>{o.name=o.name.toLocaleUpperCase(),n("addProduct",o),o.id="MP"+Date.now(),o.code="MP"+Date.now(),o.name="",o.priceSale=0,o.quantity=1,n("hide")};return H(()=>{a.value=s.show}),(r,m)=>a.value?(f(),D("div",Pr,[Sr,e("div",gr,[e("header",fr,[Er,e("button",{class:"delete","aria-label":"close",onClick:m[0]||(m[0]=l=>n("hide"))})]),e("section",Rr,[e("div",Or,[Ar,e("p",Dr,[v(e("input",{class:"input is-upper",placeholder:"NOMBRE","onUpdate:modelValue":m[1]||(m[1]=l=>i(o).name=l)},null,512),[[I,i(o).name]])])]),e("div",hr,[e("div",Ur,[e("div",vr,[br,e("p",Ir,[v(e("input",{class:"input is-upper",placeholder:"Precio",min:"0.1",step:"0.01","onUpdate:modelValue":m[2]||(m[2]=l=>i(o).priceSale=l)},null,512),[[I,i(o).priceSale]])])]),e("div",Lr,[Tr,e("p",yr,[v(e("input",{class:"input is-upper",placeholder:"Precio",min:"0.1",step:"0.01","onUpdate:modelValue":m[3]||(m[3]=l=>i(o).quantity=l)},null,512),[[I,i(o).quantity]])])])])])]),e("footer",Mr,[e("button",{onClick:m[4]||(m[4]=l=>t()),class:"button is-success"},"Agregar producto"),e("button",{onClick:m[5]||(m[5]=l=>n("hide")),class:"button"},"Cancelar")])])])):F("",!0)}}),wr={key:0,class:"modal is-active"},Nr=e("div",{class:"modal-background"},null,-1),kr={class:"modal-card"},xr={class:"modal-card-head"},Wr=e("p",{class:"modal-card-title"},"Nueva Venta",-1),Vr={class:"modal-card-body"},Gr={style:{display:"none"}},$r={key:0,class:"column"},jr={class:"field is-horizontal"},Hr={class:"field-body"},Br={class:"field has-addons"},Kr={class:"control"},Xr={class:"select"},Jr=["disabled"],qr=["value"],zr={class:"control"},Zr=["placeholder"],Qr={class:"field"},Yr={class:"control is-expanded"},et=["disabled"],st={key:0,class:"field"},ot={class:"control is-expanded"},nt={class:"modal-card-foot"},at=["disabled"],rt=x({props:{show:Boolean,client:Object,loading:{type:Boolean,default:!1}},emits:["save","hide"],setup(d,{emit:n}){const s=d,a=$(),o=P(s.show),t=P(s.loading),r=P("ticket"),m=[{code:1,name:"DNI",length:8},{code:4,name:"CARNET DE EXTRANGERIA",length:12},{code:6,name:"RUC",length:11},{code:7,name:"PASAPORTE",length:12}],l=z(s.client);H(()=>{o.value=s.show}),H(()=>{t.value=s.loading}),H(()=>{l.documentType=1,l.document="",l.name="",l.email="",r.value==="factura"&&(l.documentType=6,l.document="",l.name="")});const _=ee(()=>m.find(u=>u.code===l.documentType)),E=async()=>{if(_.value.code!==1&&_.value.code!==6)return;if((""+l.document).length!==_.value.length){l.name="";return}const u=await a.dispatch("getInfoDoc",{typeDoc:_.value.code,document:l.document});if(u===null||u.error){V.warning("Este numero de "+_.value.name+" no existe");return}l.name=u.nombre},C=()=>{if(r.value!=="ticket"){if(l.document===""||l.name===""){V.warning("El documento o el nombre no puede ser vacio");return}if(r.value==="factura"&&l.email===""){V.warning("Se nesesita un email para emitir factura");return}}n("save",r.value)},S=()=>{l.document=l.document.replace(/\D/,""),l.document.length>_.value.length&&(l.document=l.document.slice(0,_.value.length))};return(u,h)=>o.value?(f(),D("div",wr,[Nr,e("div",kr,[e("header",xr,[Wr,e("button",{class:"delete","aria-label":"close",onClick:h[0]||(h[0]=R=>n("hide"))})]),e("section",Vr,[e("label",{for:"ticket",class:j(["button",{"is-primary":r.value==="ticket"}])},"Ticket",2),e("label",{for:"boleta",class:j(["button",{"is-primary":r.value==="boleta"}])},"Boleta",2),e("label",{for:"factura",class:j(["button",{"is-primary":r.value==="factura"}])},"Factura",2),e("div",Gr,[v(e("input",{type:"radio","onUpdate:modelValue":h[1]||(h[1]=R=>r.value=R),id:"boleta",value:"boleta"},null,512),[[ue,r.value]]),v(e("input",{type:"radio","onUpdate:modelValue":h[2]||(h[2]=R=>r.value=R),id:"factura",value:"factura"},null,512),[[ue,r.value]]),v(e("input",{type:"radio","onUpdate:modelValue":h[3]||(h[3]=R=>r.value=R),id:"ticket",value:"ticket"},null,512),[[ue,r.value]])]),r.value!=="ticket"?(f(),D("div",$r,[e("div",jr,[e("div",Hr,[e("div",Br,[e("p",Kr,[e("span",Xr,[v(e("select",{"onUpdate:modelValue":h[4]||(h[4]=R=>i(l).documentType=R),disabled:r.value==="factura"},[(f(),D(G,null,Z(m,R=>e("option",{key:R.code,value:R.code},U(R.name),9,qr)),64))],8,Jr),[[_e,i(l).documentType]])])]),e("p",zr,[v(e("input",{class:"input is-upper",placeholder:i(_).name,onInput:h[5]||(h[5]=R=>(S(),E())),"onUpdate:modelValue":h[6]||(h[6]=R=>i(l).document=R)},null,40,Zr),[[I,i(l).document]])])])])]),e("div",Qr,[e("p",Yr,[v(e("input",{class:"input is-upper",placeholder:"nombre",type:"text","onUpdate:modelValue":h[7]||(h[7]=R=>i(l).name=R),disabled:i(l).documentType===6||i(l).documentType===1},null,8,et),[[I,i(l).name]])])]),r.value==="factura"?(f(),D("div",st,[e("p",ot,[v(e("input",{class:"input",placeholder:"Email",type:"text","onUpdate:modelValue":h[8]||(h[8]=R=>i(l).email=R)},null,512),[[I,i(l).email]])])])):F("",!0)])):F("",!0)]),e("footer",nt,[e("button",{disabled:t.value,onClick:h[9]||(h[9]=R=>C()),class:"button is-success"},"Guardar e Imprimir "+U(r.value),9,at),e("button",{onClick:h[10]||(h[10]=R=>n("hide")),class:"button"},"Cancelar")])])])):F("",!0)}});const tt={class:"responsive-container"},it={class:"field"},lt={class:"label"},pt={class:"control"},mt=["disabled"],dt={class:"field"},ct={class:"field"},_t={class:"table is-bordered is-striped is-fullwidth"},ut=e("thead",null,[e("tr",null,[e("th",{class:"code-sold-product"},"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",{class:"quantity-sold-product"},"Cant"),e("th",{class:"mount-sold-product"},"Monto"),e("th")])],-1),Ct={colspan:"20",style:{"text-align":"center"}},Pt=e("div",null,null,-1),St=["disabled"],gt={style:{display:"none"}},ft=["srcdoc"],Et=x({setup(d){const n=$(),s=P(""),a=P(),o=P(!1),t=P([]),r=P(""),m=P(!1),l=P(!1),_=P(!1),E=z({documentType:1,document:"0",name:"",email:""}),C=ee(()=>`
  <html>
  <head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300&display=swap" rel="stylesheet">
   <style>
  pre{
    font-family: 'Roboto Mono', monospace;
    font-weight: bold;
    padding:1rem;
    width:460px
    
  }
  </style></head>
  <body>
 
  <pre >
      ${u.value}
  </pre>
  </body>
  </html>
  `),S=g=>{if(g<=0)return"";let p="";for(let A=0;A<g;A++)p+=" ";return p},u=ee(()=>`
            INVERSIONES VILVER E.I.R.L
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba   

    BOLETA DE VENTA ELECTRONICA 0000-0000000

Fecha de emision:2006-04-09
ID Venta: 0000546-5s654-sds645-sds65

DNI Cliente:${E.document}
Nombre Cliente:${E.name}
${r.value}
                 Subtotal:           S/${Math.round((w.value*(100/118)+Number.EPSILON)*10)/10}
                 IGV(18%):           S/${Math.round((w.value*(18/118)+Number.EPSILON)*10)/10}
                 Total:              S/${w.value}
------------------------------------------------  `),h=g=>{let p="";for(let A=0;A<8-g.toString().length;A++)p+="0";return p+g.toString()},R=()=>{E.documentType=1,E.document="0",E.name="",E.email="",t.value=[]},L=(g,p,A,b,T=[])=>{let X=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return p==="ticket"?X+=`
              TICKET DE VENTA ELECTRONICO 
      `:X+=`
         ${p.toLocaleUpperCase()} ELECTRONICA ${T.serie}-${h(T.correlative)}
      `,X+=`
Fecha de emision:${p!=="ticket"?T.dateTime:A.dateTime}
ID Venta: 00000${A.id}
  `,p!=="ticket"&&(X+=`
CLIENTE:
Documento: ${b.document}
Nombre: ${b.name}
`),X+=K(t.value),X+=`
                OP.GRAVADAS:        S/ ${Math.round((A.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((A.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${A.total}
------------------------------------------------ 
${g}

************************************************
            !GRACIAS POR SU COMPRA!
`,X},K=g=>{let p="",A="",b=`
------------------------------------------------
`;return b+=`PRODUCTO                 CANT P.UNI   MONTO
`,b+=`------------------------------------------------
`,g.forEach(T=>{p=T.name.slice(0,24)+S(24-T.name.length),p+="  ",p+=""+T.quantity+S(3-(""+T.quantity).length),p+=" S/",p+=""+T.priceSale+S(6-(""+T.priceSale).length),p+=" S/",p+=""+T.mount+S(7-(""+T.mount).length),b+=`${p}
`,T.name.length>24&&(A=T.name.slice(24,48),b+=`${A}
`),T.name.length>48&&(A=T.name.length>72?T.name.slice(48,72)+"...":T.name.slice(48),b+=`${A}
`)}),b+=`------------------------------------------------
`,b},w=ee(()=>t.value.reduce((g,p)=>g+p.mount,0)),y=g=>n.state.products.find(({code:A})=>A.toString()===s.value),k=({id:g,code:p,name:A,priceSale:b,quantity:T})=>{const X={id:g,code:p,name:A,priceSale:b,quantity:T!=null?T:1,mount:b*1};if(t.value.every(oe=>oe.id!==g))t.value.push(X);else{const oe=t.value.findIndex(De=>De.id===g);t.value[oe].quantity+=1,t.value[oe].mount=X.priceSale*t.value[oe].quantity}t.value.length===0&&t.value.push(X),s.value=""},Q=g=>{const p=t.value.findIndex(A=>A.id===g);t.value.splice(p,1)};q(async()=>{try{await n.dispatch("fetchProducts");const p=await(await fetch("http://localhost:5050/devices")).json()}catch{V.danger("No se encuentra el controlador de la impresora por favor inicie el controlador y configure la impresora")}});const J=()=>{const g=s.value;setTimeout(()=>{if(s.value===g){const p=y(s.value);p&&k(p),s.value=""}},100)},te=async g=>{l.value=!0;const p=await n.dispatch("saveSale",{soldProducts:t.value,client:E,typeProof:g});let A="",b="";if(g!=="ticket"){const T=p.proof.data;A=L(p.legend,g,p.sale,p.client,T),b=`20605808931|${g.value==="boleta"?"03":"01"}|${T.value.serie}|${h(T.correlative)}|${Math.round((p.sale.total*(18/118)+Number.EPSILON)*10)/10}|${p.sale.total}|${T.value.dateTime.slice(0,10)}|0${p.client.documentType}|${p.client.document}`}else A=L(p.legend,g,p.sale,p.client,[]);console.log(A);try{A=A.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),await n.dispatch("printerTicket",{text:A,qrContent:b}),l.value=!1}catch{l.value=!1,V.warning("La venta se ha registrado exitosamente, pero no se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",6e3)}finally{R(),m.value=!1}},ie=()=>{s.value="",a.value.focus()},M=()=>{if(t.value.some(g=>g.priceSale===0)){V.danger("Los precios no pueden ser cero",3e3);return}m.value=!0};return(g,p)=>(f(),D(G,null,[c(rt,{show:m.value,onHide:p[0]||(p[0]=A=>m.value=!1),client:i(E),onSave:p[1]||(p[1]=A=>te(A)),loading:l.value},null,8,["show","client","loading"]),c(Fr,{show:_.value,onHide:p[2]||(p[2]=A=>_.value=!1),onAddProduct:p[3]||(p[3]=A=>k(A))},null,8,["show"]),e("div",tt,[c(Y,{title:"Agrgar producto a la venta",class:"add-sold-product"},{default:O(()=>[v(e("input",{required:"",autocomplete:"off",onInput:p[4]||(p[4]=A=>J()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:p[5]||(p[5]=A=>A.target.blur()),onBlur:p[6]||(p[6]=A=>o.value=!1),onFocus:p[7]||(p[7]=A=>o.value=!0),ref_key:"fieldCode",ref:a,"onUpdate:modelValue":p[8]||(p[8]=A=>s.value=A)},null,544),[[I,s.value]]),e("div",it,[e("label",lt,"Codigo "+U(": "+s.value),1),e("div",pt,[e("button",{tabindex:"-1",class:"button is-success",disabled:o.value,type:"button",onClick:p[9]||(p[9]=A=>ie())},U(o.value?"Escaneando codigos...":"Escanear codigos"),9,mt)])]),e("div",dt,[e("input",{type:"button",class:"button is-info",onClick:p[10]||(p[10]=A=>_.value=!0),value:"Agregar producto manualmente"})]),e("div",ct,[c(Re,{onItemSelected:p[11]||(p[11]=A=>k(A))})])]),_:1}),c(Y,{title:"Productos a vender",class:"sold-products"},{default:O(()=>[e("table",_t,[ut,e("tbody",null,[(f(!0),D(G,null,Z(t.value,A=>(f(),B(Cr,{key:A.id,product:A,onQuit:p[12]||(p[12]=b=>Q(b))},null,8,["product"]))),128)),e("tr",null,[e("th",Ct,"TOTAL: S/. "+U(i(w)),1)])])]),Pt,e("button",{disabled:t.value.length===0,onClick:p[13]||(p[13]=A=>M()),class:"button is-primary"},"Realizar venta",8,St)]),_:1}),e("div",gt,[e("iframe",{style:{width:"550px",height:"900px",padding:"0"},name:"page-printer",srcdoc:i(C)},null,8,ft)])])],64))}});const Rt={class:"columns"},Ot={class:"column is-11"},At={class:"control has-icons-left"},Dt={class:"column is-1"},ht={class:"h-100 oy-scroll"},Ut={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},vt=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"ID"),e("th",null,"Nombres"),e("th",null,"Usuario"),e("th",null,"Email"),e("th",null,"DNI"),e("th",null,"Celular"),e("th")])],-1),bt={style:{"padding-top":"2px"}},It=["onClick"],Lt=x({setup(d){const n=$(),s=P([]),a=P([]),o=P(""),t=P(!1),r=P(0);q(async()=>{const _=await n.dispatch("fetchUsers");if(!_.success){V.danger(_.message,4e3);return}s.value=_.data.reverse(),a.value=s.value});const m=()=>{const _=o.value.toLowerCase();a.value=s.value.filter(E=>E.fullName.toLowerCase().includes(_)||E.userName.toString().toLowerCase().includes(_))},l=async()=>{const _=await n.dispatch("fetchUsers");s.value=_.data.reverse(),a.value=s.value};return(_,E)=>(f(),D(G,null,[e("div",Rt,[e("div",Ot,[e("div",At,[v(e("input",{class:"input",type:"search",onInput:E[0]||(E[0]=C=>m()),"onUpdate:modelValue":E[1]||(E[1]=C=>o.value=C),placeholder:"Buscar por nombre o documento"},null,544),[[I,o.value,void 0,{trim:!0}]]),c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(me))]),_:1})])]),e("div",Dt,[e("button",{class:"button is-primary",onClick:E[2]||(E[2]=C=>l())},[c(i(N),{class:"icon is-large is-left"},{default:O(()=>[c(i(de))]),_:1})])])]),e("div",ht,[e("table",Ut,[vt,e("tbody",bt,[(f(!0),D(G,null,Z(a.value,C=>(f(),D("tr",{key:C.id,class:j({"has-background-danger-light":C.enable===0})},[e("td",null,U(C.id),1),e("td",null,U(C.fullName),1),e("td",null,U(C.userName),1),e("td",null,U(C.email),1),e("td",null,U(C.dni),1),e("td",null,U(C.mobile),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:S=>(r.value=C.id,t.value=!0)},[c(i(N),null,{default:O(()=>[c(i(ce))]),_:1})],8,It)])],2))),128))])])])],64))}}),Tt=[{path:"/login",name:"login",component:sa},{path:"/profile",name:"profile",component:lr},{path:"/sales",name:"sales",component:Wn},{path:"/listSales",name:"listSales",component:Ee},{path:"/newSale",name:"newSale",component:Et},{path:"/printers",name:"printers",component:jn},{path:"/products",name:"products",component:Fo},{path:"/newProduct",name:"newProduct",component:fe},{path:"/signup",name:"signup",component:Da},{path:"/users",name:"users",component:Lt},{path:"/barcodes",name:"barcodes",component:xa},{path:"/proofPayments",name:"proofPayments",component:Ga}],Oe=He({history:Be("vilcherrez"),routes:Tt});Oe.beforeEach(async(d,n)=>{if(!Ce.state.isAuthenticated&&d.name!=="login")return{name:"login"};if(Ce.state.isAuthenticated&&d.name==="login")return{name:"sales"}});const Ae=Ke(Ms);Ae.use(Ce).use(Oe).mount("#app");Ae.config.globalProperties.$log=console.log;
