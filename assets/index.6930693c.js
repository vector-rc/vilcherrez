import{d as W,u as K,c as Z,a as g,b as i,e as O,w as k,f as oe,g as y,h as e,r as ie,o as P,I as G,B as ge,S as Ee,i as fe,j as Re,P as Oe,k as Ae,l as C,m as Q,n as T,v as L,p as le,A as pe,F as H,q as z,t as D,E as me,s as Y,x as ne,D as de,y as X,z as ee,C as ae,G as re,H as ce,J as De,K as Ue,L as he,M as Ie,N as ve,O as be,Q as Me}from"./vendor.6a6ef53a.js";const Te=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}};Te();const Le={class:"is-fluid columns p-5"},ye={key:0,class:"column is-1"},Fe=e("span",null,"Productos",-1),Ne=e("span",null,"Ventas",-1),we=e("span",null,"Configs",-1),ke=e("span",null,"Barcodes",-1),We=e("span",null,"Usuarios",-1),xe={class:"column is-11"},Ge=W({setup(m){const a=K(),s=Z(()=>a.state.user.userName),t=Z(()=>a.state.isAuthenticated);return(n,o)=>{const r=ie("router-link"),d=ie("router-view");return P(),g("main",Le,[i(t)?(P(),g("div",ye,[O(r,{class:"item_menu",to:"/products"},{default:k(()=>[O(i(G),{size:"30"},{default:k(()=>[O(i(ge))]),_:1}),Fe]),_:1}),O(r,{class:"item_menu",to:"/sales"},{default:k(()=>[O(i(G),{size:"30"},{default:k(()=>[O(i(Ee))]),_:1}),Ne]),_:1}),O(r,{class:"item_menu",to:"/printers"},{default:k(()=>[O(i(G),{size:"30"},{default:k(()=>[O(i(fe))]),_:1}),we]),_:1}),O(r,{class:"item_menu",to:"/barcodes"},{default:k(()=>[O(i(G),{size:"30"},{default:k(()=>[O(i(Re))]),_:1}),ke]),_:1}),i(s)==="Balta"?(P(),oe(r,{key:0,class:"button is-link",to:"/signup"},{default:k(()=>[O(i(G),{size:"30"},{default:k(()=>[O(i(Oe))]),_:1}),We]),_:1})):y("",!0)])):y("",!0),e("div",xe,[O(d)])])}}});var te=Ae({state:{products:[],user:{},isAuthenticated:!1},mutations:{test(){console.log("hola desde vuex")}},actions:{async fetchProducts({state:m}){try{const s=await(await fetch("http://3.136.228.138/shop-back/api/v1/products")).json();return s.success&&(m.products=s.data.reverse()),s}catch(a){return console.log(a.type),{success:!0,message:a}}},async fetchSales({state:m}){try{return await(await fetch("http://3.136.228.138/shop-back/api/v1/sales",{headers:{Authorization:`bearer ${m.user.token} `}})).json()}catch(a){return console.log(a.type),{success:!1,message:a}}},async fetchBoletas({state:m}){try{return await(await fetch("http://3.136.228.138/shop-back/api/v1/boletas",{headers:{Authorization:`bearer ${m.user.token} `}})).json()}catch(a){return console.log(a.type),{success:!1,message:a}}},async fetchFacturas({state:m}){try{return await(await fetch("http://3.136.228.138/shop-back/api/v1/facturas",{headers:{Authorization:`bearer ${m.user.token} `}})).json()}catch(a){return console.log(a.type),{success:!1,message:a}}},async fetchSaleDetail({state:m},{id:a}){try{return await(await fetch(`http://3.136.228.138/shop-back/api/v1/saleDetail/${a}`,{headers:{Authorization:`bearer ${m.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchBoletaDetail({state:m},{id:a}){try{return await(await fetch(`http://3.136.228.138/shop-back/api/v1/boletaDetail/${a}`,{headers:{Authorization:`bearer ${m.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchFacturaDetail({state:m},{id:a}){try{return await(await fetch(`http://3.136.228.138/shop-back/api/v1/facturaDetail/${a}`,{headers:{Authorization:`bearer ${m.user.token} `}})).json()}catch(s){return console.log(s.type),{success:!1,message:s}}},async fetchPackProducts({state:m},{id:a}){try{return await(await fetch(`http://3.136.228.138/shop-back/api/v1/pack_product/${a}`,{headers:{Authorization:`bearer ${m.user.token} `}})).json()}catch(s){return{data:null,success:!0,message:s}}},async fetchRoles(){try{return await(await fetch("http://3.136.228.138/shop-back/api/v1/user_roles")).json()}catch(m){return{success:!0,message:m}}},async userLogin({state:m},{credentials:a}){try{const t=await(await fetch("http://3.136.228.138/shop-back/api/v1/login",{method:"POST",body:JSON.stringify(a)})).json();return console.log(t),t.success&&(m.user=t.data,m.isAuthenticated=t.success,localStorage.token=t.data.token),t}catch(s){return console.log(s),{success:!1,message:s}}},async userSignup({state:m},{user:a}){try{return await(await fetch("http://3.136.228.138/shop-back/api/v1/signup",{method:"POST",body:JSON.stringify(a)})).json()}catch(s){return console.log(s),{success:!1,message:s}}},async saveProduct({state:m},{action:a,product:s}){try{const n=await(await fetch("http://3.136.228.138/shop-back/api/v1/product",{method:a==="add"?"POST":"PUT",headers:{Authorization:`bearer ${m.user.token} `},body:JSON.stringify(s)})).json();if(n.success&&(a==="add"&&m.products.unshift(n.data),a==="edit")){const o=m.products.findIndex(r=>r.id===s.id);console.log(o),m.products[o]=n.data}return n}catch{}},async savePackingProduct({state:m},{action:a,data:s}){console.log({action:a});try{return await(await fetch("http://3.136.228.138/shop-back/api/v1/product",{method:a==="add"?"POST":"PUT",headers:{Authorization:`bearer ${m.user.token} `},body:JSON.stringify(s)})).json()}catch{}},async printerTicket(m,{text:a}){return await(await fetch(`http://localhost:5050/printer/${localStorage.printer}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a,qr_content:"hola mundo"})})).text()},async testEncode(m,{text:a}){return await(await fetch("http://localhost:5050/decodeurl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:a,qr_content:"hola mundo"})})).text()},async getInfoDoc({state:m},{typeDoc:a,document:s}){let t;return console.log(a),a===1&&(t=await fetch(`http://3.136.228.138/shop-back/api/v1/dni/${s}`,{headers:{Authorization:`bearer ${m.user.token} `}})),a===6&&(t=await fetch(`http://3.136.228.138/shop-back/api/v1/ruc/${s}`,{headers:{Authorization:`bearer ${m.user.token} `}})),(await t.json()).data},async saveSale({state:m},{soldProducts:a,client:s,typeProof:t}){return(await(await fetch("http://3.136.228.138/shop-back/api/v1/sale",{method:"POST",headers:{Authorization:`bearer ${m.user.token} `},body:JSON.stringify({soldProducts:a,client:s,userId:m.user.id,typeProof:t})})).json()).data}},modules:{}});const Ve={class:"columns"},je={class:"column is-11"},$e={class:"control has-icons-left"},He={class:"column is-1"},Be={class:"h-100 oy-scroll"},Ke={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Xe=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th")])],-1),Je={style:{"padding-top":"2px"}},qe=["onClick"],ze=["onClick"],Ye=W({emits:["editProduct"],setup(m,{emit:a}){const s=K(),t=C([]),n=C([]),o=C("");Q(async()=>{t.value=s.state.products,n.value=s.state.products});const r=()=>{const c=o.value.toLowerCase().split(" "),_=[];c.forEach((E,I)=>{if(E.length<2)return;t.value.filter(({name:A,code:v})=>A.toLowerCase().includes(E)||v.toString().toLowerCase().includes(E)).forEach((A,v)=>{if(_.length===0){_.push(A);return}if(_.every(({id:j})=>j!==A.id))_.push(A);else{const j=_.findIndex(({id:J})=>J===A.id);_.splice(j,1),_.unshift(A)}})}),n.value=_},d=l=>{console.log("hola")},f=l=>{navigator.clipboard.writeText(l.name)},u=async()=>{await s.dispatch("fetchProducts"),t.value=s.state.products,n.value=s.state.products};return(l,c)=>(P(),g(H,null,[e("div",Ve,[e("div",je,[e("div",$e,[T(e("input",{class:"input",type:"search",onInput:c[0]||(c[0]=_=>r()),"onUpdate:modelValue":c[1]||(c[1]=_=>o.value=_),placeholder:"Buscar producto"},null,544),[[L,o.value,void 0,{trim:!0}]]),O(i(G),{class:"icon is-large is-left"},{default:k(()=>[O(i(le))]),_:1})])]),e("div",He,[e("button",{class:"button is-primary",onClick:c[2]||(c[2]=_=>u())},[O(i(G),{class:"icon is-large is-left"},{default:k(()=>[O(i(pe))]),_:1})])])]),e("div",Be,[e("table",Ke,[Xe,e("tbody",Je,[(P(!0),g(H,null,z(n.value,_=>(P(),g("tr",{key:_.id},[e("td",null,D(_.code),1),e("td",{style:{cursor:"copy"},onClick:E=>f(_)},D(_.name),9,qe),e("td",null,"S/."+D(_.priceSale),1),e("td",null,D(_.stock),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:E=>(d(),a("editProduct",_.productId))},[O(i(G),null,{default:k(()=>[O(i(me))]),_:1})],8,ze)])]))),128))])])])],64))}}),Ze={class:"control"},Qe={key:0,class:"help is-danger"},es=["disabled","value"],ss={class:"control"},os={class:"control"},ns={class:"control"},as={class:"control"},rs={class:"control"},ts=W({props:{product:Object},emits:["quit"],setup(m,{emit:a}){const s=m,t=K(),n=Y(s.product),o=C(!1),r=C(!1),d=C(),f=()=>{if(n.priceBuy===0)return;let _=0;switch(n.packing.toLocaleUpperCase()){case"UND":_=.5;break;case"10 UND":_=.25;break;case"12 UND":_=.25;break;case"100 UND":_=.15;break}if(_!==0){const E=n.priceBuy+n.priceBuy*_;n.packing==="UND"?n.priceSale=Math.round((E+Number.EPSILON)*10)/10:n.priceSale=Math.ceil(E)}},u=()=>{const _=n.code;setTimeout(()=>{n.code===_&&d.value.blur()},100)};n.productId;const l=()=>(n.productId!==void 0?r.value=t.state.products.some(({code:_,productId:E})=>_.toString()===n.code&&E!==n.productId):r.value=t.state.products.some(({code:_})=>_.toString()===n.code),o.value=!1,r.value),c=()=>{n.code="",r.value=!1,d.value.focus()};return(_,E)=>(P(),g("tr",null,[e("td",Ze,[T(e("input",{autocomplete:"off",onInput:E[0]||(E[0]=I=>u()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:E[1]||(E[1]=I=>I.target.blur()),onBlur:E[2]||(E[2]=I=>l()),onFocus:E[3]||(E[3]=I=>o.value=!0),ref_key:"codeField",ref:d,"onUpdate:modelValue":E[4]||(E[4]=I=>i(n).code=I)},null,544),[[L,i(n).code]]),r.value?(P(),g("span",Qe,"Ya hay un producto con este codigo")):y("",!0),ne(" "+D(i(n).code)+" ",1),e("input",{type:"button",onClick:E[5]||(E[5]=I=>c()),disabled:o.value,value:o.value?"Esperando escaneo...":"Escanear codigo",class:"button is-info"},null,8,es)]),e("td",ss,[T(e("input",{class:"input is-upper",placeholder:"10UND","onUpdate:modelValue":E[6]||(E[6]=I=>i(n).packing=I)},null,512),[[L,i(n).packing]])]),e("td",os,[T(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"precio de compra","onUpdate:modelValue":E[7]||(E[7]=I=>i(n).priceBuy=I),onInput:E[8]||(E[8]=I=>f())},null,544),[[L,i(n).priceBuy]])]),e("td",ns,[T(e("input",{class:"input is-upper",type:"number",step:"0.01",placeholder:"Precio de Venta","onUpdate:modelValue":E[9]||(E[9]=I=>i(n).priceSale=I)},null,512),[[L,i(n).priceSale]])]),e("td",as,[T(e("input",{class:"input is-upper",type:"number",placeholder:"Cantidad","onUpdate:modelValue":E[10]||(E[10]=I=>i(n).stock=I)},null,512),[[L,i(n).stock]])]),e("td",rs,[e("button",{type:"button",class:"button is-danger",onClick:E[11]||(E[11]=I=>a("quit",s.product.id))},[O(i(G),{size:"25"},{default:k(()=>[O(i(de))]),_:1})])])]))}}),is={key:0,class:"modal is-active"},ls=e("div",{class:"modal-background"},null,-1),ps={class:"modal-card"},ms={class:"modal-card-head"},ds=e("p",{class:"modal-card-title"},"Advertencia",-1),cs=e("section",{class:"modal-card-body"},"Algunos codigos estan vacios, \xBFquiere guardar de todas formas?",-1),_s={class:"modal-card-foot"},Cs={class:"field"},us={class:"control"},Ps={key:0,class:"help is-danger"},Ss={class:"table is-bordered"},gs=e("th",null,"CODIGO",-1),Es=e("th",null,"PACKING",-1),fs=e("th",null,"PRECIO DE COMPRA",-1),Rs=e("th",null,"PRECIO DE VENTA",-1),Os=e("th",null,"CANTIDAD",-1),As=e("button",{class:"button is-primary"},"Guardar producto",-1),Ds={key:1,class:"notification is-success"},Us=e("button",{class:"delete"},null,-1),hs=ne(" Producto guardado con exito "),Is=[Us,hs],vs=W({props:{productId:{type:Number,default:-1}},emits:["cancelEdit"],setup(m,{emit:a}){const s=m,t=K(),n=C(),o=C(!1),r=C(),d=C(!1),f=C(!1),u=Y({id:0,name:"",brand:"",tags:"",description:"",features:{},image:""}),l=C([]),c=C([{id:"V"+Date.now()+1,code:"",packing:"UND",measureUnit:"NIU",priceSale:0,priceBuy:0,stock:0},{id:"V"+Date.now()+2,code:"",packing:"12 UND",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0},{id:"V"+Date.now()+3,code:"",packing:"100 UND",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0}]),_=()=>{c.value=[{id:"V"+Date.now()+1,code:"",packing:"UND",measureUnit:"NIU",priceSale:0,priceBuy:0,stock:0},{id:"V"+Date.now()+2,code:"",packing:"12 UND",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0},{id:"V"+Date.now()+3,code:"",packing:"100 UND",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0}],u.name="",u.brand="",u.tags="",u.features={},u.description="",u.image="",a("cancelEdit")};X(async()=>{if(s.productId!==-1){const F=await t.dispatch("fetchPackProducts",{id:s.productId});c.value=F.data.packedProducts,u.name=F.data.product.name,u.id=F.data.product.id}else _()});const E=()=>{c.value.push({id:"V"+Date.now(),code:"",packing:"",measureUnit:"BX",priceSale:0,priceBuy:0,stock:0})},I=F=>{if(c.value.length===1)return;const b=c.value.findIndex(R=>R.id===F);c.value.splice(b,1)},V=()=>(s.productId!==-1?o.value=t.state.products.some(({name:F,productId:b})=>F.toLowerCase()===u.name.toLowerCase()&&b!==u.id):o.value=t.state.products.some(({name:F})=>F.toLowerCase()===u.name.toLowerCase()),o.value),A=async()=>{if(o.value)return;f.value=!1;const F={action:s.productId!==-1?"edit":"add",data:{product:u,packedProducts:[...c.value]}};(await t.dispatch("savePackingProduct",F)).success&&(_(),j())},v=()=>{n.value.select()},j=()=>{d.value=!0,setTimeout(()=>{d.value=!1},2e3)},J=async()=>{const F={action:s.productId!==-1?"edit":"add",data:{product:u,packedProducts:[...c.value]}};if(V())return;if(c.value.some(R=>R.code==="")){f.value=!0;return}(await t.dispatch("savePackingProduct",F)).success&&(_(),j())};return(F,b)=>(P(),g(H,null,[f.value?(P(),g("div",is,[ls,e("div",ps,[e("header",ms,[ds,e("button",{class:"delete","aria-label":"close",onClick:b[0]||(b[0]=R=>f.value=!1)})]),cs,e("footer",_s,[e("button",{onClick:b[1]||(b[1]=R=>A()),class:"button is-success"},"Guradar"),e("button",{onClick:b[2]||(b[2]=R=>f.value=!1),class:"button"},"Cancelar")])])])):y("",!0),e("form",{onSubmit:b[9]||(b[9]=ae(R=>J(),["prevent"])),ref_key:"form",ref:r,class:"box"},[e("div",Cs,[e("label",{class:"label",onClick:b[3]||(b[3]=R=>v())},"Nombre"),e("div",us,[T(e("input",{class:ee(["input upper",{"is-danger":o.value}]),onInput:b[4]||(b[4]=R=>V()),ref_key:"fieldName",ref:n,required:"","onUpdate:modelValue":b[5]||(b[5]=R=>i(u).name=R),type:"text",placeholder:"Nombre"},null,34),[[L,i(u).name,void 0,{trim:!0}]]),o.value?(P(),g("span",Ps,"Ya existe un producto con este nombre")):y("",!0)])]),e("table",Ss,[e("thead",null,[e("tr",null,[gs,Es,fs,Rs,Os,e("th",null,[e("button",{type:"button",class:"button is-info",onClick:b[6]||(b[6]=R=>E())},"+")])])]),e("tbody",null,[(P(!0),g(H,null,z(c.value,(R,h)=>(P(),oe(ts,{key:R.id,product:R,onQuit:b[7]||(b[7]=U=>I(U)),ref_for:!0,ref:U=>{U&&(l.value[h]=U)}},null,8,["product"]))),128))])]),As,s.productId!==-1?(P(),g("button",{key:0,type:"button",onClick:b[8]||(b[8]=R=>a("cancelEdit")),class:"button is-danger"},"Cancelar")):y("",!0)],544),d.value?(P(),g("div",Ds,Is)):y("",!0)],64))}}),bs={class:"columns"},Ms={class:"column is-6"},Ts={class:"column is-6"},Ls=W({setup(m){const a=C(-1),s=n=>{a.value=n},t=()=>{a.value=-1};return(n,o)=>(P(),g("div",bs,[e("div",Ms,[O(vs,{"product-id":a.value,onCancelEdit:o[0]||(o[0]=r=>t())},null,8,["product-id"])]),e("div",Ts,[O(Ye,{onEditProduct:o[1]||(o[1]=r=>s(r))})])]))}}),ys={class:"menu"},Fs={class:"menu-list"},Ns=["onClick"],_e=W({emits:["itemSelected"],setup(m,{emit:a}){const s=K(),t=C([]),n=C([]),o=C("");Q(async()=>{await s.dispatch("fetchProducts"),t.value=s.state.products});const r=()=>{if(o.value===""){n.value=[];return}const d=o.value.toLowerCase();n.value=t.value.filter(({name:f,code:u})=>f.toLowerCase().includes(d)||u.toString().toLowerCase().includes(d))};return(d,f)=>(P(),g("div",ys,[T(e("input",{class:"input upper",type:"search",onInput:f[0]||(f[0]=u=>r()),"onUpdate:modelValue":f[1]||(f[1]=u=>o.value=u),placeholder:"Buscar producto"},null,544),[[L,o.value,void 0,{trim:!0}]]),e("ul",Fs,[(P(!0),g(H,null,z(n.value,u=>(P(),g("li",{onClick:l=>a("itemSelected",u),key:u.id},D(u.name),9,Ns))),128))])]))}}),ws={class:"control",style:{width:"6.5rem"}},ks={class:"control"},Ws=W({props:{product:Object},emits:["quit"],setup(m,{emit:a}){const s=m,t=Y(s.product);return X(()=>{t.quantity=t.quantity<1?1:t.quantity,t.mount=t.quantity*t.priceSale}),(n,o)=>(P(),g("tr",null,[e("td",null,D(i(t).code),1),e("td",null,D(i(t).name),1),e("td",null,"S/. "+D(i(t).priceSale),1),e("td",ws,[T(e("input",{class:"input is-upper",type:"number",min:"1",onClick:o[0]||(o[0]=r=>r.target.select()),placeholder:"Cantidad","onUpdate:modelValue":o[1]||(o[1]=r=>i(t).quantity=r)},null,512),[[L,i(t).quantity]])]),e("td",null,"S/. "+D(i(t).mount),1),e("td",ks,[e("button",{type:"button",class:"button is-danger",onClick:o[2]||(o[2]=r=>a("quit",s.product.id))},[O(i(G),null,{default:k(()=>[O(i(de))]),_:1})])])]))}}),xs={key:0,class:"modal is-active"},Gs=e("div",{class:"modal-background"},null,-1),Vs={class:"modal-card"},js={class:"modal-card-head"},$s=e("p",{class:"modal-card-title"},"Agregar producto manual",-1),Hs={class:"modal-card-body"},Bs={class:"field is-horizontal"},Ks=e("div",{class:"field-label is-normal"},[e("label",{class:"label"},"Nombre del producto")],-1),Xs={class:"field-body"},Js={class:"field"},qs={class:"control"},zs={class:"field is-horizontal"},Ys=e("div",{class:"field-label is-normal"},[e("label",{class:"label"},"Precio")],-1),Zs={class:"field-body"},Qs={class:"field"},eo={class:"control",style:{width:"7rem"}},so={class:"modal-card-foot"},oo=W({props:{show:Boolean},emits:["addProduct","hide"],setup(m,{emit:a}){const s=m,t=C(s.show),n=Y({id:"MP"+Date.now(),code:"MP"+Date.now(),name:"",priceSale:0,quantity:1}),o=()=>{a("addProduct",n),n.id="MP"+Date.now(),n.code="MP"+Date.now(),n.name="",n.priceSale=0,n.quantity=1,a("hide")};return X(()=>{t.value=s.show}),(r,d)=>t.value?(P(),g("div",xs,[Gs,e("div",Vs,[e("header",js,[$s,e("button",{class:"delete","aria-label":"close",onClick:d[0]||(d[0]=f=>a("hide"))})]),e("section",Hs,[e("div",Bs,[Ks,e("div",Xs,[e("div",Js,[e("p",qs,[T(e("input",{class:"input is-upper",placeholder:"NOMBRE","onUpdate:modelValue":d[1]||(d[1]=f=>i(n).name=f)},null,512),[[L,i(n).name]])])])])]),e("div",zs,[Ys,e("div",Zs,[e("div",Qs,[e("p",eo,[T(e("input",{class:"input is-upper",placeholder:"Precio",min:"0.1",step:"0.01","onUpdate:modelValue":d[2]||(d[2]=f=>i(n).priceSale=f)},null,512),[[L,i(n).priceSale]])])])])])]),e("footer",so,[e("button",{onClick:d[3]||(d[3]=f=>o()),class:"button is-success"},"Agregar producto"),e("button",{onClick:d[4]||(d[4]=f=>a("hide")),class:"button"},"Cancelar")])])])):y("",!0)}}),no={key:0,class:"modal is-active"},ao=e("div",{class:"modal-background"},null,-1),ro={class:"modal-card"},to={class:"modal-card-head"},io=e("p",{class:"modal-card-title"},"Nueva Venta",-1),lo={class:"modal-card-body"},po={style:{display:"none"}},mo={key:0,class:"column"},co={class:"field is-horizontal"},_o={class:"field-body"},Co={class:"field has-addons"},uo={class:"control"},Po={class:"select"},So=["disabled"],go=["value"],Eo={class:"control"},fo=["placeholder"],Ro={class:"field"},Oo={class:"control is-expanded"},Ao=["disabled"],Do={key:0,class:"field"},Uo={class:"control is-expanded"},ho={key:1,class:"notification is-danger mt-5"},Io={class:"modal-card-foot"},vo=["disabled"],bo=W({props:{show:Boolean,client:Object,loading:{type:Boolean,default:!1}},emits:["save","hide"],setup(m,{emit:a}){const s=m,t=K(),n=C(s.show),o=C(s.loading),r=C("ticket"),d=C(!1),f=C(""),u=[{code:1,name:"DNI",length:8},{code:4,name:"CARNET DE EXTRANGERIA",length:12},{code:6,name:"RUC",length:11},{code:7,name:"PASAPORTE",length:12}],l=Y(s.client);X(()=>{n.value=s.show}),X(()=>{o.value=s.loading}),X(()=>{l.documentType=1,l.document="",l.name="",l.email="",r.value==="factura"&&(l.documentType=6,l.document="",l.name="")});const c=Z(()=>u.find(V=>V.code===l.documentType)),_=async()=>{if(!(c.value.code!==1&&c.value.code!==6)&&(""+l.document).length===c.value.length){const V=await t.dispatch("getInfoDoc",{typeDoc:c.value.code,document:l.document});l.name=V.nombre}};X(()=>{d.value&&setTimeout(()=>{d.value=!1},2500)});const E=()=>{if(r.value!=="ticket"){if(l.document===""||l.name===""){f.value="El documento o el nombre no puede ser vacio",d.value=!0;return}if(r.value==="factura"&&l.email===""){f.value="Se nesesita un email para emitir factura",d.value=!0;return}}a("save",r.value)},I=()=>{l.document=l.document.replace(/\D/,""),l.document.length>c.value.length&&(l.document=l.document.slice(0,c.value.length))};return(V,A)=>n.value?(P(),g("div",no,[ao,e("div",ro,[e("header",to,[io,e("button",{class:"delete","aria-label":"close",onClick:A[0]||(A[0]=v=>a("hide"))})]),e("section",lo,[e("label",{for:"ticket",class:ee(["button",{"is-primary":r.value==="ticket"}])},"Ticket",2),e("label",{for:"boleta",class:ee(["button",{"is-primary":r.value==="boleta"}])},"Boleta",2),e("label",{for:"factura",class:ee(["button",{"is-primary":r.value==="factura"}])},"Factura",2),e("div",po,[T(e("input",{type:"radio","onUpdate:modelValue":A[1]||(A[1]=v=>r.value=v),id:"boleta",value:"boleta"},null,512),[[re,r.value]]),T(e("input",{type:"radio","onUpdate:modelValue":A[2]||(A[2]=v=>r.value=v),id:"factura",value:"factura"},null,512),[[re,r.value]]),T(e("input",{type:"radio","onUpdate:modelValue":A[3]||(A[3]=v=>r.value=v),id:"ticket",value:"ticket"},null,512),[[re,r.value]])]),r.value!=="ticket"?(P(),g("div",mo,[e("div",co,[e("div",_o,[e("div",Co,[e("p",uo,[e("span",Po,[T(e("select",{"onUpdate:modelValue":A[4]||(A[4]=v=>i(l).documentType=v),disabled:r.value==="factura"},[(P(),g(H,null,z(u,v=>e("option",{key:v.code,value:v.code},D(v.name),9,go)),64))],8,So),[[ce,i(l).documentType]])])]),e("p",Eo,[T(e("input",{class:"input is-upper",placeholder:i(c).name,onInput:A[5]||(A[5]=v=>(I(),_())),"onUpdate:modelValue":A[6]||(A[6]=v=>i(l).document=v)},null,40,fo),[[L,i(l).document]])])])])]),e("div",Ro,[e("p",Oo,[T(e("input",{class:"input is-upper",placeholder:"nombre",type:"text","onUpdate:modelValue":A[7]||(A[7]=v=>i(l).name=v),disabled:i(l).documentType===6||i(l).documentType===1},null,8,Ao),[[L,i(l).name]])])]),r.value==="factura"?(P(),g("div",Do,[e("p",Uo,[T(e("input",{class:"input",placeholder:"Email",type:"text","onUpdate:modelValue":A[8]||(A[8]=v=>i(l).email=v)},null,512),[[L,i(l).email]])])])):y("",!0)])):y("",!0),d.value?(P(),g("div",ho,[e("button",{onClick:A[9]||(A[9]=v=>d.value=!1),class:"delete"}),ne(" "+D(f.value),1)])):y("",!0)]),e("footer",Io,[e("button",{disabled:o.value,onClick:A[10]||(A[10]=v=>E()),class:"button is-success"},"Imprimir "+D(r.value),9,vo),e("button",{onClick:A[11]||(A[11]=v=>a("hide")),class:"button"},"Cancelar")])])])):y("",!0)}}),Mo={class:"columns"},To={class:"column is-4"},Lo={class:"field"},yo={class:"label"},Fo={class:"control"},No=["disabled"],wo={class:"field"},ko={class:"field"},Wo={class:"column is-8"},xo={class:"table is-bordered is-striped is-fullwidth"},Go=e("thead",null,[e("tr",null,[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto"),e("th")])],-1),Vo=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),jo=e("th",null,null,-1),$o=e("div",null,null,-1),Ho=["disabled"],Bo={key:0,class:"notification is-danger mt-5"},Ko={style:{display:"none"}},Xo=["srcdoc"],Jo=W({setup(m){const a=K(),s=C(""),t=C(),n=C(!1),o=C([]),r=C(""),d=C(!1),f=C(!1),u=C(!1),l=C(!1),c=C(""),_=Y({documentType:1,document:"0",name:"",email:""}),E=Z(()=>`
  <html>
  <head>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300&display=swap" rel="stylesheet">
   <style>
  pre{
    font-family: 'Roboto Mono', monospace;
    font-weight: bold;
    padding:1rem;
    width:460px
    
  }
  </style></head>
  <body>
 
  <pre >
      ${V.value}
  </pre>
  </body>
  </html>
  `),I=M=>{if(M<=0)return"";let p="";for(let S=0;S<M;S++)p+=" ";return p},V=Z(()=>`
            INVERSIONES VILVER E.I.R.L
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba   

    BOLETA DE VENTA ELECTRONICA 0000-0000000

Fecha de emision:2006-04-09
ID Venta: 0000546-5s654-sds645-sds65

DNI Cliente:${_.document}
Nombre Cliente:${_.name}
${r.value}
                 Subtotal:           S/${Math.round((F.value*(100/118)+Number.EPSILON)*10)/10}
                 IGV(18%):           S/${Math.round((F.value*(18/118)+Number.EPSILON)*10)/10}
                 Total:              S/${F.value}
------------------------------------------------  `),A=M=>{let p="";for(let S=0;S<8-M.toString().length;S++)p+="0";return p+M.toString()},v=()=>{_.documentType=1,_.document="0",_.name="",_.email="",o.value=[]},j=(M,p,S,x,w=[])=>{let B=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return p==="ticket"?B+=`
              TICKET DE VENTA ELECTRONICO 
      `:B+=`
         ${p.toLocaleUpperCase()} ELECTRONICA ${w.serie}-${A(w.correlative)}
      `,B+=`
Fecha de emision:${p!=="ticket"?w.dateTime:S.dateTime}
ID Venta: 00000${S.id}
  `,p!=="ticket"&&(B+=`
CLIENTE:
Documento: ${x.document}
Nombre: ${x.name}
`),B+=J(o.value),B+=`
                OP.GRAVADAS:        S/ ${Math.round((S.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((S.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${S.total}
------------------------------------------------ 
${M}

************************************************
            !GRACIAS POR SU COMPRA!
`,B},J=M=>{let p="",S="",x=`
------------------------------------------------
`;return x+=`PRODUCTO                 CANT P.UNI   MONTO
`,x+=`------------------------------------------------
`,M.forEach(w=>{p=w.name.slice(0,24)+I(24-w.name.length),p+="  ",p+=""+w.quantity+I(3-(""+w.quantity).length),p+=" S/",p+=""+w.priceSale+I(6-(""+w.priceSale).length),p+=" S/",p+=""+w.mount+I(7-(""+w.mount).length),x+=`${p}
`,w.name.length>24&&(S=w.name.slice(24,48),x+=`${S}
`),w.name.length>48&&(S=w.name.length>72?w.name.slice(48,72)+"...":w.name.slice(48),x+=`${S}
`)}),x+=`------------------------------------------------
`,x},F=Z(()=>o.value.reduce((M,p)=>M+p.mount,0)),b=M=>a.state.products.find(({code:S})=>S.toString()===s.value),R=({id:M,code:p,name:S,priceSale:x},w=1)=>{const B={id:M,code:p,name:S,priceSale:x,quantity:w,mount:x*1};if(o.value.every(se=>se.id!==M))o.value.push(B);else{const se=o.value.findIndex(Se=>Se.id===M);o.value[se].quantity+=1,o.value[se].mount=B.priceSale*o.value[se].quantity}o.value.length===0&&o.value.push(B),s.value=""},h=M=>{const p=o.value.findIndex(S=>S.id===M);o.value.splice(p,1)};Q(async()=>{try{await a.dispatch("fetchProducts");const p=await(await fetch("http://localhost:5050/devices")).json()}catch{l.value=!0,c.value="No se encuentra el controlador de la impresora por favor inicie el controlador y configure la impresora"}});const U=()=>{const M=s.value;setTimeout(()=>{if(s.value===M){const p=b(s.value);p&&R(p),s.value=""}},100)},$=async M=>{f.value=!0;const p=await a.dispatch("saveSale",{soldProducts:o.value,client:_,typeProof:M});let S="";M!=="ticket"?p.proof.status!=="ACEPTADA"?(c.value=p.proof.description,l.value=!0,setTimeout(()=>{l.value=!1},3e3)):S=j(p.legend,M,p.sale,p.client,p.proof.data):S=j(p.legend,M,p.sale,p.client,[]),console.log(S);try{S=S.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),await a.dispatch("printerTicket",{text:S}),f.value=!1}catch{f.value=!1,c.value="No se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",l.value=!0,setTimeout(()=>{l.value=!1},4e3)}finally{v(),d.value=!1}},N=()=>{s.value="",t.value.focus()},q=()=>{if(o.value.some(M=>M.priceSale===0)){c.value="Los precios no pueden ser cero",l.value=!0,setTimeout(()=>{l.value=!1},3e3);return}d.value=!0};return(M,p)=>(P(),g(H,null,[O(bo,{show:d.value,onHide:p[0]||(p[0]=S=>d.value=!1),client:i(_),onSave:p[1]||(p[1]=S=>$(S)),loading:f.value},null,8,["show","client","loading"]),O(oo,{show:u.value,onHide:p[2]||(p[2]=S=>u.value=!1),onAddProduct:p[3]||(p[3]=S=>R(S))},null,8,["show"]),e("div",Mo,[e("div",To,[T(e("input",{required:"",autocomplete:"off",onInput:p[4]||(p[4]=S=>U()),style:{position:"absolute","pointer-events":"none",opacity:"0"},onClick:p[5]||(p[5]=S=>S.target.blur()),onBlur:p[6]||(p[6]=S=>n.value=!1),onFocus:p[7]||(p[7]=S=>n.value=!0),ref_key:"fieldCode",ref:t,"onUpdate:modelValue":p[8]||(p[8]=S=>s.value=S)},null,544),[[L,s.value]]),e("div",Lo,[e("label",yo,"Codigo "+D(": "+s.value),1),e("div",Fo,[e("button",{tabindex:"-1",class:"button is-success",disabled:n.value,type:"button",onClick:p[9]||(p[9]=S=>N())},D(n.value?"Escaneando codigos...":"Escanear codigos"),9,No)])]),e("div",wo,[e("input",{type:"button",class:"button is-info",onClick:p[10]||(p[10]=S=>u.value=!0),value:"Agregar producto manualmente"})]),e("div",ko,[O(_e,{onItemSelected:p[11]||(p[11]=S=>R(S))})])]),e("div",Wo,[e("table",xo,[Go,e("tbody",null,[(P(!0),g(H,null,z(o.value,S=>(P(),oe(Ws,{key:S.id,product:S,onQuit:p[12]||(p[12]=x=>h(x))},null,8,["product"]))),128)),e("tr",null,[Vo,e("th",null,"S/. "+D(i(F)),1),jo])])]),$o,e("button",{disabled:o.value.length===0,onClick:p[13]||(p[13]=S=>q()),class:"button is-primary"},"Realizar venta",8,Ho),l.value?(P(),g("div",Bo,[e("button",{onClick:p[14]||(p[14]=S=>l.value=!1),class:"delete"}),ne(" "+D(c.value),1)])):y("",!0)]),e("div",Ko,[e("iframe",{style:{width:"550px",height:"900px",padding:"0"},name:"page-printer",srcdoc:i(E)},null,8,Xo)])])],64))}}),qo={key:0,class:"modal is-active"},zo=e("div",{class:"modal-background"},null,-1),Yo={class:"modal-card",style:{width:"50%",height:"70%"}},Zo={class:"modal-card-head"},Qo=e("p",{class:"modal-card-title"},"Detalles de la venta",-1),en={class:"modal-card-body"},sn={key:0,class:"notification is-danger"},on={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},nn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Comprobante")])],-1),an={key:0,style:{"padding-top":"2px"}},rn=e("th",null,"Tipo",-1),tn=e("th",null,"Serie-Correlativo",-1),ln=e("th",null,"Fecha y hora de emision",-1),pn={key:1,style:{"padding-top":"2px"}},mn=e("tr",null,[e("th",null,"SIN COMPROBANTE")],-1),dn=[mn],cn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},_n=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"2",style:{"text-align":"center"}},"Cliente")])],-1),Cn={style:{"padding-top":"2px"}},un=e("th",null,"Documento",-1),Pn=e("th",null,"Nombre",-1),Sn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},gn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",{colspan:"5",style:{"text-align":"center"}},"Productos Vendidos")]),e("tr",{style:{position:"sticky"}},[e("th",null,"Codigo"),e("th",null,"Nombre"),e("th",null,"Precio"),e("th",null,"Cantidad"),e("th",null,"Monto")])],-1),En={style:{"padding-top":"2px"}},fn=e("th",{colspan:"4",style:{"text-align":"right"}},"TOTAL:",-1),Rn={class:"modal-card-foot"},On=["disabled"],An=W({props:{show:Boolean,saleId:Number},emits:["save","hide"],setup(m,{emit:a}){const s=m,t=K(),n=C(s.show),o=C("ticket"),r=C(!1),d=C(""),f=C(0),u=C({}),l=C({}),c=C({}),_=C(""),E=C(!1),I=C(!1),V=C(s.saleId),A=C([]);X(()=>{n.value=s.show}),X(async()=>{if(s.saleId===0)return;I.value=!1,V.value=s.saleId;const R=await t.dispatch("fetchSaleDetail",{id:V.value});console.log(R),I.value=!0,A.value=R.data.soldProducts,f.value=R.data.sale.total,u.value=R.data.client,l.value=R.data.proof,_.value=R.data.legend,c.value=R.data.sale,o.value=l.value===!1?"ticket":l.value.serie.startsWith("B")?"boleta":"factura"}),X(()=>{r.value&&setTimeout(()=>{r.value=!1},2500)});const v=(R,h,U,$,N=[])=>{let q=`
    INVERSIONES VILVER E.I.R.L - RUC 20605808931
      Jr. Grau Nro. 1032 Cajamarca-Cajabamba  `;return h==="ticket"?q+=`
              TICKET DE VENTA ELECTRONICO 
      `:q+=`
         ${h.toLocaleUpperCase()} ELECTRONICA ${N.serie}-${j(N.correlative)}
      `,q+=`
Fecha de emision:${h!=="ticket"?N.dateTime:U.dateTime}
ID Venta: 00000${U.id}
  `,h!=="ticket"&&(q+=`
CLIENTE:
Documento: ${$.document}
Nombre: ${$.name}
`),q+=F(A.value),q+=`
                OP.GRAVADAS:        S/ ${Math.round((U.total*(100/118)+Number.EPSILON)*10)/10}
                   IGV(18%):        S/ ${Math.round((U.total*(18/118)+Number.EPSILON)*10)/10}
                 DESCUENTOS:        S/ -0.00
              IMPORTE TOTAL:        S/ ${U.total}
------------------------------------------------ 
${R}

************************************************
            !GRACIAS POR SU COMPRA!
`,q},j=R=>{let h="";for(let U=0;U<8-R.toString().length;U++)h+="0";return h+R.toString()},J=R=>{if(R<=0)return"";let h="";for(let U=0;U<R;U++)h+=" ";return h},F=R=>{let h="",U="",$=`
------------------------------------------------
`;return $+=`PRODUCTO                 CANT P.UNI   MONTO
`,$+=`------------------------------------------------
`,R.forEach(N=>{h=N.name.slice(0,24)+J(24-N.name.length),h+="  ",h+=""+N.quantity+J(3-(""+N.quantity).length),h+=" S/",h+=""+N.price+J(6-(""+N.price).length),h+=" S/",h+=""+N.mount+J(7-(""+N.mount).length),$+=`${h}
`,N.name.length>24&&(U=N.name.slice(24,48),$+=`${U}
`),N.name.length>48&&(U=N.name.length>72?N.name.slice(48,72)+"...":N.name.slice(48),$+=`${U}
`)}),$+=`------------------------------------------------
`,$},b=async()=>{E.value=!0;let R=v(_.value,o.value,c.value,u.value,l.value);try{R=R.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),console.log(R),await t.dispatch("printerTicket",{text:R}),E.value=!1}catch{E.value=!1,d.value="No se ha podido imprimir por que la impresora esta apagada o el controlador esta desactivado",r.value=!0,setTimeout(()=>{r.value=!1},1e4)}};return(R,h)=>n.value&&I.value?(P(),g("div",qo,[zo,e("div",Yo,[e("header",Zo,[Qo,e("button",{class:"delete","aria-label":"close",onClick:h[0]||(h[0]=U=>a("hide"))})]),e("section",en,[r.value?(P(),g("div",sn,[e("button",{onClick:h[1]||(h[1]=U=>r.value=!1),class:"delete"}),ne(" "+D(d.value),1)])):y("",!0),e("table",on,[nn,l.value!==!1?(P(),g("tbody",an,[e("tr",null,[rn,e("td",null,D(o.value.toLocaleUpperCase()),1)]),e("tr",null,[tn,e("td",null,D(l.value.serie)+"-"+D(j(l.value.correlative)),1)]),e("tr",null,[ln,e("td",null,D(l.value.dateTime),1)])])):y("",!0),l.value===!1?(P(),g("tbody",pn,dn)):y("",!0)]),e("table",cn,[_n,e("tbody",Cn,[e("tr",null,[un,e("td",null,D(u.value.name),1)]),e("tr",null,[Pn,e("td",null,D(u.value.document),1)])])]),e("table",Sn,[gn,e("tbody",En,[(P(!0),g(H,null,z(A.value,U=>(P(),g("tr",{key:U.id},[e("td",null,D(U.code),1),e("td",null,D(U.name),1),e("td",null,"S/ "+D(U.price),1),e("td",null,D(U.quantity),1),e("td",null,"S/ "+D(U.mount),1)]))),128)),e("tr",null,[fn,e("th",null,"S/. "+D(f.value),1)])])])]),e("footer",Rn,[e("button",{disabled:E.value,onClick:h[2]||(h[2]=U=>b()),class:"button is-success"},"Imprimir otra vez",8,On),e("button",{onClick:h[3]||(h[3]=U=>a("hide")),class:"button"},"Cancelar")])])])):y("",!0)}});const Dn={class:"columns"},Un={class:"column is-11"},hn={class:"control has-icons-left"},In={class:"column is-1"},vn={class:"h-100 oy-scroll"},bn={class:"table is-narrow is-hoverable is-bordered is-striped is-fullwidth"},Mn=e("thead",null,[e("tr",{style:{position:"sticky"}},[e("th",null,"ID"),e("th",null,"Cliente"),e("th",null,"Documento Cliente"),e("th",null,"Fecha emision"),e("th",null,"Importe Total"),e("th")])],-1),Tn={style:{"padding-top":"2px"}},Ln=["onClick"],Ce=W({setup(m){const a=K(),s=C([]),t=C([]),n=C(""),o=C(!1),r=C(0);Q(async()=>{const u=await a.dispatch("fetchSales");s.value=u.data.reverse(),t.value=s.value});const d=()=>{const u=n.value.toLowerCase();t.value=s.value.filter(l=>l.clientName.toLowerCase().includes(u)||l.clientDocument.toString().toLowerCase().includes(u))},f=async()=>{const u=await a.dispatch("fetchSales");s.value=u.data.reverse(),t.value=s.value};return(u,l)=>(P(),g(H,null,[O(An,{saleId:r.value,show:o.value,onHide:l[0]||(l[0]=c=>o.value=!1)},null,8,["saleId","show"]),e("div",Dn,[e("div",Un,[e("div",hn,[T(e("input",{class:"input",type:"search",onInput:l[1]||(l[1]=c=>d()),"onUpdate:modelValue":l[2]||(l[2]=c=>n.value=c),placeholder:"Buscar por nombre o documento"},null,544),[[L,n.value,void 0,{trim:!0}]]),O(i(G),{class:"icon is-large is-left"},{default:k(()=>[O(i(le))]),_:1})])]),e("div",In,[e("button",{class:"button is-primary",onClick:l[3]||(l[3]=c=>f())},[O(i(G),{class:"icon is-large is-left"},{default:k(()=>[O(i(pe))]),_:1})])])]),e("div",vn,[e("table",bn,[Mn,e("tbody",Tn,[(P(!0),g(H,null,z(t.value,c=>(P(),g("tr",{key:c.id},[e("td",null,D(c.id),1),e("td",null,D(c.clientName),1),e("td",null,D(c.clientDocument),1),e("td",null,D(c.dateTime),1),e("td",null,D(c.total),1),e("td",null,[e("button",{class:"button is-info is-small",onClick:_=>(r.value=c.id,o.value=!0)},[O(i(G),null,{default:k(()=>[O(i(me))]),_:1})],8,Ln)])]))),128))])])])],64))}}),yn=W({setup(m){const a=C("new");return(s,t)=>(P(),g("div",null,[e("button",{class:"button is-info",onClick:t[0]||(t[0]=n=>a.value="new")},"Nueva Venta"),e("button",{class:"button is-info",onClick:t[1]||(t[1]=n=>a.value="list")},"Lista de ventas"),a.value==="new"?(P(),oe(Jo,{key:0})):y("",!0),a.value==="list"?(P(),oe(Ce,{key:1})):y("",!0)]))}}),Fn={class:"columns"},Nn={class:"column"},wn=["value"],kn=W({setup(m){const a=C([]),s=C("");Q(async()=>{const o=await(await fetch("http://localhost:5050/devices")).json();a.value=o,s.value=localStorage.printer});const t=()=>{localStorage.printer=s.value};return(n,o)=>(P(),g("div",Fn,[e("div",Nn,[T(e("select",{"onUpdate:modelValue":o[0]||(o[0]=r=>s.value=r)},[(P(!0),g(H,null,z(a.value,r=>(P(),g("option",{key:r.vendor_id,value:r.product_id+"/"+r.vendor_id},D(r.vendor_id)+":"+D(r.product_id)+" "+D(r.name),9,wn))),128))],512),[[ce,s.value]]),e("button",{class:"button is-primary",onClick:o[1]||(o[1]=r=>t())},"Guardar")])]))}}),Wn=["onSubmit"],xn={class:"field"},Gn=e("label",{class:"label"},"Usuario",-1),Vn={class:"control has-icons-left"},jn={class:"field"},$n=e("label",{class:"label"},"Contrase\xF1a",-1),Hn={class:"control has-icons-left"},Bn={class:"field"},Kn={class:"control is-expanded"},Xn=e("button",{class:"button is-primary is-medium input mt-2"},"Iniciar Sesion",-1),Jn={key:0,class:"help is-danger"},qn=W({setup(m){const a=K(),s=C(!1),t=De(),n=Y({userName:"",password:""}),o=async()=>{const r=await a.dispatch("userLogin",{credentials:n});if(s.value=!r.success,r.success){const d=await a.dispatch("fetchProducts");console.log(d),t.replace("products")}console.log(r.message)};return(r,d)=>(P(),g("form",{onSubmit:ae(o,["prevent"]),class:"box column is-4 is-offset-4"},[e("div",xn,[Gn,e("div",Vn,[T(e("input",{class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":d[0]||(d[0]=f=>i(n).userName=f),placeholder:"Nombre de usuario"},null,512),[[L,i(n).userName]]),O(i(G),{class:"icon is-large is-left"},{default:k(()=>[O(i(Ue))]),_:1})])]),e("div",jn,[$n,e("div",Hn,[T(e("input",{class:"input is-medium",required:"","onUpdate:modelValue":d[1]||(d[1]=f=>i(n).password=f),type:"password",placeholder:"************"},null,512),[[L,i(n).password]]),O(i(G),{class:"icon is-large is-left"},{default:k(()=>[O(i(he))]),_:1})])]),e("div",Bn,[e("p",Kn,[Xn,s.value?(P(),g("span",Jn,"Error al iniciar session")):y("",!0)])])],40,Wn))}}),zn=["onSubmit"],Yn={class:"field"},Zn={class:"control"},Qn={key:0,class:"help is-danger"},ea={class:"field"},sa=e("label",{class:"label"},"DNI",-1),oa={class:"control"},na={class:"field"},aa=e("label",{class:"label"},"Nombres y Apellidos",-1),ra={class:"control"},ta={class:"field"},ia=e("label",{class:"label"},"Contrase\xF1a",-1),la={class:"control"},pa={key:0,class:"help is-danger"},ma={class:"field"},da=e("label",{class:"label"},"Repetir Contrase\xF1a",-1),ca={class:"control"},_a={key:0,class:"help is-danger"},Ca={class:"field"},ua=e("label",{class:"label"},"Celular",-1),Pa={class:"control"},Sa={class:"field"},ga=e("label",{class:"label"},"Email",-1),Ea={class:"control"},fa=e("button",{class:"button is-primary"},"Registrar usuario",-1),Ra=W({setup(m){const a=C(),s=K(),t=C(!1),n=C([]),o=Y({userName:"",dni:"",fullName:"",email:"",password:"",roleId:"1",mobile:""}),r=C(""),d=C(!1),f=()=>{o.password!==r.value?d.value=!0:d.value=!1};Q(async()=>{const l=await s.dispatch("fetchRoles");n.value=l.data});const u=async()=>{if(o.password!==r.value){d.value=!0;return}const l=await s.dispatch("userSignup",{user:o});t.value=l.success,l.success&&(a.value.reset(),alert(`usuario registrado 
 UserName: `+l.data.userName)),console.log(l.message)};return(l,c)=>(P(),g("form",{onSubmit:ae(u,["prevent"]),ref_key:"form",ref:a},[e("div",Yn,[e("div",Zn,[t.value?y("",!0):(P(),g("span",Qn,"Ya existe un producto con este codigo"))])]),e("div",ea,[sa,e("div",oa,[T(e("input",{class:"input",ref:"fieldName","onUpdate:modelValue":c[0]||(c[0]=_=>i(o).dni=_),type:"number",placeholder:"documento de identidad"},null,512),[[L,i(o).dni]])])]),e("div",na,[aa,e("div",ra,[T(e("input",{class:"input",ref:"fieldName",required:"","onUpdate:modelValue":c[1]||(c[1]=_=>i(o).fullName=_),type:"text",placeholder:"Nombres y apellidos"},null,512),[[L,i(o).fullName]])])]),e("div",ta,[ia,e("div",la,[T(e("input",{class:ee(["input",{"is-danger":d.value}]),required:"",step:"0.1","onUpdate:modelValue":c[2]||(c[2]=_=>i(o).password=_),type:"password",placeholder:"Contrase\xF1a"},null,2),[[L,i(o).password]]),d.value?(P(),g("span",pa,"Las contrase\xF1as deven ser iguales")):y("",!0)])]),e("div",ma,[da,e("div",ca,[T(e("input",{class:ee(["input",{"is-danger":d.value}]),onBlur:c[3]||(c[3]=_=>f()),required:"",step:"0.1","onUpdate:modelValue":c[4]||(c[4]=_=>r.value=_),type:"password",placeholder:"Vuelva a escribir la contrase\xF1a"},null,34),[[L,r.value]]),d.value?(P(),g("span",_a,"Las contrase\xF1as deven ser iguales")):y("",!0)])]),e("div",Ca,[ua,e("div",Pa,[T(e("input",{class:"input",step:"0.1","onUpdate:modelValue":c[5]||(c[5]=_=>i(o).mobile=_),type:"number",placeholder:"Numero de celular"},null,512),[[L,i(o).mobile]])])]),e("div",Sa,[ga,e("div",Ea,[T(e("input",{class:"input",ref:"fieldName","onUpdate:modelValue":c[6]||(c[6]=_=>i(o).email=_),type:"text",placeholder:"Correo electronico"},null,512),[[L,i(o).email]])])]),fa],40,zn))}}),Oa={class:"menu"},Aa=["srcdoc"],Da=W({props:{product:Object,stock:Number},setup(m){const a=m,s=C(),t=C(),n=C("");X(async()=>{Ie("#barcode",a.product.code,{displayValue:!1,height:20,width:1,margin:0}),await o(a.product,a.stock)});const o=async(r,d)=>{const f=t.value.src;let u=`
   <html>
  <head>
  <style>
  *{

  }
  </style>
   </head>
   <body style="width:108mm;padding:0;margin:0">
   <div style="margin:0 2.5mm;padding:0;width:103mm;display:grid;grid-template-columns: repeat(3, 1fr);font-family:arial;font-weight: bold;justify-content:center ;height:21mm ;page-break-after: always">`;for(let l=0;l<d;l++)u+=`<div style="display: flex;flex-direction: column;align-items: center;font-size: 10px;widt:30mm;max-width:30mm;border:1px solid black;padding:2px;text-align:center;height;20mm">
    <span style="margin: 0;padding: 0;z-index: 1;word-wrap:break-word;word-break: break-all;">${r.name}</span>
    <img style="width:29mm" src="${f}"/>
    <span style="margin: 0;padding: 0;z-index: 1">${r.code}</span>
    </div>`;u+=`</div> </body>
  </html>`,n.value=u};return(r,d)=>(P(),g("div",Oa,[e("iframe",{id:"printf",name:"printf",ref_key:"pdf",ref:s,style:{width:"1000px",height:"900px",border:"1x solid red"},srcdoc:n.value},null,8,Aa),e("img",{ref_key:"img",ref:t,id:"barcode",style:{display:"none"}},null,512)]))}}),Ua={class:"columns"},ha={class:"column is-4"},Ia={class:"field"},va=e("label",{class:"label"},"Usuario",-1),ba={class:"control"},Ma=W({setup(m){const a=C({}),s=C(9),t=()=>{const o=window;o.frames.printf.focus(),o.frames.printf.print()},n=o=>{a.value=o,console.log(o.code)};return(o,r)=>(P(),g("div",Ua,[e("form",ha,[e("div",Ia,[va,e("div",ba,[T(e("input",{type:"number",class:"input is-medium",ref:"fieldName",required:"","onUpdate:modelValue":r[0]||(r[0]=d=>s.value=d),placeholder:"Cantidad"},null,512),[[L,s.value,void 0,{number:!0}]])])]),e("button",{type:"button",onClick:r[1]||(r[1]=d=>t()),class:"button is-primary is-medium"},"Imprimir Codigos"),O(_e,{onItemSelected:r[2]||(r[2]=d=>n(d))})]),O(Da,{class:"column is-8",product:a.value,stock:s.value},null,8,["product","stock"])]))}}),Ta=[{path:"/login",name:"login",component:qn},{path:"/sales",name:"sales",component:yn},{path:"/listSales",name:"listSales",component:Ce},{path:"/printers",name:"printers",component:kn},{path:"/products",name:"products",component:Ls},{path:"/signup",name:"signup",component:Ra},{path:"/barcodes",name:"barcodes",component:Ma}],ue=ve({history:be("vilcherrez"),routes:Ta});ue.beforeEach(async(m,a)=>{if(!te.state.isAuthenticated&&m.name!=="login")return{name:"login"};if(te.state.isAuthenticated&&m.name==="login")return{name:"sales"}});const Pe=Me(Ge);Pe.use(te).use(ue).mount("#app");Pe.config.globalProperties.$log=console.log;
